webpackJsonp([6],[,,,,,function(e,t,a){var r=a(3)(a(432),a(433),null,null);e.exports=r.exports},,,,,function(e,t,a){var r=a(3)(a(434),a(435),null,null);e.exports=r.exports},,,,,,,,,,,,function(e,t,a){var r=a(3)(a(436),a(437),null,null);e.exports=r.exports},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,a){var r=a(3)(a(462),a(759),null,null);e.exports=r.exports},,,,,,,,,,,function(e,t,a){var r=a(3)(a(762),a(763),null,null);e.exports=r.exports},function(e,t,a){a(770);var r=a(3)(a(771),a(789),"data-v-246eb4d0",null);e.exports=r.exports},,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,a){var r=a(3)(a(767),a(768),null,null);e.exports=r.exports},function(e,t,a){var r=a(3)(a(814),a(815),null,null);e.exports=r.exports},function(e,t,a){a(816);var r=a(3)(a(817),a(818),null,null);e.exports=r.exports},,,function(e,t,a){var r=a(3)(a(846),a(847),null,null);e.exports=r.exports},,,,,,,,,,,function(e,t,a){a(326);var r=a(3)(a(327),a(421),"data-v-7a2ceccc",null);e.exports=r.exports},,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,a){"use strict";t.a={data:function(){var e=this;return{labelList:{},option:{title:{text:"默认"},dataZoom:[{show:!0,realtime:!0,start:30,end:70,xAxisIndex:[0,0]},{type:"inside",realtime:!0,start:30,end:70,xAxisIndex:[0,0]}],xAxis:{type:"category",boundaryGap:!1,data:[]},tooltip:{formatter:function(t){if(t.name===e.name)return e.tooltip?e.tooltip:'<div  v-loading="true">请稍等</div>';e.tooltip="",e.name=t.name,e.getThanData(t)}},yAxis:{type:"value"},grid:{left:40,top:40,bottom:40,height:"70%"},series:[{name:"日期",data:[],type:"line",itemStyle:{normal:{color:"#289df5",borderColor:"#289df5",areaStyle:{type:"default",opacity:.5}}}}]}}},mounted:function(){var e=this;document.querySelectorAll("label").forEach(function(t){t.getAttribute("for")&&e.$set(e.labelList,t.getAttribute("for"),t.innerText)})},methods:{showChart:function(e){this.$refs.chartShow.chartShow=!0,this.getData(e)}}}},function(e,t,a){a(463);var r=a(3)(a(464),a(758),null,null);e.exports=r.exports},,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,a){"use strict";var r=a(21),i=a(132),o=a(320),l=a(321);r.default.use(i.a);var s={count:10,bankList:[],typeList:[],name:"1",loading:!1},n={getBank:function(e,t){e.bankList=t},getBusType:function(e,t){e.typeList=t},INCREMENT:function(e){e.count++},DECREMENT:function(e){e.count--},changeName:function(e,t){e.name=t},changeLoading:function(e,t){e.loading=t.loading}};t.a=new i.a.Store({actions:o,getters:l,state:s,mutations:n})},function(e,t,a){"use strict";var r=a(322),i=a.n(r),o=a(427),l=a.n(o),s=a(133),n=a.n(s),p=[{path:"/",name:"root",hidden:!0,redirect:"/login",meta:{keepAlive:!1}},{path:"/login",name:"登录",hidden:!0,component:i.a,meta:{keepAlive:!1}},{path:"/404",component:l.a,name:"404",hidden:!0,meta:{keepAlive:!1}},{path:"/",component:n.a,name:"系统管理",leaf:!0,hidden:!0,meta:{keepAlive:!1},children:[{path:"admin",name:"用户管理",component:a(430),meta:{flag:!0,keepAlive:!0}},{path:"adduser",component:a(445),name:"用户信息",meta:{keepAlive:!1}},{path:"menu",component:a(448),name:"菜单管理",meta:{keepAlive:!0}},{path:"role",component:a(452),name:"角色管理",meta:{keepAlive:!0}}]},{path:"/",component:n.a,name:"组织架构",leaf:!0,hidden:!0,meta:{keepAlive:!1},children:[{path:"branch",component:a(459),name:"机构管理",meta:{flag:!0,keepAlive:!0}},{path:"teamAdd",component:a(79),name:"团队新增",meta:{keepAlive:!1}},{path:"teamAddDetail",component:a(79),name:"团队详情",meta:{keepAlive:!1}},{path:"teamEdit",component:a(299),name:"团队编辑",meta:{keepAlive:!0}},{path:"teamDetail",component:a(299),name:"团队详情",meta:{keepAlive:!0}},{path:"addStaff",component:a(90),name:"新增人员",meta:{keepAlive:!1}},{path:"addStaffDetail",component:a(90),name:"人员详情",meta:{keepAlive:!1}},{path:"editStaff",component:a(300),name:"编辑人员",meta:{keepAlive:!0}},{path:"staffDetail",component:a(300),name:"人员详情",meta:{keepAlive:!0}}]},{path:"/",component:n.a,name:"站点管理",leaf:!0,hidden:!0,meta:{keepAlive:!1},children:[{path:"siteEdit",component:a(301),name:"站点编辑",meta:{keepAlive:!0}},{path:"siteDetail",component:a(301),name:"站点详情",meta:{keepAlive:!0}},{path:"addSite",component:a(91),name:"站点新增",meta:{keepAlive:!1}},{path:"addSiteDetail",component:a(91),name:"站点详情",meta:{keepAlive:!1}},{path:"exportSiteInfos",component:a(790),name:"导出全部站点信息",meta:{keepAlive:!1}}]},{path:"/",component:n.a,name:"审批管理",leaf:!0,hidden:!0,meta:{keepAlive:!1},children:[{path:"approvalType",name:"审批类型管理",component:a(794),meta:{flag:!0,keepAlive:!0}},{path:"approvalProcess",component:a(800),name:"审批流程管理",meta:{keepAlive:!0}},{path:"approvalProcessDetail",component:a(803),name:"流程信息",meta:{keepAlive:!1}},{path:"approvalApply",component:a(809),name:"我的申请",meta:{keepAlive:!0}},{path:"approvalApplyDetail",component:a(812),name:"申请信息",meta:{keepAlive:!1}},{path:"approval",component:a(820),name:"我的审批",meta:{keepAlive:!0}},{path:"approvalDetail",component:a(823),name:"审批信息",meta:{keepAlive:!1}},{path:"approvalConnect",component:a(826),name:"我的沟通",meta:{keepAlive:!0}},{path:"approvalConnectDetail",component:a(829),name:"沟通信息",meta:{keepAlive:!1}}]},{path:"/",component:n.a,name:"营销管理",leaf:!0,hidden:!0,meta:{keepAlive:!1},children:[{path:"siteWarnTime",name:"站点提醒设置",component:a(832),meta:{flag:!0,keepAlive:!0}},{path:"siteWarnRecord",component:a(835),name:"站点提醒记录",meta:{keepAlive:!0}}]},{path:"/",component:n.a,name:"巡查管理",leaf:!0,hidden:!0,meta:{keepAlive:!1},children:[{path:"patrol",component:a(838),name:"巡查管理",meta:{keepAlive:!0}},{path:"mark_sheel",component:a(841),name:"巡查操作",meta:{keepAlive:!1}},{path:"new_msheel",component:a(849),name:"巡检条款",meta:{keepAlive:!1}},{path:"quit_msheel",component:a(853),name:"退出巡检条款",meta:{keepAlive:!1}}]},{path:"/",component:n.a,name:"风险管理",leaf:!0,hidden:!0,meta:{keepAlive:!1},children:[{path:"voucher",component:a(857),name:"助农交易管理",meta:{keepAlive:!0}},{path:"risk_customer",component:a(860),name:"风险客户名单",meta:{keepAlive:!0}},{path:"risk_customer_manage",component:a(866),name:"风险客户管理",meta:{keepAlive:!0}},{path:"voucherDetail",component:a(869),name:"助农交易详情",meta:{keepAlive:!1}},{path:"m_error",component:a(874),name:"风险管理",meta:{keepAlive:!0}},{path:"risk",component:a(878),name:"风险处置",meta:{keepAlive:!0}},{path:"riskDetail",component:a(119),name:"风险处置详情",meta:{keepAlive:!1}},{path:"operate",component:a(882),name:"合规模型",meta:{keepAlive:!0}}]},{path:"/",component:n.a,name:"活动管理",leaf:!0,hidden:!0,meta:{keepAlive:!1},children:[{path:"event",component:a(885),name:"活动管理",meta:{keepAlive:!0}}]},{path:"/",name:"首页",component:n.a,leaf:!0,hidden:!0,meta:{keepAlive:!1},children:[{path:"index",name:"首页",component:a(888),meta:{keepAlive:!1}}]},{name:"业绩管理",path:"/",component:n.a,leaf:!0,hidden:!0,meta:{keepAlive:!1},children:[{path:"/deposit",name:"存款业绩",component:function(){return a.e(2).then(a.bind(null,910))}},{path:"/aum",name:"AUM业绩",component:function(){return a.e(3).then(a.bind(null,911))}},{path:"/expand",name:"拓展业绩",component:function(){return a.e(1).then(a.bind(null,912))}},{path:"/helpfarmers",name:"助农取款",component:function(){return a.e(0).then(a.bind(null,913))}},{path:"/customerdetails",name:"客户/账户明细",component:function(){return a.e(4).then(a.bind(null,914))}}]},{name:"短信参数",path:"/",component:n.a,leaf:!0,hidden:!0,meta:{keepAlive:!1},children:[{path:"setting",component:a(896),name:"短信参数设置",meta:{keepAlive:!0}}]}];t.a=p},function(e,t,a){"use strict";function r(e,t,a){return new l.a(function(r,i){f.post(m+e+"?txcode="+t,a).then(function(e){r(e.data)}).catch(function(e){i(e)})})}function i(e,t,a){var r=new FormData;for(var i in a)r.append(i,a[i]);return new l.a(function(a,i){f.post(m+e+"?txcode="+t,r).then(function(e){a(e.data)}).catch(function(e){i(e),console.log(e)})})}t.a=r,t.b=i;var o=a(191),l=a.n(o),s=a(187),n=a(189),p=a(204),c=a.n(p),u=a(188),d=a(77);a.n(d),new s.a({routes:n.a});c.a.defaults.headers.post["Content-Type"]="application/octet-stream;charset=UTF-8;application/json;image/png";var m="/hnm/",f=c.a.create({withCredentials:!0,timeout:6e5});f.interceptors.request.use(function(e){return u.a.commit("changeLoading",{loading:!0}),e},function(e){return console.log(e),l.a.reject(e)}),f.interceptors.response.use(function(e){return u.a.commit("changeLoading",{loading:!1}),200==e.status?l.a.resolve(e):(Object(d.Message)({message:e.message||"Error",type:"error",duration:5e3}),console.log(e),l.a.reject(new Error(e||"Error")))},function(e){if(u.a.commit("changeLoading",{loading:!1}),d.Message.close(),e.response){switch(e.response.status){case 471:case 472:d.Message.error(e.response.data.tips.message),sessionStorage.removeItem("user"),sessionStorage.removeItem("route");new s.a({routes:n.a}).push("/login"),location.reload();break;case 404:d.Message.error("Network Error!!");break;default:d.Message.error(e.response.data.tips.message)}return l.a.reject(e.response)}console.log("Please check your internet connection."),d.Message.error({message:"网络异常"})})},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t){},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,a){var r=a(3)(a(760),a(761),null,null);e.exports=r.exports},function(e,t,a){var r=a(3)(a(764),a(765),null,null);e.exports=r.exports},function(e,t,a){var r=a(3)(a(766),a(769),null,null);e.exports=r.exports},,function(e,t,a){var r=a(3)(a(806),a(807),null,null);e.exports=r.exports},function(e,t,a){var r=a(3)(a(863),a(864),null,null);e.exports=r.exports},function(e,t){},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(184),i=a.n(r),o=a(21),l=a(314),s=a.n(l),n=a(187),p=a(188),c=a(132),u=a(189),d=a(77),m=a.n(d),f=a(305),_=(a.n(f),a(899)),h=a(900),v=(a.n(h),a(901)),b=(a.n(v),a(133)),g=(a.n(b),a(902)),y=a(903),k=a.n(y),x=a(907);o.default.component("lottie",k.a),o.default.prototype.$api=_.a,o.default.prototype.$loacalData=g.a,o.default.prototype.baseURL="/hnm/",o.default.use(n.a),o.default.use(c.a),o.default.use(m.a),i()(x).forEach(function(e){o.default.filter(e,x[e])});var $=new n.a({mode:"hash",scrollBehavior:function(e,t,a){return a||{x:0,y:0}},routes:u.a});$.beforeEach(function(e,t,a){if("/"===e.path||"/login"===e.path){if(!sessionStorage.getItem("user"))return void a();a(t.path)}else a()}),new o.default({router:$,store:p.a,localData:g.a,render:function(e){return e(s.a)}}).$mount("#app")},,,,,,,,function(e,t,a){a(315);var r=a(3)(a(317),a(319),null,null);e.exports=r.exports},function(e,t){},,function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(318),i=a.n(r);t.default={name:"app",data:function(){return{bg:i.a}},components:{},computed:{path:function(){return this.$route.path},loading:function(){return this.$store.state.loading}}}},function(e,t,a){e.exports=a.p+"img/bg1.d14135f.jpg"},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],style:{background:"/login"==e.path?"url("+e.bg+")":"",backgroundSize:"cover",backgroundRepeat:"no-repeat"},attrs:{id:"app"}},[a("transition",{attrs:{name:"fade",mode:"out-in"}},[a("router-view")],1)],1)},staticRenderFns:[]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),a.d(t,"increment",function(){return r}),a.d(t,"decrement",function(){return i});var r=function(e){(0,e.commit)("INCREMENT")},i=function(e){(0,e.commit)("DECREMENT")}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),a.d(t,"getCount",function(){return r});var r=function(e){return e.count}},function(e,t,a){a(323);var r=a(3)(a(324),a(426),"data-v-8fa6df84",null);e.exports=r.exports},function(e,t){},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(33),i=a.n(r),o=a(133),l=(a.n(o),a(422));a.n(l);t.default={data:function(){return{logining:!1,form:{flag:"1"},rules2:{userid:[{required:!0,message:"请输入账号",trigger:"blur"}],entry_pwd:[{required:!0,message:"请输入密码",trigger:"blur"}],phone:[{required:!0,message:"请输入手机号码",trigger:"blur"},{validator:function(e,t,a){return t?/^1[3456789]\d{9}$/.test(t)?void a():a(new Error("手机号码非法")):a(new Error("联系电话不能为空"))},trigger:"blur"}],phone_pass:[{required:!0,message:"请输入手机验证码",trigger:"blur"}]},count:0,src:"",sendFlag:!1,time:60}},watch:{count:function(e){e>=3&&this.getCode()}},methods:{getCode:function(){var e=(new Date).getTime();document.getElementById("img").src=this.baseURL+"code?txcode=code001&"+e},getPhoneCode:function(){var e=this;if(console.log(this.form.phone),!this.sendFlag){/^1[3456789]\d{9}$/.test(this.form.phone)&&this.$api.getPhoneCode({mobile:this.form.phone}).then(function(t){e.sendFlag=!0;var a=setInterval(function(){0==--e.time&&(e.time=59,e.sendFlag=!1,clearInterval(a))},1e3)})}},submit:function(){var e=this;this.$refs.form.validate(function(t){if(!t)return console.log("error submit!!"),!1;e.logining=!0,setTimeout(function(){e.logining=!1},2e3),"2"==e.form.flag&&(e.form.userid=e.form.phone,e.form.entry_pwd=e.form.phone_pass),e.$api.login(e.form).then(function(t){e.count=0,e.logining=!1,sessionStorage.setItem("user",i()(t.userMap)),sessionStorage.setItem("role",t.userRole),sessionStorage.setItem("role_level",t.role_level),sessionStorage.setItem("role_id",t.role_id),sessionStorage.setItem("menuList",i()(t.menuList)),sessionStorage.setItem("funcList",i()(t.funcList)),e.$store.commit("changeName","1");for(var a=0;a<t.menuList.length;a++)if("/"!=t.menuList[a].menu_path){e.$router.push({path:"/index"});break}}).catch(function(e){console.log(e)})})},forgetPass:function(){this.$alert("请联系管理员重置密码","忘记密码",{confirmButtonText:"确定",center:!0,callback:function(e){console.log("弹出")}})}}}},,function(e,t){},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});a(190),a(420);t.default={name:"home",data:function(){return{sysName:"惠农管理系统",collapsed:!1,currentChoose:"",branchName:"",roleName:"",sysUserName:"",sysUserAvatar:"",form:{name:"",region:"",date1:"",date2:"",delivery:!1,type:[],resource:"",desc:""},rules:{old_pwd:[{required:!0,message:"请输入原密码",trigger:"blur"}],new_pwd:[{required:!0,message:"请输入新密码",trigger:"blur"},{min:6,max:20,message:"密码在 6 到 20 个字符",trigger:"blur"}],confirm_pwd:[{required:!0,message:"请确认新密码",trigger:"blur"},{min:6,max:20,message:"密码在 6 到 20 个字符",trigger:"blur"}]},routerList:[],dav:[],menuIndex:"",visible:!1}},computed:{},mounted:function(){var e=sessionStorage.getItem("user");e&&(e=JSON.parse(e),console.log(e),this.branchName=e.branch_name||"",this.roleName=e.role_name||"",this.sysUserName=e.name||"",this.sysUserAvatar=e.avatar||"");var t=JSON.parse(sessionStorage.menuList);t.unshift({create_time:"2020-09-07 15:28:25",creator:"anonymousUser",icon:"el-icon-s-cooperation",menu_code:"1",menu_name:"首页",menu_path:"index",menu_type:"1",super_code:null}),this.menu=t,this.dealwithMenu(t)},watch:{$route:{handler:function(e){e.meta.flag||(this.currentChoose=e.path),this.handleMenu(),this.checkSessionStorageItem()},immediate:!0}},methods:{checkSessionStorageItem:function(){null===JSON.parse(sessionStorage.getItem("user"))&&this.$router.push("/login")},handleMenu:function(){var e=this,t=JSON.parse(sessionStorage.menuList),a=t.some(function(t){return e.$route.path=="/"+t.menu_path&&"/"!==t.menu_path}),r=t.find(function(t){return e.$route.path=="/"+t.menu_path&&"/"!==t.menu_path});a&&(this.dav=[r.super_code],this.dav.push(t.filter(function(e){return r.super_code==e.menu_code})[0].super_code),this.menuIndex=r.menu_code,console.log(this.dav,this.menuIndex))},showpage:function(e){this.$router.push({path:e.menu_path})},dealwithMenu:function(e){for(var t=[],a=0;a<e.length;a++){var r=[];if(null==e[a].super_code){for(var i=0;i<e.length;i++){var o=[];if(e[i].super_code==e[a].menu_code){for(var l=0;l<e.length;l++)e[l].super_code==e[i].menu_code&&(o.push(e[l]),e[i].children=o);r.push(e[i])}}e[a].children=r,t.push(e[a])}}this.routerList=t},updatePassWord:function(){this.visible=!0},onSubmit:function(){var e=this;this.$refs.form.validate(function(t){if(!t)return console.log("error submit!!"),!1;e.form.new_pwd===e.form.confirm_pwd?e.$api.updatePwd(e.form).then(function(t){console.log(t.data),e.handleClose(),e.$message.success("修改密码成功")}):e.$message({message:"两次密码输入不一致",type:"error"})})},handleClose:function(){this.visible=!1,this.form={}},logout:function(){var e=this;this.$confirm("确认退出吗?","提示",{}).then(function(){sessionStorage.removeItem("user"),sessionStorage.removeItem("route"),e.$router.push("/login")})},collapse:function(){this.collapsed=!this.collapsed},showMenu:function(e,t){this.$refs.menuCollapsed.getElementsByClassName("submenu-hook-"+e)[0].style.display=t?"block":"none"}}}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,a){"use strict";var r=a(204);a.n(r)},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-row",{staticClass:"container"},[a("el-col",{staticClass:"header",attrs:{span:24}},[a("el-col",{staticClass:"logo",class:e.collapsed?"logo-collapse-width":"logo-width",attrs:{span:8}},[e._v("\n        "+e._s(e.collapsed?"":e.sysName)+"\n      ")]),e._v(" "),a("el-col",{attrs:{span:2}},[a("div",{staticClass:"tools",staticStyle:{display:"none"},on:{click:function(t){return t.preventDefault(),e.collapse.apply(null,arguments)}}},[a("i",{staticClass:"fa fa-align-justify"})]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-arrow-left"},on:{click:function(t){return e.$router.back(-1)}}},[e._v("\n          返回\n        ")])],1),e._v(" "),a("el-col",{staticClass:"userinfo",attrs:{span:14}},[a("span",{staticClass:"el-dropdown-link userinfo-inner"},[a("i",{staticClass:"el-icon-s-shop",staticStyle:{"margin-right":"5px"},attrs:{size:"26"}}),e._v(e._s(e.branchName)+"\n\t\t\t\t")]),e._v(" "),a("span",{staticClass:"el-dropdown-link userinfo-inner"},[a("i",{staticClass:"el-icon-s-custom",staticStyle:{"margin-right":"5px"},attrs:{size:"26"}}),e._v(e._s(e.roleName)+"\n\t\t\t\t")]),e._v(" "),a("span",{staticClass:"el-dropdown-link userinfo-inner"},[a("i",{staticClass:"el-icon-user-solid",staticStyle:{"margin-right":"5px"},attrs:{size:"26"}}),e._v(e._s(e.sysUserName)+"\n\t\t\t\t")]),e._v(" "),a("el-button",{attrs:{type:"primary",icon:"el-icon-edit"},on:{click:e.updatePassWord}},[e._v("修改密码")]),e._v(" "),a("el-button",{attrs:{type:"primary",icon:"el-icon-switch-button"},on:{click:e.logout}},[e._v("退出登录")])],1)],1),e._v(" "),a("el-col",{staticClass:"main",attrs:{span:24}},[a("aside",[a("el-menu",{attrs:{"default-openeds":e.dav,"unique-opened":!0,"default-active":e.menuIndex}},[e._l(e.routerList,function(t,r){return[t.children.length>0?a("el-submenu",{key:r,attrs:{index:t.menu_code}},[a("template",{slot:"title"},[a("i",{class:t.icon}),e._v(" "),a("span",[e._v(e._s(t.menu_name))])]),e._v(" "),e._l(t.children,function(t,r){return[t.children?a("el-submenu",{key:r,attrs:{index:t.menu_code}},[a("template",{slot:"title"},[a("i",{class:t.icon}),e._v(" "),a("span",[e._v(e._s(t.menu_name))])]),e._v(" "),e._l(t.children,function(t,r){return a("el-menu-item",{key:r,attrs:{index:t.menu_code},on:{click:function(a){return e.showpage(t)}}},[a("i",{class:t.icon}),e._v(" "+e._s(t.menu_name)+"\n                  ")])})],2):a("el-menu-item",{key:r,attrs:{index:t.menu_code},on:{click:function(a){return e.showpage(t)}}},[a("i",{class:t.icon}),e._v(" "+e._s(t.menu_name)+"\n                ")])]})],2):a("el-menu-item",{key:r,attrs:{index:t.menu_code},on:{click:function(a){return e.showpage(t)}}},[a("template",{slot:"title"},[e._v("\n                "+e._s(t.menu_name)+"\n              ")])],2)]})],2)],1),e._v(" "),a("section",{staticClass:"content-container"},[a("div",{staticClass:"grid-content bg-purple-light"},[a("el-col",{staticClass:"breadcrumb-container",staticStyle:{"margin-bottom":"20px"},attrs:{span:24}},[a("strong",{staticClass:"title"},[e._v(e._s(e.$route.name))]),e._v(" "),a("el-breadcrumb",{staticClass:"breadcrumb-inner",attrs:{separator:"/"}},e._l(e.$route.matched,function(t){return a("el-breadcrumb-item",{key:t.path},[e._v("\n                "+e._s(t.name)+"\n              ")])}),1)],1),e._v(" "),a("el-col",{staticClass:"content-wrapper",attrs:{span:24}},[a("keep-alive",{attrs:{max:1}},[e.$route.meta.keepAlive?a("router-view",{key:e.$route.fullPath}):e._e()],1),e._v(" "),e.$route.meta.keepAlive?e._e():a("router-view",{key:e.$route.fullPath})],1)],1)])]),e._v(" "),a("el-dialog",{attrs:{title:"修改密码",visible:e.visible,width:"45%","before-close":e.handleClose},on:{"update:visible":function(t){e.visible=t}}},[a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"90px"}},[a("el-form-item",{staticStyle:{width:"360px"},attrs:{label:"原密码",prop:"old_pwd"}},[a("el-input",{attrs:{type:"password"},model:{value:e.form.old_pwd,callback:function(t){e.$set(e.form,"old_pwd",t)},expression:"form.old_pwd"}})],1),e._v(" "),a("el-form-item",{staticStyle:{width:"360px"},attrs:{label:"新密码",prop:"new_pwd"}},[a("el-input",{attrs:{type:"password"},model:{value:e.form.new_pwd,callback:function(t){e.$set(e.form,"new_pwd",t)},expression:"form.new_pwd"}})],1),e._v(" "),a("el-form-item",{staticStyle:{width:"360px"},attrs:{label:"重复新密码",prop:"confirm_pwd"}},[a("el-input",{attrs:{type:"password"},model:{value:e.form.confirm_pwd,callback:function(t){e.$set(e.form,"confirm_pwd",t)},expression:"form.confirm_pwd"}})],1)],1),e._v(" "),a("div",{staticStyle:{"text-align":"center"},attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:e.handleClose}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.onSubmit}},[e._v("确 定\n        ")])],1)],1)],1)},staticRenderFns:[]}},function(e,t,a){a(423);var r=a(3)(a(424),a(425),"data-v-4138c518",null);e.exports=r.exports},function(e,t){},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement;return(e._self._c||t)("section",[e._v("\n\tmain\n")])},staticRenderFns:[]}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"form",staticClass:"demo-ruleForm login-container",attrs:{model:e.form,rules:e.rules2,"label-position":"left","label-width":"0px"}},[a("h3",{staticClass:"title"},[e._v("惠农管理系统")]),e._v(" "),a("div",{staticClass:"loginTitle"},[a("h2",[e._v("登录")])]),e._v(" "),[a("el-form-item",{attrs:{prop:"userid"}},[a("el-input",{attrs:{type:"text","prefix-icon":"el-icon-s-custom",placeholder:"请输入员工编号"},model:{value:e.form.userid,callback:function(t){e.$set(e.form,"userid",t)},expression:"form.userid"}})],1),e._v(" "),a("el-form-item",{attrs:{prop:"entry_pwd"}},[a("el-input",{attrs:{type:"password","auto-complete":"off","show-password":"","prefix-icon":"el-icon-lock",placeholder:"请输入密码"},model:{value:e.form.entry_pwd,callback:function(t){e.$set(e.form,"entry_pwd",t)},expression:"form.entry_pwd"}})],1),e._v(" "),e.count>2?a("el-form-item",{attrs:{prop:"img_flowid"}},[a("el-row",{staticStyle:{width:"100%"}},[a("el-col",{attrs:{span:15}},[a("el-input",{attrs:{type:"text","auto-complete":"off",placeholder:"请输入验证码"},model:{value:e.form.img_flowid,callback:function(t){e.$set(e.form,"img_flowid",t)},expression:"form.img_flowid"}})],1),e._v(" "),a("el-col",{attrs:{span:8,offset:1}},[a("img",{attrs:{id:"img",src:this.baseURL+"code?txcode=code001"},on:{click:e.getCode}})])],1)],1):e._e()],e._v(" "),a("div",{staticStyle:{"text-align":"right"}},[a("el-button",{attrs:{type:"text"},on:{click:e.forgetPass}},[e._v(e._s("1"==e.form.flag?"忘记密码":"收不到验证码"))])],1),e._v(" "),a("el-form-item",{staticStyle:{width:"100%"}},[a("el-button",{staticStyle:{width:"100%"},attrs:{type:"primary",loading:e.logining},nativeOn:{click:function(t){return t.preventDefault(),e.submit.apply(null,arguments)}}},[e._v("登录")])],1)],2)},staticRenderFns:[]}},function(e,t,a){a(428);var r=a(3)(null,a(429),"data-v-b1c64426",null);e.exports=r.exports},function(e,t){},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement;return(e._self._c||t)("p",{staticClass:"page-container"},[e._v("404 page not found")])},staticRenderFns:[]}},function(e,t,a){var r=a(3)(a(431),a(444),null,null);e.exports=r.exports},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(6),i=a.n(r),o=a(5),l=a.n(o),s=a(10),n=a.n(s),p=a(22),c=a.n(p),u=a(157);a.n(u);t.default={name:"admin",components:{baseTable:l.a,basePage:n.a,BranchTreePicker:c.a},data:function(){return{user:JSON.parse(sessionStorage.getItem("user")),role_id:sessionStorage.getItem("role_id"),role:sessionStorage.getItem("role"),form:{},bankid:"",bankname:"",dataList:[{label:"用户编号",prop:"account_id",sort:!0},{label:"姓名",prop:"name"},{label:"电话",prop:"phone"},{label:"所属机构",prop:"branch_name"},{label:"角色",prop:"role_name"},{label:"创建时间",prop:"create_time",width:120}],userList:[],delList:[],pageNum:1,pageSize:10,total:0,flag:"",newUserList:[],super_manager:this.$loacalData.code_GetEnums(this.$loacalData.listRole,"super_manager").value,roleList:[]}},computed:{bankList:{get:function(){return this.$store.state.bankList},set:function(e){this.$store.state.bankList=e}}},mounted:function(){this.getRoleList()},methods:{nodeselectForSerch:function(e){console.log(e),this.bankname=e.branch_name,this.bankid=e.branch_id},getRoleList:function(){var e=this;this.$api.getUsertype().then(function(t){e.roleList=t.data})},adduser:function(){this.$router.push({path:"/adduser",name:"用户信息",query:{role:this.role},params:{}})},editUser:function(e,t){this.$router.push({path:"/adduser",name:"用户信息",query:{id:e,role:this.role,check:t},params:{searchKey:this.form}})},getUserList:function(){var e=this;this.$api.getUserList(i()({page:this.pageNum-1,number:this.pageSize,bankid:this.bankid},this.form)).then(function(t){e.userList=t.data.userList,e.total=t.data.total})},changeSize:function(e){this.pageNum=1,this.pageSize=e,this.getUserList()},changePage:function(e){this.pageNum=e,this.getUserList()},delOne:function(e){this.delList=[],this.delList.push(e),this.deleteUser()},chooseUser:function(e){this.delList=e.map(function(e){return e.account_id})},deleteUser:function(){var e=this;if(console.log(this.delList),this.delList.indexOf("admin")>-1||this.delList.indexOf("admin2")>-1)return void this.$message.error("用户超级管理员不可停用，请重新勾选用户");var t=JSON.parse(sessionStorage.getItem("user"));if(this.delList.indexOf(t.account_id)>-1)return void this.$message.error("用户"+t.name+"不可停用，请重新勾选用户");this.$confirm("确定停用选中的用户吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!0}).then(function(){e.$api.deleteUser({accountIds:e.delList}).then(function(t){console.log(t),e.getUserList(),e.$message.success("删除成功"),e.delList=[]})}).catch(function(){e.delList=[]})},clearPwd:function(e){var t=this;this.$api.clearPwd({account_id:e}).then(function(e){console.log(e),t.getUserList(),t.$message.success("解除锁定成功")})},resetPassword:function(e,t){var a=this;this.$confirm("确定重置"+("1"==t?"登录":"交易")+"密码吗？重置后密码将设置为123456","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!0}).then(function(){a.$api.resetPassword({account_id:e.account_id,flag:t}).then(function(r){console.log(r),a.$notify({title:"重置密码成功",duration:3e3,message:"用户"+e.name+"的"+("1"==t?"登录":"交易")+"密码已重置为123456",type:"success"})})})},uploadFile:function(){var e=document.getElementById("file");e.value="",e.click()},chooseFile:function(){var e=this,t=document.getElementById("file"),a=t.files[0];t.value="",this.$api.uploadUser({file:a}).then(function(t){if(0==t.fail_count)e.$notify.success("成功导入"+t.success_count+"条数据");else{var a="";t.exist_account_id_list.map(function(e){a=a+e.account_id+", "}),a=a.substring(0,a.length-2),e.$notify.info({message:"共导入"+t.total_count+"条数据，"+t.success_count+"条成功，\n          "+t.fail_count+"条失败。员工编号"+a+"已存在"})}e.getUserList()})},downModal:function(){var e=document.createElement("a");e.download="用户导入模版.xlsx",e.href=this.baseURL+"download/account_import.xlsx",e.click()}},beforeRouteEnter:function(e,t,a){a(function(t){e.params.searchKey&&(t.form=e.params.searchKey),t.getUserList()})}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={name:"Table",props:{list:{type:Array,default:[]},data:{type:Array,default:[]}},methods:{handleSelectionChange:function(e){this.$emit("select",e)},handleSelectAll:function(e){this.$emit("select",e)}}}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-table",{attrs:{data:e.data,"element-loading-text":"Loading",border:"",fit:"","highlight-current-row":""},on:{select:e.handleSelectionChange,"select-all":e.handleSelectAll}},[e._t("begin"),e._v(" "),e._t("head",function(){return[a("el-table-column",{attrs:{align:"center",label:"序号",width:"50"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(t.$index+1)+"\n      ")]}}])})]}),e._v(" "),e._l(e.list,function(e){return a("el-table-column",{key:e.prop,attrs:{label:e.label,prop:e.prop,sortable:e.sort,"min-width":e.width,align:"center"}})}),e._v(" "),e._t("default")],2)},staticRenderFns:[]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={name:"basePage",props:{page:{type:Number,default:1},size:{type:Number,default:10},total:{type:Number,default:0}},methods:{handleSizeChange:function(e){this.$emit("size",e)},handleCurrentChange:function(e){this.$emit("page",e)}}}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{"margin-top":"15px","text-align":"center"}},[a("el-pagination",{attrs:{"current-page":e.page,"page-sizes":[10,20,50,100],"page-size":e.size,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)},staticRenderFns:[]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={name:"basePage",props:{dfk:{type:String,default:""},appendToBody:!1},data:function(){return{dialogVisible:!1,showlist:[],defaultProps:{children:"children",label:"branch_name"},dfks:[]}},methods:{nodec:function(e){console.log(e),this.$emit("nodeselect",e),this.dialogVisible=!1},geBankList:function(){var e=this;if(this.showlist.length>0)return void(this.dialogVisible=!0);this.$api.getBranch({}).then(function(t){e.dealwithBranch(t.data),e.dialogVisible=!0})},dealwithBranch:function(e){var t=e.filter(function(e){return null==e.porgid})[0];t.children=this.findchildren(e,t),this.showlist=[t],this.dfks=[this.dfk]},findchildren:function(e,t){for(var a=[],r=0;r<e.length;r++)if(e[r].porgid==t.branch_id){var i=this.findchildren(e,e[r]);i.length>0&&(e[r].children=i),a.push(e[r])}return a}}}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{"margin-left":"1px"}},[a("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){return e.geBankList()}}},[e._v("选择")]),e._v(" "),a("el-dialog",{attrs:{title:"机构选择",visible:e.dialogVisible,"append-to-body":e.appendToBody},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-tree",{attrs:{data:e.showlist,"node-key":"branch_id",props:e.defaultProps,"default-expanded-keys":e.dfks},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.node,i=t.data;return a("span",{staticClass:"custom-tree-node"},[a("span",[e._v(e._s(r.label))]),e._v(" "),a("span",[a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(){return e.nodec(i)}}},[e._v("\n\t\t\t            选择\n\t\t\t          ")])],1)])}}])})],1)],1)},staticRenderFns:[]}},,,,,function(e,t){},function(e,t){},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.adduser}},[e._v("新增用户")]),e._v(" "),"1"==e.role||"2"==e.role?a("el-button",{attrs:{type:"danger",size:"small",disabled:0==e.delList.length},on:{click:e.deleteUser}},[e._v("批量删除\n    ")]):e._e(),e._v(" "),"1"==e.role||"2"==e.role?a("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-folder-add"},on:{click:e.uploadFile}},[e._v("批量导入\n    ")]):e._e(),e._v(" "),"1"==e.role||"2"==e.role?a("el-button",{attrs:{type:"warning",size:"small"},on:{click:e.downModal}},[e._v("下载用户导入模版\n    ")]):e._e(),e._v(" "),a("input",{staticStyle:{display:"none"},attrs:{type:"file",id:"file"},on:{change:e.chooseFile}}),e._v(" "),a("el-form",{staticStyle:{"margin-top":"15px"},attrs:{inline:!0,model:e.form}},[a("el-form-item",{attrs:{label:"姓名"}},[a("el-input",{attrs:{clearable:"",placeholder:"请输入姓名",size:"small"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"用户编号"}},[a("el-input",{attrs:{clearable:"",placeholder:"请输入用户编号",size:"small"},model:{value:e.form.account_id,callback:function(t){e.$set(e.form,"account_id",t)},expression:"form.account_id"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"用户角色"}},[a("el-select",{attrs:{filterable:"",clearable:"",size:"small"},model:{value:e.form.role_id,callback:function(t){e.$set(e.form,"role_id",t)},expression:"form.role_id"}},e._l(e.roleList,function(e){return a("el-option",{key:e.role_id,attrs:{label:e.role_name,value:e.role_id}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"手机号码"}},[a("el-input",{attrs:{clearable:"",placeholder:"请输入手机号码",size:"small"},model:{value:e.form.phone,callback:function(t){e.$set(e.form,"phone",t)},expression:"form.phone"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"所属机构",prop:"bankid"}},[a("div",{staticStyle:{display:"flex"}},[a("el-input",{attrs:{readonly:"",size:"small"},model:{value:e.bankname,callback:function(t){e.bankname=t},expression:"bankname"}}),e._v(" "),a("BranchTreePicker",{on:{nodeselect:e.nodeselectForSerch}})],1)]),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-search"},on:{click:e.getUserList}},[e._v("搜索\n            ")])],1)],1),e._v(" "),a("base-table",{attrs:{list:e.dataList,data:e.userList},on:{select:e.chooseUser}},[a("el-table-column",{attrs:{slot:"begin",type:"selection",width:"40"},slot:"begin"}),e._v(" "),a("el-table-column",{attrs:{label:"操作",align:"center",width:"240"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.role_id==e.role_id||t.row.role_id==e.super_manager||"1"!=e.role&&"2"!=e.role?[a("el-button",{attrs:{type:"text",icon:"el-icon-edit-outline"},on:{click:function(a){return e.editUser(t.row.account_id,!0)}}},[e._v("查看\n                    ")])]:[a("el-button",{attrs:{type:"text",icon:"el-icon-edit-outline"},on:{click:function(a){return e.editUser(t.row.account_id)}}},[e._v("编辑\n                    ")]),e._v(" "),a("el-button",{staticStyle:{color:"red"},attrs:{type:"text",icon:"el-icon-delete"},on:{click:function(a){return e.delOne(t.row.account_id)}}},[e._v("停用\n                    ")]),e._v(" "),a("el-button",{staticStyle:{color:"green"},attrs:{type:"text",icon:"el-icon-unlock"},on:{click:function(a){return e.clearPwd(t.row.account_id)}}},[e._v("解锁\n                    ")]),e._v(" "),a("el-button",{staticStyle:{color:"yellowgreen"},attrs:{type:"text",icon:"el-icon-refresh"},on:{click:function(a){return e.resetPassword(t.row,"1")}}},[e._v("重置密码\n                    ")])]]}}])})],1),e._v(" "),a("base-page",{attrs:{page:e.pageNum,size:e.pageSize,total:e.total},on:{size:e.changeSize,page:e.changePage}})],1)},staticRenderFns:[]}},function(e,t,a){var r=a(3)(a(446),a(447),null,null);e.exports=r.exports},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(22),i=a.n(r);t.default={components:{BranchTreePicker:i.a},name:"adduser",data:function(){return{form:{roleids:[]},rules:{name:[{required:!0,message:"请输入员工姓名",trigger:"blur"},{min:2,max:10,message:"名字在 2 到 10 个字符",trigger:"blur"}],account_id:[{required:!0,message:"请输入员工编号",trigger:"blur"},{min:1,max:10,message:"工号在 1 到 10 个字符",trigger:"blur"}],identify_no:[{required:!0,message:"请输入身份证号",trigger:"blur"},{validator:function(e,t,a){return t?/^[1-9]\d{7}((0\d)|(1[0-2]))(([0|1|2]\d)|3[0-1])\d{3}$|^[1-9]\d{5}[1-9]\d{3}((0\d)|(1[0-2]))(([0|1|2]\d)|3[0-1])\d{3}([0-9]|X)$/.test(t)?void a():a(new Error("身份证号非法")):a(new Error("身份证不能为空"))},trigger:"blur"}],branch_id:[{required:!0,message:"请选择所属机构",trigger:"change"}],role:[{required:!0,message:"选择角色",trigger:"change"}],phone:[{required:!0,message:"请输入手机号码",trigger:"blur"},{validator:function(e,t,a){return t?/^1[3456789]\d{9}$/.test(t)?void a():a(new Error("手机号码非法")):a(new Error("手机号码不能为空"))},trigger:"blur"}],email:[{message:"请输入电子邮箱",trigger:"blur"},{validator:function(e,t,a){if(void 0!==t&&""!=t&&null!=t||a(),!/^([a-zA-Z0-9_-])+@([a-zA-Z0-9_-])+(\.[a-zA-Z0-9_-])+/.test(t))return a(new Error("电子邮箱非法"));a()},trigger:"blur"}],login_pwd:[{required:!0,message:"请输入登录密码",trigger:"blur"},{min:6,max:20,message:"密码在 6 到 20 个字符",trigger:"blur"}]},account_id:"",userList:[],check:!1,userName:"",showByRoleLevel:!1}},computed:{bankList:{get:function(){return this.$store.state.bankList},set:function(e){this.$store.state.bankList=e}}},mounted:function(){var e=this;this.check="false"!==this.$route.query.check&&Boolean(this.$route.query.check);this.$route.query.role;this.account_id=this.$route.query.id,this.account_id?this.$api.getUserInfo({account_id:this.account_id}).then(function(t){console.log(t.data),e.form=t.data.user,e.check?e.userList=t.data.roleList:e.getUsertype(),1==t.data.roleList.length&&e.$set(e.form,"role",t.data.roleList[0].role_id),e.getLevel()}):this.getUsertype()},methods:{getLevel:function(){console.log(this.userList);for(var e=0;e<this.userList.length;e++)if(this.userList[e].role_id==this.form.role){var t=this.userList[e].role_level;"1"==t?(this.showByRoleLevel=!1,this.$set(this.form,"branch_id",null)):"2"!=t&&"3"!=t&&"4"!=t||(this.showByRoleLevel=!0);break}},checkAccountId:function(){var e=this;this.$api.checkStaffDetail({user_id:this.form.account_id}).then(function(t){e.form.name=t.data.name}),this.$set(this.form,"name",this.form.name)},nodeselectForShow:function(e){this.$set(this.form,"branch_name",e.branch_name),this.$set(this.form,"branch_id",e.branch_id)},getUsertype:function(){var e=this;this.check||this.$api.getUsertype().then(function(t){e.userList=t.data,1==t.data.length&&e.$set(e.form,"role",t.data[0].role_id),e.getLevel()})},onSubmit:function(){var e=this;if(this.check)return void this.$router.back(-1);this.$set(this.form,"roleids",[this.form.role]),this.$refs.form.validate(function(t){t&&(e.account_id?(delete e.form.create_time,e.$api.updateUser(e.form).then(function(t){e.$message({message:"更新用户成功",type:"success"}),e.$router.back(-1)})):e.$api.checkStaffDetail({user_id:e.form.account_id}).then(function(t){e.$api.addUser(e.form).then(function(t){e.$message({message:"创建用户成功",type:"success"}),e.$router.back(-1)})}))})}},beforeRouteLeave:function(e,t,a){e.params.searchKey=this.$route.params.searchKey,a()}}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-form",{ref:"form",staticStyle:{width:"600px"},attrs:{"status-icon":"",rules:e.rules,model:e.form,"label-width":"120px"}},[a("el-form-item",{attrs:{label:"用户编号",prop:"account_id"}},[a("el-input",{attrs:{disabled:!!e.account_id},on:{change:function(t){return e.checkAccountId()}},model:{value:e.form.account_id,callback:function(t){e.$set(e.form,"account_id",t)},expression:"form.account_id"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"姓名",prop:"name"}},[a("el-input",{attrs:{disabled:!0},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"身份证号",prop:"identify_no"}},[a("el-input",{attrs:{disabled:e.check},model:{value:e.form.identify_no,callback:function(t){e.$set(e.form,"identify_no",t)},expression:"form.identify_no"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"角色",prop:"role"}},[a("el-radio-group",{attrs:{disabled:e.check},on:{change:e.getLevel},model:{value:e.form.role,callback:function(t){e.$set(e.form,"role",t)},expression:"form.role"}},e._l(e.userList,function(t){return a("el-radio",{key:t.role_id,attrs:{label:t.role_id,role_level:t.role_level}},[e._v(e._s(t.role_name))])}),1)],1),e._v(" "),e.showByRoleLevel?a("el-form-item",{attrs:{label:"所属机构",prop:"branch_id"}},[a("div",{staticStyle:{display:"flex"}},[a("el-input",{attrs:{disabled:!0},model:{value:this.form.branch_name,callback:function(t){e.$set(this.form,"branch_name",t)},expression:"this.form.branch_name"}}),e._v(" "),a("BranchTreePicker",{directives:[{name:"show",rawName:"v-show",value:!e.check,expression:"!check"}],attrs:{dfks:this.form.branch_id,appendToBody:!0},on:{nodeselect:e.nodeselectForShow}})],1)]):e._e(),e._v(" "),a("el-form-item",{attrs:{label:"手机号码",prop:"phone"}},[a("el-input",{attrs:{disabled:e.check},model:{value:e.form.phone,callback:function(t){e.$set(e.form,"phone",t)},expression:"form.phone"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"电子邮箱",prop:"email"}},[a("el-input",{attrs:{disabled:e.check},model:{value:e.form.email,callback:function(t){e.$set(e.form,"email",t)},expression:"form.email"}})],1),e._v(" "),e.account_id?e._e():a("el-form-item",{attrs:{label:"登录密码",prop:"login_pwd"}},[a("el-input",{attrs:{"show-password":"",disabled:e.check},model:{value:e.form.login_pwd,callback:function(t){e.$set(e.form,"login_pwd",t)},expression:"form.login_pwd"}})],1),e._v(" "),a("el-form-item",[e.check?a("el-button",{attrs:{type:"primary",size:"medium"},on:{click:e.onSubmit}},[e._v("返回")]):a("el-button",{attrs:{type:"primary",size:"medium"},on:{click:e.onSubmit}},[e._v(e._s(e.account_id?"更新信息":"立即创建"))])],1)],1)],1)},staticRenderFns:[]}},function(e,t,a){a(449);var r=a(3)(a(450),a(451),null,null);e.exports=r.exports},function(e,t){},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={label:"menu",data:function(){return{defaultProps:{children:"sub_tree",label:"menu_name"},rules:{menu_name:[{required:!0,message:"不可为空",trigger:"blur"}],menu_path:[{required:!0,message:"不可为空",trigger:"blur"}],icon:[{required:!0,message:"不可为空",trigger:"blur"}]},visible:!1,labelPosition:"right",form:{},data:[],level:"",type_show:!0}},mounted:function(){this.getMenuList()},methods:{getMenuList:function(){var e=this;this.$api.getMenu().then(function(t){e.data=t.data.menu_list})},appendFirst:function(){this.form={menu_type:"1"},this.visible=!0,this.type_show=!1},createNode:function(){var e=this;this.form.menu_code?this.$api.editMenu(this.form).then(function(t){e.visible=!1,e.form={},e.getMenuList()}):this.$api.createMenu(this.form).then(function(t){e.visible=!1,e.form={},e.getMenuList()})},append:function(e,t){console.log(e.level),this.form={menu_type:"1"},this.visible=!0,this.level=e.level,this.$set(this.form,"super_code",t.menu_code),this.type_show=!0},editNode:function(e){console.log(e),this.visible=!0,this.form=e,this.type_show=null==e.sub_tree},removeNode:function(e){var t=this;this.$confirm("确定删除菜单项？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!0}).then(function(){t.$api.deleteMenu({menu_code:e.menu_code}).then(function(e){console.log(e),t.getMenuList()})})}}}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(){return e.appendFirst(e.data)}}},[e._v("\n    添加一级菜单\n  ")]),e._v(" "),a("el-tree",{attrs:{data:e.data,props:e.defaultProps,"node-key":"path","default-expand-all":"","expand-on-click-node":!1},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.node,i=t.data;return a("div",{staticClass:"custom-tree-node"},[a("span",[a("i",{class:i.icon}),e._v(e._s(r.label)+" ")]),e._v(" "),a("span",[r.level<9&&"1"==i.menu_type?a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(){return e.append(r,i)}}},[e._v("\n          添加\n        ")]):e._e(),e._v(" "),a("el-button",{attrs:{type:"warning",size:"small"},on:{click:function(){return e.editNode(i)}}},[e._v("\n          编辑\n        ")]),e._v(" "),a("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(){return e.removeNode(i)}}},[e._v("\n          删除\n        ")])],1)])}}])}),e._v(" "),a("el-dialog",{attrs:{title:"菜单",visible:e.visible,rules:e.rules,width:"300px"},on:{"update:visible":function(t){e.visible=t}}},[a("el-form",{attrs:{model:e.form,"label-position":"right","label-width":"60px"}},[a("el-form-item",{attrs:{label:"菜单名",prop:"menu_name"}},[a("el-input",{attrs:{size:"small"},model:{value:e.form.menu_name,callback:function(t){e.$set(e.form,"menu_name",t)},expression:"form.menu_name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"路径",prop:"menu_path"}},[a("el-input",{attrs:{size:"small"},model:{value:e.form.menu_path,callback:function(t){e.$set(e.form,"menu_path",t)},expression:"form.menu_path"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"图标",prop:"icon"}},[a("el-input",{attrs:{size:"small"},model:{value:e.form.icon,callback:function(t){e.$set(e.form,"icon",t)},expression:"form.icon"}})],1),e._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.type_show,expression:"type_show"}],attrs:{label:"类型",prop:"menu_type"}},[a("el-radio",{attrs:{label:"1"},model:{value:e.form.menu_type,callback:function(t){e.$set(e.form,"menu_type",t)},expression:"form.menu_type"}},[e._v("菜单")]),e._v(" "),a("el-radio",{attrs:{label:"2"},model:{value:e.form.menu_type,callback:function(t){e.$set(e.form,"menu_type",t)},expression:"form.menu_type"}},[e._v("功能")])],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:function(t){e.visible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.createNode}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]}},function(e,t,a){var r=a(3)(a(453),a(458),null,null);e.exports=r.exports},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(454),i=a.n(r),o=a(5),l=a.n(o),s=a(10),n=a.n(s);t.default={name:"role",components:{baseTable:l.a,basePage:n.a},data:function(){return{defaultProps:{label:"menu_name",children:"sub_tree"},form:{menuids:[],mobile_menuids:[]},dataList:[{label:"角色名称",prop:"role_name"},{label:"角色类型",prop:"role_type"},{label:"角色级别",prop:"role_level"},{label:"角色id",prop:"role_id"},{label:"角色描述",prop:"role_desc"}],rules:{role_name:[{required:!0,message:"请输入角色名称",trigger:"blur"}],role_type:[{required:!0,message:"请选择角色类型",trigger:"change"}],role_level:[{required:!0,message:"请选择角色级别",trigger:"change"}],firstMenu1:[],firstMenu2:[]},menuList:[],roleList:[],pageNum:1,pageSize:10,total:0,visible:!1,super_manager:this.$loacalData.code_GetEnums(this.$loacalData.listRole,"super_manager").value,head_manager:this.$loacalData.code_GetEnums(this.$loacalData.listRole,"head_manager").value,head_science:this.$loacalData.code_GetEnums(this.$loacalData.listRole,"head_science").value,sub_manager:this.$loacalData.code_GetEnums(this.$loacalData.listRole,"sub_manager").value,sub_leader:this.$loacalData.code_GetEnums(this.$loacalData.listRole,"sub_leader").value,area_leader:this.$loacalData.code_GetEnums(this.$loacalData.listRole,"area_leader").value,team_leader:this.$loacalData.code_GetEnums(this.$loacalData.listRole,"team_leader").value,customer:this.$loacalData.code_GetEnums(this.$loacalData.listRole,"customer").value}},mounted:function(){this.getRoleList(),this.getMenuList()},watch:{visible:function(e){e||(this.form={menuids:[],mobile_menuids:[]})}},methods:{getMenuList:function(){var e=this;this.$api.getMenu().then(function(t){e.menuList=t.data.menu_list,e.firstMenu1=t.data.menu_list.filter(function(e){return"/"==e.menu_path}).map(function(e){return e.menu_code}),e.firstMenu2=t.data.menu_list.filter(function(e){return"/"==e.menu_path}).map(function(e){return e.menu_code}),console.log(e.firstMenu1),console.log(e.firstMenu2)})},addRole:function(){var e=this;return this.form.menuids=[].concat(i()(this.$refs.tree1.getCheckedKeys()),i()(this.$refs.tree1.getHalfCheckedKeys())),this.form.mobile_menuids=[].concat(i()(this.$refs.tree2.getCheckedKeys()),i()(this.$refs.tree2.getHalfCheckedKeys())),0==this.form.menuids.length?void this.$message.error("请选择PC端角色权限"):0==this.form.mobile_menuids.length?void this.$message.error("请选择APP端角色权限"):void this.$refs.form.validate(function(t){t&&(e.form.role_id?e.$api.updateRole(e.form).then(function(t){e.handleClose(),e.getRoleList()}):e.$api.addRole(e.form).then(function(t){e.handleClose(),e.getRoleList()}))})},editRole:function(e){var t=this;this.$api.getRoleInfo({role_id:e}).then(function(e){console.log(e),t.visible=!0,t.form=e.data.role_msg[0],t.$nextTick(function(){var a=e.data.menu_code.filter(function(e){return!t.firstMenu1.some(function(t){return t===e})});t.$refs.tree1.setCheckedKeys(a);var r=e.data.mobile_menu_code.filter(function(e){return!t.firstMenu2.some(function(t){return t===e})});t.$refs.tree2.setCheckedKeys(r)})})},getRoleList:function(){var e=this;this.$api.getRoleList({page:this.pageNum-1,number:this.pageSize}).then(function(t){t.data.userList.map(function(e){return e.role_type="2"==e.role_type?"商户":"员工"}),t.data.userList.map(function(e){return"1"==e.role_level?e.role_level="一级(总行)":"2"==e.role_level?e.role_level="二级(分行/支行)":"3"==e.role_level?e.role_level="三级(片区/团队)":"4"==e.role_level?e.role_level="四级(客户经理)":void 0}),e.roleList=t.data.userList,e.total=t.data.total,e.form={menuids:[],mobile_menuids:[]}})},changeSize:function(e){this.pageSize=e,this.getRoleList()},changePage:function(e){this.pageNum=e,this.getRoleList()},deleteRole:function(e){var t=this;this.$confirm("确定删除该角色吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!0}).then(function(){t.$api.deleteRole({role_id:e}).then(function(e){console.log(e),t.getRoleList()})}).catch(function(){t.delList=[]})},handleClose:function(){this.visible=!1,this.form={menuids:[],mobile_menuids:[]},this.$refs.tree1.setCheckedKeys([]),this.$refs.tree2.setCheckedKeys([])}}}},,,,,function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-button",{staticStyle:{"margin-bottom":"10px"},attrs:{type:"primary",size:"small"},on:{click:function(t){e.visible=!0}}},[e._v("新增角色")]),e._v(" "),a("base-table",{attrs:{list:e.dataList,data:e.roleList}},[a("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",icon:"el-icon-edit-outline"},on:{click:function(a){return e.editRole(t.row.role_id)}}},[e._v("编辑")]),e._v(" "),t.row.role_id!==e.super_manager&&t.row.role_id!==e.head_manager&&t.row.role_id!==e.sub_manager&&t.row.role_id!==e.team_leader&&t.row.role_id!==e.customer&&t.row.role_id!==e.head_science&&t.row.role_id!==e.sub_leader&&t.row.role_id!==e.area_leader?a("el-button",{staticStyle:{color:"red"},attrs:{type:"text",icon:"el-icon-delete"},on:{click:function(a){return e.deleteRole(t.row.role_id)}}},[e._v("删除")]):e._e()]}}])})],1),e._v(" "),a("base-page",{attrs:{page:e.pageNum,size:e.pageSize,total:e.total},on:{size:e.changeSize,page:e.changePage}}),e._v(" "),a("el-dialog",{attrs:{title:e.form.role_id?"修改角色":"新增角色",visible:e.visible,width:"45%","before-close":e.handleClose},on:{"update:visible":function(t){e.visible=t}}},[a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"90px"}},[a("el-form-item",{attrs:{label:"角色名称",prop:"role_name"}},[a("el-input",{attrs:{size:"small",disabled:e.form.role_id===e.super_manager||e.form.role_id===e.head_manager||e.form.role_id===e.sub_manager||e.form.role_id===e.team_leader||e.form.role_id===e.customer||e.form.role_id===e.head_science||e.form.role_id===e.sub_leader||e.form.role_id===e.area_leader},model:{value:e.form.role_name,callback:function(t){e.$set(e.form,"role_name",t)},expression:"form.role_name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"角色类型",prop:"role_type"}},[a("el-radio",{attrs:{label:"1"},model:{value:e.form.role_type,callback:function(t){e.$set(e.form,"role_type",t)},expression:"form.role_type"}},[e._v("普通用户")])],1),e._v(" "),a("el-form-item",{attrs:{label:"角色级别",prop:"role_level"}},[a("el-radio-group",{attrs:{disabled:e.form.role_id===e.super_manager||e.form.role_id===e.head_manager||e.form.role_id===e.sub_manager||e.form.role_id===e.team_leader||e.form.role_id===e.customer||e.form.role_id===e.head_science||e.form.role_id===e.sub_leader||e.form.role_id===e.area_leader},model:{value:e.form.role_level,callback:function(t){e.$set(e.form,"role_level",t)},expression:"form.role_level"}},[a("el-radio",{attrs:{label:"1"}},[e._v("一级(总行)")]),e._v(" "),a("el-radio",{attrs:{label:"2"}},[e._v("二级(分行/支行)")]),e._v(" "),a("el-radio",{attrs:{label:"3"}},[e._v("三级(片区/团队)")]),e._v(" "),a("el-radio",{attrs:{label:"4"}},[e._v("四级(客户经理)")])],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"PC端菜单",prop:"menuids"}},[a("div",{staticStyle:{"overflow-y":"scroll",height:"200px",width:"100%"}},[a("el-tree",{ref:"tree1",attrs:{data:e.menuList,"show-checkbox":"","node-key":"menu_code","icon-class":"el-icon-s-flag","default-checked-keys":[5],props:e.defaultProps,"default-expand-all":"","check-on-click-node":""}})],1)]),e._v(" "),a("el-form-item",{attrs:{label:"APP端菜单",prop:"mobile_menuids"}},[a("div",{staticStyle:{"overflow-y":"scroll",height:"200px",width:"100%"}},[a("el-tree",{ref:"tree2",attrs:{data:e.menuList,"show-checkbox":"","node-key":"menu_code","icon-class":"el-icon-s-flag","default-checked-keys":[5],props:e.defaultProps,"default-expand-all":"","check-on-click-node":""}})],1)]),e._v(" "),a("el-form-item",{attrs:{label:"角色描述",prop:"role_desc"}},[a("el-input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:4},placeholder:"请输入内容"},model:{value:e.form.role_desc,callback:function(t){e.$set(e.form,"role_desc",t)},expression:"form.role_desc"}})],1)],1),e._v(" "),a("div",{staticStyle:{"text-align":"center"},attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:e.handleClose}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.addRole}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]}},function(e,t,a){var r=a(3)(a(460),a(461),null,null);e.exports=r.exports},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(6),i=a.n(r),o=a(5),l=a.n(o),s=a(10),n=a.n(s),p=a(22),c=a.n(p);t.default={components:{baseTable:l.a,basePage:n.a,BranchTreePicker:c.a},name:"branch",data:function(){return{role:sessionStorage.getItem("role"),form:{},bankid:"",bankname:"",dataList:[{label:"机构编号",prop:"branch_id",sort:!0},{label:"机构名称",prop:"branch_name",sort:!0},{label:"上级机构编号",prop:"porgid"}],rules:{branch_name:[{required:!0,message:"请输入团队/片区名称",trigger:"blur"}],team_flag:[{required:!0,message:"请选择团队/片区类型",trigger:"change"}],porgid:[{required:!0,message:"请选择所属机构",trigger:"change"}],generate_date:[{required:!0,message:"请选择成立日期",trigger:"blur"}]},branchList:[],sysUserList:[],pageNum:1,pageSize:10,total:0,visible:!1}},computed:{bankList:{get:function(){return this.$store.state.bankList},set:function(e){this.$store.state.bankList=e}}},mounted:function(){this.getAccountList()},watch:{visible:function(e){e||(this.form={})}},methods:{nodeselectForSerch:function(e){console.log(e),this.bankname=e.branch_name,this.bankid=e.branch_id},nodeselectForShow:function(e){this.$set(this.form,"porgname",e.branch_name),this.$set(this.form,"porgid",e.branch_id)},getAccountList:function(){var e=this;0==this.sysUserList.length&&this.$api.getAccountList({}).then(function(t){e.sysUserList=t.data})},getBranchList:function(){var e=this;this.$api.getBranchList(i()({page:this.pageNum-1,number:this.pageSize,bankid:this.bankid},this.form)).then(function(t){e.branchList=t.data.branchList,e.total=t.data.total})},addtBranch:function(){var e=this;this.$refs.form.validate(function(t){t&&(e.form.branch_id?e.$api.updatetBranch(e.form).then(function(t){e.handleClose(),e.getBranchList()}):e.$api.addtBranch(e.form).then(function(t){e.handleClose(),e.getBranchList()}))})},editBranch:function(e){var t=this;this.$api.getBranchDetail({branch_id:e}).then(function(e){console.log(e),t.visible=!0,t.form=e.data.msg[0]})},deleteBranch:function(e){var t=this;this.$confirm("确定删除吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!0}).then(function(){t.$api.deleteBranch({branch_id:e}).then(function(e){console.log(e),t.getBranchList()})}).catch(function(){})},changeSize:function(e){this.pageSize=e,this.getBranchList()},changePage:function(e){this.pageNum=e,this.getBranchList()},handleClose:function(){this.visible=!1,this.form={}}},beforeRouteEnter:function(e,t,a){a(function(t){e.params.searchKey&&(t.form=e.params.searchKey),t.getBranchList()})}}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-form",{staticStyle:{"margin-top":"15px"},attrs:{inline:!0,model:e.form}},[a("el-form-item",{attrs:{label:"所属机构",prop:"bankid"}},[a("div",{staticStyle:{display:"flex"}},[a("el-input",{attrs:{readonly:"",size:"small"},model:{value:e.bankname,callback:function(t){e.bankname=t},expression:"bankname"}}),e._v(" "),a("BranchTreePicker",{on:{nodeselect:e.nodeselectForSerch}})],1)]),e._v(" "),a("el-form-item",{attrs:{label:"机构类型",prop:"team_flag"}},[a("el-select",{attrs:{filterable:"",clearable:"",size:"small"},model:{value:e.form.team_flag,callback:function(t){e.$set(e.form,"team_flag",t)},expression:"form.team_flag"}},[a("el-option",{key:"0",attrs:{label:"组织",value:"0"}}),e._v(" "),a("el-option",{key:"1",attrs:{label:"团队",value:"1"}}),e._v(" "),a("el-option",{key:"2",attrs:{label:"片区",value:"2"}})],1)],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-search"},on:{click:e.getBranchList}},[e._v("搜索\n\t\t\t")])],1)],1),e._v(" "),a("base-table",{attrs:{list:e.dataList,data:e.branchList}},[a("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return"1"!=e.role&&"2"!=e.role||"1"!=t.row.team_flag&&"2"!=t.row.team_flag?void 0:[a("el-button",{attrs:{type:"text",icon:"el-icon-edit-outline"},on:{click:function(a){return e.editBranch(t.row.branch_id)}}},[e._v("编辑\n\t\t\t\t")]),e._v(" "),a("el-button",{staticStyle:{color:"red"},attrs:{type:"text",icon:"el-icon-delete"},on:{click:function(a){return e.deleteBranch(t.row.branch_id)}}},[e._v("删除\n\t\t\t\t")])]}}],null,!0)})],1),e._v(" "),a("base-page",{attrs:{page:e.pageNum,size:e.pageSize,total:e.total},on:{size:e.changeSize,page:e.changePage}}),e._v(" "),a("el-dialog",{attrs:{title:e.form.branch_id?"修改":"新增",visible:e.visible,width:"45%","before-close":e.handleClose},on:{"update:visible":function(t){e.visible=t}}},[a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"90px"}},[!this.form.branch_id?e._e():a("el-form-item",{staticStyle:{width:"360px"},attrs:{label:"团队/片区编号",prop:"branch_id"}},[a("el-input",{attrs:{disabled:!0},model:{value:e.form.branch_id,callback:function(t){e.$set(e.form,"branch_id",t)},expression:"form.branch_id"}})],1),e._v(" "),a("el-form-item",{staticStyle:{width:"360px"},attrs:{label:"团队/片区名称",prop:"branch_name"}},[a("el-input",{model:{value:e.form.branch_name,callback:function(t){e.$set(e.form,"branch_name",t)},expression:"form.branch_name"}})],1),e._v(" "),a("el-form-item",{staticStyle:{width:"360px"},attrs:{label:"团队/片区类型",prop:"team_flag"}},[a("el-radio-group",{attrs:{disabled:!!e.form.branch_id},model:{value:e.form.team_flag,callback:function(t){e.$set(e.form,"team_flag",t)},expression:"form.team_flag"}},[a("el-radio",{attrs:{label:"1"}},[e._v("团队")]),e._v(" "),a("el-radio",{attrs:{label:"2"}},[e._v("片区")])],1)],1),e._v(" "),a("el-form-item",{staticStyle:{width:"360px"},attrs:{label:"所属机构",prop:"porgid"}},[a("div",{staticStyle:{display:"flex"}},[a("el-input",{attrs:{disabled:!0},model:{value:this.form.porgname,callback:function(t){e.$set(this.form,"porgname",t)},expression:"this.form.porgname"}}),e._v(" "),a("BranchTreePicker",{attrs:{dfks:this.form.porgid,appendToBody:!0},on:{nodeselect:e.nodeselectForShow}})],1)]),e._v(" "),a("el-form-item",{staticStyle:{width:"360px"},attrs:{label:"成立日期",prop:"generate_date"}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date","value-format":"yyyy-MM-dd",placeholder:"选择日期"},model:{value:e.form.generate_date,callback:function(t){e.$set(e.form,"generate_date",t)},expression:"form.generate_date"}})],1),e._v(" "),a("el-form-item",{staticStyle:{width:"360px"},attrs:{label:"团队/片区负责人",prop:"team_leader"}},[a("el-select",{attrs:{clearable:"",filterable:""},model:{value:e.form.team_leader,callback:function(t){e.$set(e.form,"team_leader",t)},expression:"form.team_leader"}},e._l(e.sysUserList,function(e){return a("el-option",{key:e.account_id,attrs:{label:e.account_id+"-"+e.name,value:e.account_id}})}),1)],1),e._v(" "),"1"==e.form.team_flag?a("el-form-item",{staticStyle:{width:"360px"},attrs:{label:"团队人数",prop:"team_num"}},[a("el-input",{attrs:{disabled:!0},model:{value:e.form.team_num,callback:function(t){e.$set(e.form,"team_num",t)},expression:"form.team_num"}})],1):e._e(),e._v(" "),"2"==e.form.team_flag?a("el-form-item",{staticStyle:{width:"360px"},attrs:{label:"团队数",prop:"team_count"}},[a("el-input",{attrs:{disabled:!0},model:{value:e.form.team_count,callback:function(t){e.$set(e.form,"team_count",t)},expression:"form.team_count"}})],1):e._e(),e._v(" "),"2"==e.form.team_flag?a("el-form-item",{staticStyle:{width:"360px"},attrs:{label:"片区人数",prop:"area_num"}},[a("el-input",{attrs:{disabled:!0},model:{value:e.form.area_num,callback:function(t){e.$set(e.form,"area_num",t)},expression:"form.area_num"}})],1):e._e(),e._v(" "),a("el-form-item",{staticStyle:{width:"360px"},attrs:{label:"其他",prop:"remarks"}},[a("el-input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:4},placeholder:"请输入内容"},model:{value:e.form.remarks,callback:function(t){e.$set(e.form,"remarks",t)},expression:"form.remarks"}})],1)],1),e._v(" "),a("div",{staticStyle:{"text-align":"center"},attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:e.handleClose}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.addtBranch}},[e._v("确 定\n\t\t\t")])],1)],1)],1)},staticRenderFns:[]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(6),i=a.n(r),o=a(33),l=a.n(o),s=a(22),n=a.n(s),p=a(159),c=a(160),u=a.n(c),d=a(5),m=a.n(d);t.default={mixins:[p.a],components:{BranchTreePicker:n.a,showChart:u.a,baseTable:m.a},name:"addTeam",data:function(){return{depositList:[{label:"资产余额",key:"amt1"},{label:"资产年日均",key:"amt2"},{label:"存款余额",key:"amt3"},{label:"存款年日均",key:"amt4"}],teamCusList:[{label:"所有客户数",key:"cus_num1"},{label:"高净值客户数",key:"cus_num2"},{label:"价值客户数",key:"cus_num3"},{label:"有效客户数",key:"cus_num4"}],teamExpandList:[{label:"试营业服务点数",key:"site_num1"},{label:"试营业（已申请POS）服务点数",key:"site_num2"},{label:"已开业服务点数",key:"site_num3"},{label:"已退出服务点数",key:"site_num4"}],form:{suggestion:""},teamList:[],check:!1,bankList:[],accountList:[],sysUserList:[],type009:this.$loacalData.code_GetEnums(this.$loacalData.listApprovalType,"009").code,type010:this.$loacalData.code_GetEnums(this.$loacalData.listApprovalType,"010").code,type011:this.$loacalData.code_GetEnums(this.$loacalData.listApprovalType,"011").code,type012:this.$loacalData.code_GetEnums(this.$loacalData.listApprovalType,"012").code,type013:this.$loacalData.code_GetEnums(this.$loacalData.listApprovalType,"013").code,use_up:"",req_place:"",parms:{},hisLogList:[{label:"申请日期",prop:"create_time",sort:!0},{label:"申请编号",prop:"id"},{label:"审批类型",prop:"approval_type_name"},{label:"审批状态",prop:"approval_status_name"}],approvalHisLogList:[],hisList:[{label:"时间",prop:"create_time",sort:!0},{label:"节点名称",prop:"role_name"},{label:"操作人员编号",prop:"approval_user"},{label:"操作人员姓名",prop:"name"},{label:"操作",prop:"approval_opinion"},{label:"处理意见",prop:"approval_desc"}],approvalHisList:[],his_visible:!1}},mounted:function(){var e=this;this.check="false"!==this.$route.query.check&&Boolean(this.$route.query.check),this.id=this.$route.query.id,this.req_place=this.$route.query.req_place||"0",this.id?this.$api.getTeamDetail({id:this.id}).then(function(t){e.form=t.data.teamDetail,console.log(e.form),e.baseForm=JSON.parse(l()(e.form))}):this.$api.getTempTeamDetail({}).then(function(t){t.data.teamDetail&&(e.form=t.data.teamDetail)}),this.getAccountList(),this.check||this.getApprovalQY(),this.check&&"0"===this.req_place&&this.getApprovalHisLogList(this.id)},watch:{visible:function(e){e||(this.form={})}},computed:{approval_type:function(){return this.$route.query.approval_type||this.type009},rules:function(){return{branch_name:[{required:void 0==this.$route.query.approval_type||this.$route.query.approval_type==this.type009||this.$route.query.approval_type==this.type010,message:"请输入团队/片区名称",trigger:"blur"}],team_flag:[{required:void 0==this.$route.query.approval_type||this.$route.query.approval_type==this.type009||this.$route.query.approval_type==this.type011,message:"请选择团队/片区类型",trigger:"change"}],porgid:[{required:void 0==this.$route.query.approval_type||this.$route.query.approval_type==this.type009||this.$route.query.approval_type==this.type012,message:"请选择所属机构",trigger:"change"}],generate_date:[{required:void 0==this.$route.query.approval_type||this.$route.query.approval_type==this.type009||this.$route.query.approval_type==this.type010,message:"请选择成立日期",trigger:"blur"}],approval_user:[{required:!0,message:"请选择审批人",trigger:"change"}]}}},methods:{getApprovalHisLogList:function(e){var t=this;this.$api.getApprovalHisLogList({req_type:"1",id:e}).then(function(e){t.approvalHisLogList=e.data})},showHisDetail:function(e){var t=this;this.approvalHisList=[],this.$api.getApprovalHisList({apply_id:e}).then(function(e){t.his_visible=!0,t.approvalHisList=e.data})},handleHisClose:function(){this.his_visible=!1},open:function(){var e=this;this.$prompt("","申请说明",{confirmButtonText:"确定",cancelButtonText:"取消",inputType:"textarea",inputPattern:/^(.|\n){1,300}$/,inputErrorMessage:"申请说明不能为空且不能超过300字",inputPlaceholder:"输入内容不能超过300字"}).then(function(t){var a=t.value;e.form.suggestion=a,e.onSubmit()}).catch(function(){e.$message({type:"info",message:"取消提交"})})},getThanData:function(e){var t=this;this.parms.query_date=e.name;var a=this.parms,r=this.parms.query_item;"amt1"===r||"amt2"===r||"amt3"===r||"amt4"===r?this.$api.getReport001List(a).then(function(e){t.tooltip='<div style="padding: 0 10px">\n                                        <h5><span>时点值:</span><span>'+e.data[r]+"</span></h5>\n                                        <h5><span>比上日:</span><span>"+e.data.than_last_day+"</span></h5>\n                                        <h5><span>比上月:</span><span>"+e.data.than_last_month+"</span></h5>\n                                        <h5><span>比年初:</span><span>"+e.data.than_last_year+"</span></h5>\n                                      </div>\n                                      "}):"cus_num1"===r||"cus_num2"===r||"cus_num3"===r||"cus_num4"===r?this.$api.getReport002List(a).then(function(e){t.tooltip='<div style="padding: 0 10px">\n                                        <h5><span>时点值:</span><span>'+e.data[r]+"</span></h5>\n                                        <h5><span>比上日:</span><span>"+e.data.than_last_day+"</span></h5>\n                                        <h5><span>比上月:</span><span>"+e.data.than_last_month+"</span></h5>\n                                        <h5><span>比年初:</span><span>"+e.data.than_last_year+"</span></h5>\n                                      </div>\n                                      "}):"site_num1"!==r&&"site_num2"!==r&&"site_num3"!==r&&"site_num4"!==r||this.$api.getReport003List(a).then(function(e){t.tooltip='<div style="padding: 0 10px">\n                                        <h5><span>时点值:</span><span>'+e.data[r]+"</span></h5>\n                                        <h5><span>比上日:</span><span>"+e.data.than_last_day+"</span></h5>\n                                        <h5><span>比上月:</span><span>"+e.data.than_last_month+"</span></h5>\n                                        <h5><span>比年初:</span><span>"+e.data.than_last_year+"</span></h5>\n                                      </div>\n                                      "})},childSearch:function(e){this.parms.query_date=e.query_date,this.getData(this.parms)},getData:function(e){var t=this;this.parms=e,this.$api.getReport004List(e).then(function(e){t.option.xAxis.data=e.data.dateList,t.option.series[0].data=e.data.dataList})},nodeselectForShow:function(e){console.log(e),this.$set(this.form,"porgname",e.branch_name),this.$set(this.form,"porgid",e.branch_id)},getAccountList:function(){var e=this;0==this.sysUserList.length&&this.$api.getAccountList({}).then(function(t){e.sysUserList=t.data})},getApprovalAccountList:function(){var e=this;this.$api.getApprovalAccountList(i()({approval_type:this.approval_type||this.type009},this.form)).then(function(t){e.accountList=t.data.dataList})},getApprovalQY:function(){var e=this;this.$api.getApprovalQY({approval_type:this.$route.query.approval_type||this.type009}).then(function(t){e.use_up=t.data.use_up})},tempSubmit:function(){var e=this;if(this.check)return void this.$router.back(-1);this.$api.tempaddTeam(this.form).then(function(t){e.$message.success("暂存成功")})},onSubmit:function(){var e=this;if(this.check)return void this.$router.back(-1);this.$refs.form.validate(function(t){if(t){e.form.approval_type=e.approval_type,e.form.req_place=e.req_place,e.form.apply_id=e.$route.query.apply_id||"",e.form.use_up=e.use_up;var a=[];for(var r in e.baseForm)e.baseForm[r]!=e.form[r]&&a.push(e.labelList[r]);a.length>0&&(e.form.update_items=a.join(",")),e.$api.addTeam(e.form).then(function(t){e.handleClose(),e.$message.success("操作成功，你已跳转至我的申请页面"),e.$router.push({path:"/approvalApply",name:"我的申请"})})}})},handleClose:function(){this.visible=!1,this.form={}}},beforeRouteLeave:function(e,t,a){e.params.searchKey=this.$route.params.searchKey,a()}}},function(e,t){},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(465),i=a.n(r);t.default={props:{title:"默认",option:{type:Object,default:function(){return{}}}},components:{chart:i.a},data:function(){return{chartShow:!1,name:"",tooltip:"",form:{query_date:""}}},methods:{showChart:function(){this.$emit("get-data",this.form)}}}},function(e,t,a){var r=a(3)(a(466),a(757),null,null);e.exports=r.exports},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(467),i=a.n(r);t.default={name:"chart",data:function(){return{chart:""}},methods:{drawCharts:function(){this.chart=i.a.init(this.$refs.charts),this.chart.setOption(this.option),window.addEventListener("resize",this.chart.resize)}},mounted:function(){this.drawCharts()},props:["option"],watch:{option:{handler:function(e,t){this.chart?e?this.chart.setOption(e):this.chart.setOption(t):this.init()},deep:!0}}}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t){e.exports={render:function(){var e=this,t=e.$createElement;return(e._self._c||t)("div",{ref:"charts",staticStyle:{height:"400px",margin:"0 auto"}})},staticRenderFns:[]}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{staticClass:"chart-dialog",attrs:{title:"",visible:e.chartShow,width:"50%"},on:{"update:visible":function(t){e.chartShow=t}}},[a("el-form",{attrs:{model:e.form,inline:""}},[a("el-form-item",{attrs:{label:"选择日期"}},[a("el-date-picker",{attrs:{size:"small",type:"date","value-format":"yyyyMMdd",placeholder:"选择日期"},model:{value:e.form.query_date,callback:function(t){e.$set(e.form,"query_date",t)},expression:"form.query_date"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.showChart}},[e._v("查询")])],1)],1),e._v(" "),a("chart",{attrs:{option:e.option}}),e._v(" "),a("span",{attrs:{slot:"footer"},slot:"footer"})],1)},staticRenderFns:[]}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-row",{attrs:{gutter:50}},[a("el-col",{attrs:{span:12}},[a("el-divider",{attrs:{"content-position":"left"}},[e._v("团队基本信息\n      ")]),e._v(" "),a("el-form",{ref:"form",attrs:{"status-icon":"",rules:e.rules,model:e.form,"label-width":"120px"}},[!this.form.id?e._e():a("el-form-item",{attrs:{label:"团队/片区编号",prop:"branch_id"}},[a("el-input",{attrs:{disabled:!0},model:{value:e.form.branch_id,callback:function(t){e.$set(e.form,"branch_id",t)},expression:"form.branch_id"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"团队/片区名称",prop:"branch_name"}},[a("el-input",{attrs:{disabled:e.check||e.approval_type!==e.type010&&e.approval_type!==e.type009},model:{value:e.form.branch_name,callback:function(t){e.$set(e.form,"branch_name",t)},expression:"form.branch_name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"团队/片区类型",prop:"team_flag"}},[a("el-radio-group",{attrs:{disabled:e.check||e.approval_type!==e.type011&&e.approval_type!==e.type009},model:{value:e.form.team_flag,callback:function(t){e.$set(e.form,"team_flag",t)},expression:"form.team_flag"}},[a("el-radio",{attrs:{label:"1"}},[e._v("团队\n            ")]),e._v(" "),a("el-radio",{attrs:{label:"2"}},[e._v("片区\n            ")])],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"所属机构",prop:"porgid"}},[a("div",{staticStyle:{display:"flex"}},[a("el-input",{attrs:{disabled:!0},model:{value:this.form.porgname,callback:function(t){e.$set(this.form,"porgname",t)},expression:"\n                this.form.porgname\n              "}}),e._v(" "),a("BranchTreePicker",{directives:[{name:"show",rawName:"v-show",value:!e.check&&(e.approval_type===e.type012||e.approval_type===e.type009),expression:"!check && (approval_type === type012 || approval_type === type009)"}],attrs:{dfks:this.form.porgid,appendToBody:!0},on:{nodeselect:e.nodeselectForShow}})],1)]),e._v(" "),a("el-form-item",{attrs:{label:"成立日期",prop:"generate_date"}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date","value-format":"yyyy-MM-dd",placeholder:"选择日期",disabled:e.check||e.approval_type!==e.type010&&e.approval_type!==e.type009},model:{value:e.form.generate_date,callback:function(t){e.$set(e.form,"generate_date",t)},expression:"\n              form.generate_date\n            "}})],1),e._v(" "),a("el-form-item",{attrs:{label:"团队/片区负责人",prop:"team_leader"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{disabled:e.check||e.approval_type!==e.type013&&e.approval_type!==e.type009,clearable:"",filterable:""},model:{value:e.form.team_leader,callback:function(t){e.$set(e.form,"team_leader",t)},expression:"form.team_leader"}},e._l(e.sysUserList,function(e){return a("el-option",{key:e.account_id,attrs:{label:e.account_id+"-"+e.name,value:e.account_id}})}),1)],1),e._v(" "),"1"==e.form.team_flag?a("el-form-item",{attrs:{label:"团队人数",prop:"team_num"}},[a("el-input",{attrs:{disabled:!0},model:{value:e.form.team_num,callback:function(t){e.$set(e.form,"team_num",t)},expression:"form.team_num"}})],1):e._e(),e._v(" "),"2"==e.form.team_flag?a("el-form-item",{attrs:{label:"团队数",prop:"team_count"}},[a("el-input",{attrs:{disabled:!0},model:{value:e.form.team_count,callback:function(t){e.$set(e.form,"team_count",t)},expression:"form.team_count"}})],1):e._e(),e._v(" "),"2"==e.form.team_flag?a("el-form-item",{attrs:{label:"片区人数",prop:"area_num"}},[a("el-input",{attrs:{disabled:!0},model:{value:e.form.area_num,callback:function(t){e.$set(e.form,"area_num",t)},expression:"form.area_num"}})],1):e._e(),e._v(" "),a("el-form-item",{attrs:{label:"其他",prop:"remarks"}},[a("el-input",{attrs:{disabled:e.check||e.approval_type!==e.type010&&e.approval_type!==e.type009,type:"textarea",autosize:{minRows:2,maxRows:4},placeholder:"请输入内容"},model:{value:e.form.remarks,callback:function(t){e.$set(e.form,"remarks",t)},expression:"form.remarks"}})],1),e._v(" "),e.check||"1"!==this.use_up||"1"===e.req_place?e._e():a("el-form-item",{attrs:{label:"审批人",prop:"approval_user"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{disabled:e.check,clearable:"",filterable:""},nativeOn:{click:function(t){return e.getApprovalAccountList.apply(null,arguments)}},model:{value:e.form.approval_user,callback:function(t){e.$set(e.form,"approval_user",t)},expression:"\n              form.approval_user\n            "}},e._l(e.accountList,function(e){return a("el-option",{key:e.account_id,attrs:{label:e.approval_name,value:e.account_id}})}),1)],1),e._v(" "),a("el-form-item",[e.check||e.approval_type!==e.type009||"1"===e.req_place?e._e():a("el-button",{attrs:{id:"tempButton",type:"primary",size:"medium"},on:{click:e.tempSubmit}},[e._v(e._s("暂存")+"\n          ")]),e._v(" "),e.check?e._e():a("el-button",{attrs:{id:"editButton",type:"primary",size:"medium"},on:{click:e.open}},[e._v(e._s("提交")+"\n          ")])],1)],1)],1),e._v(" "),e.check&&"0"===e.req_place?a("el-col",{attrs:{span:12}},[a("el-divider",{attrs:{"content-position":"left"}},[e._v("团队业绩数据\n      ")]),e._v(" "),e._l(e.depositList,function(t,r){return a("el-row",{key:t.key,staticClass:"table-item"},[a("el-col",{attrs:{span:8}},[e._v(e._s(t.label))]),e._v(" "),a("el-col",{attrs:{span:8}},[e._v(e._s(e.form[t.key]))]),e._v(" "),a("el-col",{attrs:{span:8}},[a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.showChart({branch_id:e.form.branch_id,query_item:t.key})}}},[e._v("查看视图\n          ")])],1)],1)})],2):e._e(),e._v(" "),e.check&&"0"===e.req_place?a("el-col",{attrs:{span:12}},[a("el-divider",{attrs:{"content-position":"left"}},[e._v("团队客户数据\n      ")]),e._v(" "),e._l(e.teamCusList,function(t,r){return a("el-row",{key:t.key,staticClass:"table-item"},[a("el-col",{attrs:{span:8}},[e._v(e._s(t.label))]),e._v(" "),a("el-col",{attrs:{span:8}},[e._v(e._s(e.form[t.key]))]),e._v(" "),a("el-col",{attrs:{span:8}},[a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.showChart({branch_id:e.form.branch_id,query_item:t.key})}}},[e._v("查看视图\n          ")])],1)],1)})],2):e._e(),e._v(" "),e.check&&"0"===e.req_place?a("el-col",{attrs:{span:12}},[a("el-divider",{attrs:{"content-position":"left"}},[e._v("团队拓展数据\n      ")]),e._v(" "),e._l(e.teamExpandList,function(t,r){return a("el-row",{key:t.key,staticClass:"table-item"},[a("el-col",{attrs:{span:8}},[e._v(e._s(t.label))]),e._v(" "),a("el-col",{attrs:{span:8}},[e._v(e._s(e.form[t.key]))]),e._v(" "),a("el-col",{attrs:{span:8}},[a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.showChart({branch_id:e.form.branch_id,query_item:t.key})}}},[e._v("查看视图\n          ")])],1)],1)})],2):e._e()],1),e._v(" "),a("show-chart",{ref:"chartShow",attrs:{option:e.option},on:{"get-data":e.childSearch}}),e._v(" "),e.check&&"0"===e.req_place?a("el-row",{attrs:{gutter:50}},[a("el-col",{attrs:{span:24}},[a("el-divider",{attrs:{direction:"horizontal","content-position":"center"}},[e._v("\n        审批记录\n      ")]),e._v(" "),a("base-table",{attrs:{list:e.hisLogList,data:e.approvalHisLogList}},[a("el-table-column",{attrs:{fixed:"right",label:"操作",align:"center",width:"240"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text"},nativeOn:{click:function(a){return e.showHisDetail(t.row.id)}}},[e._v("详情")])]}}],null,!1,261131152)})],1)],1)],1):e._e(),e._v(" "),a("el-dialog",{attrs:{title:"审批历史",visible:e.his_visible,width:"80%","before-close":e.handleHisClose},on:{"update:visible":function(t){e.his_visible=t}}},[a("base-table",{attrs:{list:e.hisList,data:e.approvalHisList}}),e._v(" "),a("div",{staticStyle:{"text-align":"center"},attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:e.handleHisClose}},[e._v("关 闭")])],1)],1)],1)},staticRenderFns:[]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(6),i=a.n(r),o=a(5),l=a.n(o),s=a(10),n=a.n(s),p=a(22),c=a.n(p);t.default={components:{baseTable:l.a,basePage:n.a,BranchTreePicker:c.a},name:"team",data:function(){return{user:JSON.parse(sessionStorage.getItem("user")),role_id:sessionStorage.getItem("role_id"),role:sessionStorage.getItem("role"),form:{},bankid:"",bankname:"",dataList:[{label:"团队/片区编号",prop:"branch_id",sort:!0},{label:"团队/片区名称",prop:"branch_name",sort:!0},{label:"团队/片区类型",prop:"team_flag"},{label:"资产余额（元）",prop:"amt1"},{label:"资产年日均（元）",prop:"amt2"},{label:"存款余额（元）",prop:"amt3"},{label:"存款年日均（元）",prop:"amt4"},{label:"试营业服务点数",prop:"site_num1"},{label:"开业服务点数",prop:"site_num2"},{label:"客户数",prop:"cus_num1"}],teamList:[],pageNum:1,pageSize:10,total:0,flag:"",type010:this.$loacalData.code_GetEnums(this.$loacalData.listApprovalType,"010").code,type011:this.$loacalData.code_GetEnums(this.$loacalData.listApprovalType,"011").code,type012:this.$loacalData.code_GetEnums(this.$loacalData.listApprovalType,"012").code,type013:this.$loacalData.code_GetEnums(this.$loacalData.listApprovalType,"013").code,type020:this.$loacalData.code_GetEnums(this.$loacalData.listApprovalType,"020").code,loading:!1}},computed:{bankList:{get:function(){return this.$store.state.bankList},set:function(e){this.$store.state.bankList=e}},isTeamDetail:function(){return"/teamDetail"==this.$route.path}},mounted:function(){},methods:{nodeselectForSerch:function(e){console.log(e),this.bankname=e.branch_name,this.bankid=e.branch_id},beforeEdit:function(e,t){"2"===e&&"0"===t||this.$message({message:"暂无可做操作",type:"warning"})},editTeam:function(e,t,a){this.$router.push({path:"/teamAddDetail",query:{id:e,role:this.role,check:t,approval_type:a},params:{searchKey:this.form}})},deleteTeam:function(e,t,a){this.$router.push({path:"/teamAddDetail",query:{id:e,role:this.role,check:t,approval_type:a},params:{searchKey:this.form}})},getTeamList:function(){var e=this;this.$api.getTeamList(i()({page:this.pageNum-1,number:this.pageSize,is_approval:0,bankid:this.bankid},this.form)).then(function(t){t.data.teamList.map(function(e){return e.team_flag="1"==e.team_flag?"团队":"片区"}),e.teamList=t.data.teamList,e.total=t.data.total})},exportTeamInfos:function(){var e=this;this.loading=!0,this.$api.exportTeamInfos(i()({bankid:this.bankid},this.form)).then(function(t){e.loading=!1;var a=t.data.fileName,r=t.data.filePath;if(null==a||null==r)return e.$message({message:"导出失败，系统异常",type:"error"}),!1;var i=document.createElement("form");document.body.appendChild(i),i.method="post",i.action="/hnm/txCtrl?txcode=mediaFile",i.enctype="multipart/form-data";var o=document.createElement("input"),l=document.createElement("input"),s=document.createElement("input"),n=document.createElement("input");o.setAttribute("name","filePath"),o.setAttribute("type","hidden"),o.setAttribute("value",r),l.setAttribute("name","fileName"),l.setAttribute("type","hidden"),l.setAttribute("value",a),s.setAttribute("name","isDownload"),s.setAttribute("type","hidden"),s.setAttribute("value","1"),n.setAttribute("name","isDelete"),n.setAttribute("type","hidden"),n.setAttribute("value","1"),i.appendChild(o),i.appendChild(l),i.appendChild(s),i.appendChild(n),i.submit(),e.$message({message:"导出成功",type:"success"})})},changeSize:function(e){this.pageSize=e,this.getTeamList()},changePage:function(e){this.pageNum=e,this.getTeamList()}},beforeRouteEnter:function(e,t,a){a(function(t){e.params.searchKey&&(t.form=e.params.searchKey),t.getTeamList()})}}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-form",{attrs:{inline:!0,model:e.form}},[e.isTeamDetail?a("el-button",{attrs:{type:"warning",size:"small",loading:e.loading},on:{click:e.exportTeamInfos}},[e._v("导出全部查询数据")]):e._e(),e._v(" "),a("div",{staticStyle:{"margin-top":"15px"}},[a("el-form-item",{attrs:{label:"所属机构",prop:"bankid"}},[a("div",{staticStyle:{display:"flex"}},[a("el-input",{attrs:{readonly:"",size:"small"},model:{value:e.bankname,callback:function(t){e.bankname=t},expression:"bankname"}}),e._v(" "),a("BranchTreePicker",{on:{nodeselect:e.nodeselectForSerch}})],1)]),e._v(" "),a("el-form-item",{attrs:{label:"团队/片区编号"}},[a("el-input",{attrs:{clearable:"",placeholder:"请输入团队/片区编号",size:"small"},model:{value:e.form.branch_id,callback:function(t){e.$set(e.form,"branch_id",t)},expression:"form.branch_id"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"团队/片区名称"}},[a("el-input",{attrs:{clearable:"",placeholder:"请输入团队/片区名称",size:"small"},model:{value:e.form.branch_name,callback:function(t){e.$set(e.form,"branch_name",t)},expression:"form.branch_name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"团队/片区类型",prop:"team_flag"}},[a("el-select",{attrs:{clearable:"",size:"small"},model:{value:e.form.team_flag,callback:function(t){e.$set(e.form,"team_flag",t)},expression:"form.team_flag"}},[a("el-option",{key:"1",attrs:{label:"团队",value:"1"}}),e._v(" "),a("el-option",{key:"2",attrs:{label:"片区",value:"2"}})],1)],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-search"},on:{click:e.getTeamList}},[e._v("搜索\n                ")])],1)],1)],1),e._v(" "),a("base-table",{attrs:{list:e.dataList,data:e.teamList}},[a("el-table-column",{attrs:{fixed:"right",label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[[e.isTeamDetail?e._e():a("el-dropdown",{attrs:{placement:"bottom"}},[a("el-button",{attrs:{type:"text",icon:"el-icon-edit-outline"},on:{click:function(a){return e.beforeEdit(t.row.approval_status,t.row.team_show)}}},[e._v("操作\n                ")]),a("i",{staticClass:"el-icon-arrow-down el-icon--right"}),e._v(" "),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},["2"==t.row.approval_status&&"0"==t.row.team_show?a("el-dropdown-item",{nativeOn:{click:function(a){return e.editTeam(t.row.id,!1,e.type010)}}},[e._v("团队基本信息调整")]):e._e(),e._v(" "),"2"==t.row.approval_status&&"0"==t.row.team_show?a("el-dropdown-item",{nativeOn:{click:function(a){return e.editTeam(t.row.id,!1,e.type011)}}},[e._v("团队类型调整")]):e._e(),e._v(" "),"2"==t.row.approval_status&&"0"==t.row.team_show?a("el-dropdown-item",{nativeOn:{click:function(a){return e.editTeam(t.row.id,!1,e.type012)}}},[e._v("团队所属机构调整")]):e._e(),e._v(" "),"2"==t.row.approval_status&&"0"==t.row.team_show?a("el-dropdown-item",{nativeOn:{click:function(a){return e.editTeam(t.row.id,!1,e.type013)}}},[e._v("团队负责人调整")]):e._e(),e._v(" "),"2"==t.row.approval_status&&"0"==t.row.team_show?a("el-dropdown-item",{nativeOn:{click:function(a){return e.deleteTeam(t.row.id,!1,e.type020)}}},[e._v("删除团队")]):e._e()],1)],1)],e._v(" "),e.isTeamDetail?a("el-button",{attrs:{type:"text",icon:"el-icon-edit-outline"},on:{click:function(a){return e.editTeam(t.row.id,!0)}}},[e._v("查看\n                ")]):e._e()]}}])})],1),e._v(" "),a("base-page",{attrs:{page:e.pageNum,size:e.pageSize,total:e.total},on:{size:e.changeSize,page:e.changePage}})],1)},staticRenderFns:[]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(6),i=a.n(r),o=a(33),l=a.n(o),s=a(22),n=a.n(s),p=a(159),c=a(160),u=a.n(c),d=a(5),m=a.n(d);t.default={mixins:[p.a],components:{BranchTreePicker:n.a,showChart:u.a,baseTable:m.a},name:"addStaff",data:function(){return{depositList:[{label:"资产余额",key:"amt1"},{label:"资产年日均",key:"amt2"},{label:"存款余额",key:"amt3"},{label:"存款年日均",key:"amt4"}],teamCusList:[{label:"所有客户数",key:"cus_num1"},{label:"高净值客户数",key:"cus_num2"},{label:"价值客户数",key:"cus_num3"},{label:"有效客户数",key:"cus_num4"}],teamExpandList:[{label:"试营业服务点数",key:"site_num1"},{label:"试营业（已申请POS）服务点数",key:"site_num2"},{label:"已开业服务点数",key:"site_num3"},{label:"已退出服务点数",key:"site_num4"}],form:{roleids:[],suggestion:""},id:"",userList:[],check:!1,accountList:[],type002:this.$loacalData.code_GetEnums(this.$loacalData.listApprovalType,"002").code,type003:this.$loacalData.code_GetEnums(this.$loacalData.listApprovalType,"003").code,type014:this.$loacalData.code_GetEnums(this.$loacalData.listApprovalType,"014").code,type015:this.$loacalData.code_GetEnums(this.$loacalData.listApprovalType,"015").code,approval_type:this.$route.query.approval_type||this.$loacalData.code_GetEnums(this.$loacalData.listApprovalType,"002").code,baseForm:{},roleList:[],use_up:"",req_place:"",parms:{},hisLogList:[{label:"申请日期",prop:"create_time",sort:!0},{label:"申请编号",prop:"id"},{label:"审批类型",prop:"approval_type_name"},{label:"审批状态",prop:"approval_status_name"}],approvalHisLogList:[],hisList:[{label:"时间",prop:"create_time",sort:!0},{label:"节点名称",prop:"role_name"},{label:"操作人员编号",prop:"approval_user"},{label:"操作人员姓名",prop:"name"},{label:"操作",prop:"approval_opinion"},{label:"处理意见",prop:"approval_desc"}],approvalHisList:[],his_visible:!1}},computed:{bankList:{get:function(){return this.$store.state.bankList},set:function(e){this.$store.state.bankList=e}},rules:function(){var e=function(e,t,a){if(void 0!==t&&""!=t&&null!=t||a(),!/^1[3456789]\d{9}$/.test(t))return a(new Error("手机号码非法"));a()},t=function(e,t,a){if(void 0!==t&&""!=t&&null!=t||a(),!/^([a-zA-Z0-9_-])+@([a-zA-Z0-9_-])+(\.[a-zA-Z0-9_-])+/.test(t))return a(new Error("电子邮箱非法"));a()},a=function(e,t,a){if(void 0!==t&&""!=t&&null!=t||a(),!/^(?:[1-9][0-9]?|1[01][0-9]|120)$/.test(t))return a(new Error("年龄非法"));a()};return{mgr_id:[{required:void 0==this.$route.query.approval_type||this.$route.query.approval_type==this.type002||this.$route.query.approval_type==this.type003,message:"请输入工号",trigger:"blur"},{min:1,max:10,message:"工号在 1 到 10 个字符",trigger:"blur"}],mgr_name:[{required:void 0==this.$route.query.approval_type||this.$route.query.approval_type==this.type002||this.$route.query.approval_type==this.type003,message:"请输入员工姓名",trigger:"blur"},{min:2,max:5,message:"名字在 2 到 5 个字符",trigger:"blur"}],role:[{required:void 0==this.$route.query.approval_type||this.$route.query.approval_type==this.type002||this.$route.query.approval_type==this.type014,message:"请选择角色",trigger:"change"}],branch_id:[{required:void 0==this.$route.query.approval_type||this.$route.query.approval_type==this.type002||this.$route.query.approval_type==this.type015,message:"请选择所属机构",trigger:"change"}],phone:[{required:void 0==this.$route.query.approval_type||this.$route.query.approval_type==this.type002||this.$route.query.approval_type==this.type003,message:"请输入手机号",trigger:"blur"},{validator:e,trigger:"blur"}],e_mail:[{message:"请输入电子邮箱",trigger:"blur"},{validator:t,trigger:"blur"}],age:[{message:"请输入年龄",trigger:"blur"},{validator:a,trigger:"blur"}],approval_user:[{required:!0,message:"选择审批人",trigger:"change"}]}}},mounted:function(){var e=this;this.check="false"!==this.$route.query.check&&Boolean(this.$route.query.check),this.id=this.$route.query.id,this.req_place=this.$route.query.req_place||"0",this.id?this.$api.getStaffDetail({id:this.id,req_place:this.req_place}).then(function(t){e.form=t.data.staffDetail,e.baseForm=JSON.parse(l()(t.data.staffDetail)),1==t.data.roleList.length&&(e.$set(e.form,"role",t.data.roleList[0].role_id),e.$set(e.baseForm,"role",t.data.roleList[0].role_id))}):this.$api.getTempStaffDetail({}).then(function(t){t.data.staffDetail&&(e.form=t.data.staffDetail,null!=t.data.roleList&&1==t.data.roleList.length&&e.$set(e.form,"role",t.data.roleList[0].role_id))}),this.getRoleList(),this.check||this.getApprovalQY(),this.check&&"0"===this.req_place&&this.getApprovalHisLogList(this.id)},watch:{visible:function(e){e||(this.form={})}},methods:{getApprovalHisLogList:function(e){var t=this;this.$api.getApprovalHisLogList({req_type:"2",id:e}).then(function(e){t.approvalHisLogList=e.data})},showHisDetail:function(e){var t=this;this.approvalHisList=[],this.$api.getApprovalHisList({apply_id:e}).then(function(e){t.his_visible=!0,t.approvalHisList=e.data})},handleHisClose:function(){this.his_visible=!1},open:function(){var e=this;this.$prompt("","申请说明",{confirmButtonText:"确定",cancelButtonText:"取消",inputType:"textarea",inputPattern:/^(.|\n){1,300}$/,inputErrorMessage:"申请说明不能为空且不能超过300字",inputPlaceholder:"输入内容不能超过300字"}).then(function(t){var a=t.value;e.form.suggestion=a,e.onSubmit()}).catch(function(){e.$message({type:"info",message:"取消提交"})})},getThanData:function(e){var t=this;this.parms.query_date=e.name;var a=this.parms,r=this.parms.query_item;"amt1"===r||"amt2"===r||"amt3"===r||"amt4"===r?this.$api.getReport001List(a).then(function(e){t.tooltip='<div style="padding: 0 10px">\n                                        <h5><span>时点值:</span><span>'+e.data[r]+"</span></h5>\n                                        <h5><span>比上日:</span><span>"+e.data.than_last_day+"</span></h5>\n                                        <h5><span>比上月:</span><span>"+e.data.than_last_month+"</span></h5>\n                                        <h5><span>比年初:</span><span>"+e.data.than_last_year+"</span></h5>\n                                      </div>\n                                      "}):"cus_num1"===r||"cus_num2"===r||"cus_num3"===r||"cus_num4"===r?this.$api.getReport002List(a).then(function(e){t.tooltip='<div style="padding: 0 10px">\n                                        <h5><span>时点值:</span><span>'+e.data[r]+"</span></h5>\n                                        <h5><span>比上日:</span><span>"+e.data.than_last_day+"</span></h5>\n                                        <h5><span>比上月:</span><span>"+e.data.than_last_month+"</span></h5>\n                                        <h5><span>比年初:</span><span>"+e.data.than_last_year+"</span></h5>\n                                      </div>\n                                      "}):"site_num1"!==r&&"site_num2"!==r&&"site_num3"!==r&&"site_num4"!==r||this.$api.getReport003List(a).then(function(e){t.tooltip='<div style="padding: 0 10px">\n                                        <h5><span>时点值:</span><span>'+e.data[r]+"</span></h5>\n                                        <h5><span>比上日:</span><span>"+e.data.than_last_day+"</span></h5>\n                                        <h5><span>比上月:</span><span>"+e.data.than_last_month+"</span></h5>\n                                        <h5><span>比年初:</span><span>"+e.data.than_last_year+"</span></h5>\n                                      </div>\n                                      "})},childSearch:function(e){this.parms.query_date=e.query_date,this.getData(this.parms)},getData:function(e){var t=this;this.parms=e,this.$api.getReport004List(e).then(function(e){t.option.xAxis.data=e.data.dateList,t.option.series[0].data=e.data.dataList})},checkAccountId:function(){var e=this;this.$api.checkStaffDetail({user_id:this.form.mgr_id}).then(function(t){e.form.mgr_name=t.data.name}),this.$set(this.form,"mgr_name",this.form.mgr_name)},getRoleList:function(){var e=this;this.$api.getStaffRoleList().then(function(t){e.roleList=t.data,1==t.data.length&&(e.$set(e.form,"role",t.data[0].role_id),e.$set(e.baseForm,"role",t.data[0].role_id))})},nodeselectForShow:function(e){this.$set(this.form,"branch_name",e.branch_name),this.$set(this.form,"branch_id",e.branch_id)},getApprovalAccountList:function(){var e=this;this.$api.getApprovalAccountList(i()({approval_type:this.$route.query.approval_type||this.type002},this.form)).then(function(t){e.accountList=t.data.dataList})},getApprovalQY:function(){var e=this;this.$api.getApprovalQY({approval_type:this.$route.query.approval_type||this.type002}).then(function(t){e.use_up=t.data.use_up})},tempSubmit:function(){var e=this;if(this.check)return void this.$router.back(-1);this.$set(this.form,"roleids",[this.form.role]),this.$api.checkStaffDetail({user_id:this.form.mgr_id}).then(function(t){e.$api.tempaddStaff(e.form).then(function(t){e.$message.success("暂存成功")})})},onSubmit:function(){var e=this;if(this.check)return void this.$router.back(-1);this.$set(this.form,"roleids",[this.form.role]),this.$refs.form.validate(function(t){if(t){e.form.approval_type=e.$route.query.approval_type||e.type002,e.form.req_place=e.req_place,e.form.apply_id=e.$route.query.apply_id||"",e.form.use_up=e.use_up;var a=[];for(var r in e.baseForm)e.baseForm[r]!=e.form[r]&&a.push(e.labelList[r]);a.length>0&&(e.form.update_items=a.join(",")),e.form.approval_type==e.type002?e.$api.checkStaffDetail({user_id:e.form.mgr_id}).then(function(t){e.$api.addStaff(e.form).then(function(t){e.handleClose(),e.$message.success("操作成功，你已跳转至我的申请页面"),e.$router.push({path:"/approvalApply",name:"我的申请"})})}):e.$api.addStaff(e.form).then(function(t){e.handleClose(),e.$message.success("操作成功，你已跳转至我的申请页面"),e.$router.push({path:"/approvalApply",name:"我的申请"})})}})},handleClose:function(){this.visible=!1,this.form={}}},beforeRouteLeave:function(e,t,a){e.params.searchKey=this.$route.params.searchKey,a()}}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-row",{attrs:{gutter:50}},[a("el-col",{attrs:{span:12}},[a("el-divider",{attrs:{direction:"horizontal","content-position":"left"}},[e._v("\n        个人基本信息\n      ")]),e._v(" "),a("el-form",{ref:"form",attrs:{"status-icon":"",rules:e.rules,model:e.form,"label-width":"120px"}},[a("el-form-item",{attrs:{label:"工号",prop:"mgr_id"}},[a("el-input",{attrs:{disabled:!!e.id},on:{change:function(t){return e.checkAccountId()}},model:{value:e.form.mgr_id,callback:function(t){e.$set(e.form,"mgr_id",t)},expression:"form.mgr_id"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"姓名",prop:"mgr_name"}},[a("el-input",{attrs:{disabled:!0},model:{value:e.form.mgr_name,callback:function(t){e.$set(e.form,"mgr_name",t)},expression:"form.mgr_name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"角色",prop:"role"}},[a("el-radio-group",{attrs:{disabled:e.check||e.approval_type!==e.type014&&e.approval_type!==e.type002},model:{value:e.form.role,callback:function(t){e.$set(e.form,"role",t)},expression:"form.role"}},e._l(e.roleList,function(t){return a("el-radio",{key:t.role_id,attrs:{label:t.role_id}},[e._v(e._s(t.role_name)+"\n            ")])}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"所属机构",prop:"branch_id"}},[a("div",{staticStyle:{display:"flex"}},[a("el-input",{attrs:{disabled:!0},model:{value:this.form.branch_name,callback:function(t){e.$set(this.form,"branch_name",t)},expression:"\n                this.form.branch_name\n              "}}),e._v(" "),a("BranchTreePicker",{directives:[{name:"show",rawName:"v-show",value:!e.check&&(e.approval_type===e.type015||e.approval_type===e.type002),expression:"!check && (approval_type === type015 || approval_type === type002)"}],attrs:{dfks:this.form.branch_id,appendToBody:!0},on:{nodeselect:e.nodeselectForShow}})],1)]),e._v(" "),a("el-form-item",{attrs:{label:"性别",prop:"sex"}},[a("el-radio-group",{attrs:{disabled:e.check||e.approval_type!==e.type003&&e.approval_type!==e.type002},model:{value:e.form.sex,callback:function(t){e.$set(e.form,"sex",t)},expression:"form.sex"}},[a("el-radio",{attrs:{label:"0"}},[e._v("男\n            ")]),e._v(" "),a("el-radio",{attrs:{label:"1"}},[e._v("女\n            ")])],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"手机号",prop:"phone"}},[a("el-input",{attrs:{disabled:e.check||e.approval_type!==e.type003&&e.approval_type!==e.type002},model:{value:e.form.phone,callback:function(t){e.$set(e.form,"phone",t)},expression:"form.phone"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"电子邮箱",prop:"e_mail"}},[a("el-input",{attrs:{disabled:e.check||e.approval_type!==e.type003&&e.approval_type!==e.type002},model:{value:e.form.e_mail,callback:function(t){e.$set(e.form,"e_mail",t)},expression:"form.e_mail"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"年龄",prop:"age"}},[a("el-input",{attrs:{disabled:e.check||e.approval_type!==e.type003&&e.approval_type!==e.type002},model:{value:e.form.age,callback:function(t){e.$set(e.form,"age",t)},expression:"form.age"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"学历",prop:"education"}},[a("el-radio-group",{attrs:{disabled:e.check||e.approval_type!==e.type003&&e.approval_type!==e.type002},model:{value:e.form.education,callback:function(t){e.$set(e.form,"education",t)},expression:"form.education"}},[a("el-radio",{attrs:{label:"0"}},[e._v("初中及以下\n            ")]),e._v(" "),a("el-radio",{attrs:{label:"1"}},[e._v("高中（含中专等）\n            ")]),e._v(" "),a("el-radio",{attrs:{label:"2"}},[e._v("大专\n            ")]),e._v(" "),a("el-radio",{attrs:{label:"3"}},[e._v("本科\n            ")]),e._v(" "),a("el-radio",{attrs:{label:"4"}},[e._v("研究生及以上\n            ")])],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"入职日期",prop:"employment_date"}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date","value-format":"yyyy-MM-dd",placeholder:"选择日期",disabled:e.check||e.approval_type!==e.type003&&e.approval_type!==e.type002},model:{value:e.form.employment_date,callback:function(t){e.$set(e.form,"employment_date",t)},expression:"\n              form.employment_date\n            "}})],1),e._v(" "),a("el-form-item",{attrs:{label:"出生日期",prop:"birthday"}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date","value-format":"yyyy-MM-dd",placeholder:"选择日期",disabled:e.check||e.approval_type!==e.type003&&e.approval_type!==e.type002},model:{value:e.form.birthday,callback:function(t){e.$set(e.form,"birthday",t)},expression:"form.birthday"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"其他",prop:"remarks"}},[a("el-input",{attrs:{disabled:e.check||e.approval_type!==e.type003&&e.approval_type!==e.type002,type:"textarea",autosize:{minRows:2,maxRows:4},placeholder:"请输入内容"},model:{value:e.form.remarks,callback:function(t){e.$set(e.form,"remarks",t)},expression:"form.remarks"}})],1),e._v(" "),e.check||"1"!==this.use_up||"1"===e.req_place?e._e():a("el-form-item",{attrs:{label:"审批人",prop:"approval_user"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{disabled:e.check,clearable:"",filterable:""},nativeOn:{click:function(t){return e.getApprovalAccountList.apply(null,arguments)}},model:{value:e.form.approval_user,callback:function(t){e.$set(e.form,"approval_user",t)},expression:"\n              form.approval_user\n            "}},e._l(e.accountList,function(e){return a("el-option",{key:e.account_id,attrs:{label:e.approval_name,value:e.account_id}})}),1)],1),e._v(" "),a("el-form-item",[e.check||e.approval_type!==e.type002||"1"===e.req_place?e._e():a("el-button",{attrs:{id:"tempButton",type:"primary",size:"medium"},on:{click:e.tempSubmit}},[e._v(e._s("暂存")+"\n          ")]),e._v(" "),e.check?e._e():a("el-button",{attrs:{id:"editButton",type:"primary",size:"medium"},on:{click:e.open}},[e._v(e._s("提交")+"\n          ")])],1)],1)],1),e._v(" "),e.check&&"0"===e.req_place?a("el-col",{attrs:{span:12}},[a("el-divider",{attrs:{direction:"horizontal","content-position":"left"}},[e._v("\n        个人业绩数据\n      ")]),e._v(" "),e._l(e.depositList,function(t,r){return a("el-row",{key:t.key,staticClass:"table-item"},[a("el-col",{attrs:{span:8}},[e._v(e._s(t.label))]),e._v(" "),a("el-col",{attrs:{span:8}},[e._v(e._s(e.form[t.key]))]),e._v(" "),a("el-col",{attrs:{span:8}},[a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.showChart({mgr_id:e.form.mgr_id,query_item:t.key})}}},[e._v("查看视图\n          ")])],1)],1)})],2):e._e(),e._v(" "),e.check&&"0"===e.req_place?a("el-col",{attrs:{span:12}},[a("el-divider",{attrs:{direction:"horizontal","content-position":"left"}},[e._v("\n        个人客户数据\n      ")]),e._v(" "),e._l(e.teamCusList,function(t,r){return a("el-row",{key:t.key,staticClass:"table-item"},[a("el-col",{attrs:{span:8}},[e._v(e._s(t.label))]),e._v(" "),a("el-col",{attrs:{span:8}},[e._v(e._s(e.form[t.key]))]),e._v(" "),a("el-col",{attrs:{span:8}},[a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.showChart({mgr_id:e.form.mgr_id,query_item:t.key})}}},[e._v("查看视图\n          ")])],1)],1)})],2):e._e(),e._v(" "),e.check&&"0"===e.req_place?a("el-col",{attrs:{span:12}},[a("el-divider",{attrs:{direction:"horizontal","content-position":"left"}},[e._v("\n        个人拓展数据\n      ")]),e._v(" "),e._l(e.teamExpandList,function(t,r){return a("el-row",{key:t.key,staticClass:"table-item"},[a("el-col",{attrs:{span:8}},[e._v(e._s(t.label))]),e._v(" "),a("el-col",{attrs:{span:8}},[e._v(e._s(e.form[t.key]))]),e._v(" "),a("el-col",{attrs:{span:8}},[a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.showChart({mgr_id:e.form.mgr_id,query_item:t.key})}}},[e._v("查看视图\n          ")])],1)],1)})],2):e._e()],1),e._v(" "),a("show-chart",{ref:"chartShow",attrs:{option:e.option},on:{"get-data":e.childSearch}}),e._v(" "),e.check&&"0"===e.req_place?a("el-row",{attrs:{gutter:50}},[a("el-col",{attrs:{span:24}},[a("el-divider",{attrs:{direction:"horizontal","content-position":"center"}},[e._v("\n        审批记录\n      ")]),e._v(" "),a("base-table",{attrs:{list:e.hisLogList,data:e.approvalHisLogList}},[a("el-table-column",{attrs:{fixed:"right",label:"操作",align:"center",width:"240"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text"},nativeOn:{click:function(a){return e.showHisDetail(t.row.id)}}},[e._v("详情")])]}}],null,!1,261131152)})],1)],1)],1):e._e(),e._v(" "),a("el-dialog",{attrs:{title:"审批历史",visible:e.his_visible,width:"80%","before-close":e.handleHisClose},on:{"update:visible":function(t){e.his_visible=t}}},[a("base-table",{attrs:{list:e.hisList,data:e.approvalHisList}}),e._v(" "),a("div",{staticStyle:{"text-align":"center"},attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:e.handleHisClose}},[e._v("关 闭")])],1)],1)],1)},staticRenderFns:[]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(6),i=a.n(r),o=a(5),l=a.n(o),s=a(10),n=a.n(s),p=a(22),c=a.n(p),u=a(157);a.n(u);t.default={name:"staff",components:{baseTable:l.a,basePage:n.a,BranchTreePicker:c.a},data:function(){return{user:JSON.parse(sessionStorage.getItem("user")),role_id:sessionStorage.getItem("role_id"),role:sessionStorage.getItem("role"),form:{},bankid:"",bankname:"",dataList:[{label:"工号",prop:"mgr_id",sort:!0},{label:"姓名",prop:"mgr_name"},{label:"角色",prop:"role_name"},{label:"所属机构",prop:"branch_name"},{label:"资产余额（元）",prop:"amt1"},{label:"资产年日均（元）",prop:"amt2"},{label:"存款余额（元）",prop:"amt3"},{label:"存款年日均（元）",prop:"amt4"},{label:"试营业服务点数",prop:"site_num1"},{label:"开业服务点数",prop:"site_num2"},{label:"客户数",prop:"cus_num1"}],userList:[],pageNum:1,pageSize:10,total:0,flag:"",type003:this.$loacalData.code_GetEnums(this.$loacalData.listApprovalType,"003").code,type014:this.$loacalData.code_GetEnums(this.$loacalData.listApprovalType,"014").code,type015:this.$loacalData.code_GetEnums(this.$loacalData.listApprovalType,"015").code,type021:this.$loacalData.code_GetEnums(this.$loacalData.listApprovalType,"021").code,roleList:[],loading:!1}},computed:{bankList:{get:function(){return this.$store.state.bankList},set:function(e){this.$store.state.bankList=e}},isStaffDetail:function(){return"/staffDetail"==this.$route.path}},mounted:function(){this.getRoleList()},methods:{nodeselectForSerch:function(e){console.log(e),this.bankname=e.branch_name,this.bankid=e.branch_id},getRoleList:function(){var e=this;this.$api.getStaffRoleList().then(function(t){e.roleList=t.data})},exportStaffInfos:function(){var e=this;this.loading=!0,this.$api.exportStaffInfos(i()({bankid:this.bankid},this.form)).then(function(t){e.loading=!1;var a=t.data.fileName,r=t.data.filePath;if(null==a||null==r)return e.$message({message:"导出失败，系统异常",type:"error"}),!1;var i=document.createElement("form");document.body.appendChild(i),i.method="post",i.action="/hnm/txCtrl?txcode=mediaFile",i.enctype="multipart/form-data";var o=document.createElement("input"),l=document.createElement("input"),s=document.createElement("input"),n=document.createElement("input");o.setAttribute("name","filePath"),o.setAttribute("type","hidden"),o.setAttribute("value",r),l.setAttribute("name","fileName"),l.setAttribute("type","hidden"),l.setAttribute("value",a),s.setAttribute("name","isDownload"),s.setAttribute("type","hidden"),s.setAttribute("value","1"),n.setAttribute("name","isDelete"),n.setAttribute("type","hidden"),n.setAttribute("value","1"),i.appendChild(o),i.appendChild(l),i.appendChild(s),i.appendChild(n),i.submit(),e.$message({message:"导出成功",type:"success"})})},beforeEdit:function(e,t){"2"===e&&"0"===t||this.$message({message:"暂无可做操作",type:"warning"})},editStaff:function(e,t,a){this.$router.push({path:"/addStaffDetail",query:{id:e,role:this.role,check:t,approval_type:a},params:{searchKey:this.form}})},deleteStaff:function(e,t,a){this.$router.push({path:"/addStaffDetail",query:{id:e,role:this.role,check:t,approval_type:a},params:{searchKey:this.form}})},getStaffList:function(){var e=this;this.$api.getStaffList(i()({page:this.pageNum-1,number:this.pageSize,bankid:this.bankid},this.form)).then(function(t){e.userList=t.data.userList,e.total=t.data.total})},changeSize:function(e){this.pageNum=1,this.pageSize=e,this.getStaffList()},changePage:function(e){this.pageNum=e,this.getStaffList()}},beforeRouteEnter:function(e,t,a){a(function(t){e.params.searchKey&&(t.form=e.params.searchKey),t.getStaffList()})}}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-form",{attrs:{inline:!0,model:e.form}},[e.isStaffDetail?a("el-button",{attrs:{type:"warning",size:"small",loading:e.loading},on:{click:e.exportStaffInfos}},[e._v("导出全部查询数据")]):e._e(),e._v(" "),a("div",{staticStyle:{"margin-top":"15px"}},[a("el-form-item",{attrs:{label:"所属机构",prop:"bankid"}},[a("div",{staticStyle:{display:"flex"}},[a("el-input",{attrs:{readonly:"",size:"small"},model:{value:e.bankname,callback:function(t){e.bankname=t},expression:"bankname"}}),e._v(" "),a("BranchTreePicker",{on:{nodeselect:e.nodeselectForSerch}})],1)]),e._v(" "),a("el-form-item",{attrs:{label:"姓名"}},[a("el-input",{attrs:{clearable:"",placeholder:"请输入姓名",size:"small"},model:{value:e.form.mgr_name,callback:function(t){e.$set(e.form,"mgr_name",t)},expression:"form.mgr_name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"角色",prop:"role_id"}},[a("el-select",{attrs:{filterable:"",clearable:"",size:"small"},model:{value:e.form.role_id,callback:function(t){e.$set(e.form,"role_id",t)},expression:"form.role_id"}},e._l(e.roleList,function(e){return a("el-option",{key:e.role_id,attrs:{label:e.role_name,value:e.role_id}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"工号"}},[a("el-input",{attrs:{clearable:"",placeholder:"请输入工号",size:"small"},model:{value:e.form.mgr_id,callback:function(t){e.$set(e.form,"mgr_id",t)},expression:"form.mgr_id"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"手机号码"}},[a("el-input",{attrs:{clearable:"",placeholder:"请输入手机号码",size:"small"},model:{value:e.form.phone,callback:function(t){e.$set(e.form,"phone",t)},expression:"form.phone"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-search"},on:{click:e.getStaffList}},[e._v("搜索\n                ")])],1)],1)],1),e._v(" "),a("base-table",{attrs:{list:e.dataList,data:e.userList}},[a("el-table-column",{attrs:{fixed:"right",label:"操作",align:"center",width:"240"},scopedSlots:e._u([{key:"default",fn:function(t){return[[e.isStaffDetail?e._e():a("el-dropdown",{attrs:{placement:"bottom"}},[a("el-button",{attrs:{type:"text",icon:"el-icon-edit-outline"},on:{click:function(a){return e.beforeEdit(t.row.approval_status,t.row.staff_show)}}},[e._v("操作\n                        ")]),e._v(" "),e.isStaffDetail?e._e():a("i",{staticClass:"el-icon-arrow-down el-icon--right"}),e._v(" "),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},["2"==t.row.approval_status&&"0"==t.row.staff_show?a("el-dropdown-item",{nativeOn:{click:function(a){return e.editStaff(t.row.id,!1,e.type003)}}},[e._v("人员基本信息调整\n                            ")]):e._e(),e._v(" "),"2"==t.row.approval_status&&"0"==t.row.staff_show?a("el-dropdown-item",{nativeOn:{click:function(a){return e.editStaff(t.row.id,!1,e.type014)}}},[e._v("人员角色调整\n                            ")]):e._e(),e._v(" "),"2"==t.row.approval_status&&"0"==t.row.staff_show?a("el-dropdown-item",{nativeOn:{click:function(a){return e.editStaff(t.row.id,!1,e.type015)}}},[e._v("人员所属机构调整\n                            ")]):e._e(),e._v(" "),"2"==t.row.approval_status&&"0"==t.row.staff_show?a("el-dropdown-item",{nativeOn:{click:function(a){return e.deleteStaff(t.row.id,!1,e.type021)}}},[e._v("停用\n                            ")]):e._e()],1)],1)],e._v(" "),e.isStaffDetail?a("el-button",{attrs:{type:"text",icon:"el-icon-edit-outline"},on:{click:function(a){return e.editStaff(t.row.id,!0)}}},[e._v("查看\n                ")]):e._e()]}}])})],1),e._v(" "),a("base-page",{attrs:{page:e.pageNum,size:e.pageSize,total:e.total},on:{size:e.changeSize,page:e.changePage}})],1)},staticRenderFns:[]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(6),i=a.n(r),o=a(5),l=a.n(o),s=a(10),n=a.n(s),p=a(22),c=a.n(p),u=a(117),d=a.n(u),m=a(157);a.n(m);t.default={name:"site",components:{baseTable:l.a,basePage:n.a,BranchTreePicker:c.a,BranchTreePickerAll:d.a},data:function(){return{user:JSON.parse(sessionStorage.getItem("user")),role_id:sessionStorage.getItem("role_id"),role:sessionStorage.getItem("role"),form:{},bankid:"",bankname:"",orgid:"",orgname:"",dataList:[{label:"站点编号",prop:"site_no",sort:!0},{label:"站点名称",prop:"site_name"},{label:"所属机构",prop:"org_name"},{label:"落地支行",prop:"branch_name"},{label:"管辖客户经理",prop:"mgr_name"},{label:"服务点状态",prop:"status"},{label:"资产余额（元）",prop:"amt1"},{label:"资产年日均（元）",prop:"amt2"},{label:"存款余额（元）",prop:"amt3"},{label:"存款年日均（元）",prop:"amt4"},{label:"客户数",prop:"cus_num1"}],siteList:[],pageNum:1,pageSize:10,total:0,flag:"",type005:this.$loacalData.code_GetEnums(this.$loacalData.listApprovalType,"005").code,type006:this.$loacalData.code_GetEnums(this.$loacalData.listApprovalType,"006").code,type007:this.$loacalData.code_GetEnums(this.$loacalData.listApprovalType,"007").code,type008:this.$loacalData.code_GetEnums(this.$loacalData.listApprovalType,"008").code,type016:this.$loacalData.code_GetEnums(this.$loacalData.listApprovalType,"016").code,type017:this.$loacalData.code_GetEnums(this.$loacalData.listApprovalType,"017").code,type018:this.$loacalData.code_GetEnums(this.$loacalData.listApprovalType,"018").code,type019:this.$loacalData.code_GetEnums(this.$loacalData.listApprovalType,"019").code,type022:this.$loacalData.code_GetEnums(this.$loacalData.listApprovalType,"022").code,loading:!1}},computed:{bankList:{get:function(){return this.$store.state.bankList},set:function(e){this.$store.state.bankList=e}},isSiteDetail:function(){return"/siteDetail"===this.$route.path}},mounted:function(){},methods:{getqrcode:function(e,t){var a=this;this.$api.getqrcode({id:e,codeType:t}).then(function(e){var t=e.data.site_name,r=e.data.qrcode,i='<img style="width: 390px; height: 390px" src="'+r+'"/>';a.$alert(i,t,{dangerouslyUseHTMLString:!0,showClose:!1,confirmButtonText:"关闭"})})},nodeselectForSerchOrg:function(e){console.log(e),this.orgname=e.branch_name,this.orgid=e.branch_id},nodeselectForSerchBank:function(e){console.log(e),this.bankname=e.branch_name,this.bankid=e.branch_id},exportSiteInfos:function(){var e=this;this.loading=!0,this.$api.exportSiteInfos(i()({orgid:this.orgid,bankid:this.bankid},this.form)).then(function(t){e.loading=!1;var a=t.data.fileName,r=t.data.filePath;if(null==a||null==r)return e.$message({message:"导出失败，系统异常",type:"error"}),!1;var i=document.createElement("form");document.body.appendChild(i),i.method="post",i.action="/hnm/txCtrl?txcode=mediaFile",i.enctype="multipart/form-data";var o=document.createElement("input"),l=document.createElement("input"),s=document.createElement("input"),n=document.createElement("input");o.setAttribute("name","filePath"),o.setAttribute("type","hidden"),o.setAttribute("value",r),l.setAttribute("name","fileName"),l.setAttribute("type","hidden"),l.setAttribute("value",a),s.setAttribute("name","isDownload"),s.setAttribute("type","hidden"),s.setAttribute("value","1"),n.setAttribute("name","isDelete"),n.setAttribute("type","hidden"),n.setAttribute("value","1"),i.appendChild(o),i.appendChild(l),i.appendChild(s),i.appendChild(n),i.submit(),e.$message({message:"导出成功",type:"success"})})},beforeUpdate:function(e,t,a){"已退出"!==e&&"2"===t&&"0"===a||this.$message({message:"暂无可做操作",type:"warning"})},beforeEdit:function(e,t){"2"===e&&"0"===t||this.$message({message:"暂无可做操作",type:"warning"})},editSite:function(e,t,a){this.$router.push({path:"/addSiteDetail",query:{id:e,role:this.role,check:t,approval_type:a},params:{searchKey:this.form}})},toPos:function(e,t,a){this.$router.push({path:"/addSiteDetail",query:{id:e,role:this.role,check:t,approval_type:a},params:{searchKey:this.form}})},toOpen:function(e,t,a){this.$router.push({path:"/addSiteDetail",query:{id:e,role:this.role,check:t,approval_type:a},params:{searchKey:this.form}})},toQuit:function(e,t,a){this.$router.push({path:"/addSiteDetail",query:{id:e,role:this.role,check:t,approval_type:a},params:{searchKey:this.form}})},getSiteList:function(){var e=this;this.$api.getSiteList(i()({page:this.pageNum-1,number:this.pageSize,orgid:this.orgid,bankid:this.bankid},this.form)).then(function(t){t.data.siteList.map(function(e){return e.site_source="0"===e.site_source?"自拓":e.site_source="1"===e.site_source?"转介绍":"其他",e.status="0"===e.status?"试营业":e.status="1"===e.status?"试营业（已申请pos）":"2"===e.status?"已开业":"已退出"}),e.siteList=t.data.siteList,e.total=t.data.total})},changeSize:function(e){this.pageNum=1,this.pageSize=e,this.getSiteList()},changePage:function(e){this.pageNum=e,this.getSiteList()}},beforeRouteEnter:function(e,t,a){a(function(t){e.params.searchKey&&(t.form=e.params.searchKey),t.getSiteList()})}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={name:"basePage",props:{dfk:{type:String,default:""},appendToBody:!1},data:function(){return{dialogVisible:!1,showlist:[],defaultProps:{children:"children",label:"branch_name"},dfks:[]}},methods:{nodec:function(e){console.log(e),this.$emit("nodeselect",e),this.dialogVisible=!1},geBankList:function(){var e=this;if(this.showlist.length>0)return void(this.dialogVisible=!0);this.$api.getBranchAllOrg({}).then(function(t){e.dealwithBranch(t.data),e.dialogVisible=!0})},dealwithBranch:function(e){var t=e.filter(function(e){return null==e.porgid})[0];t.children=this.findchildren(e,t),this.showlist=[t],this.dfks=[this.dfk]},findchildren:function(e,t){for(var a=[],r=0;r<e.length;r++)if(e[r].porgid==t.branch_id){var i=this.findchildren(e,e[r]);i.length>0&&(e[r].children=i),a.push(e[r])}return a}}}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{"margin-left":"1px"}},[a("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){return e.geBankList()}}},[e._v("选择")]),e._v(" "),a("el-dialog",{attrs:{title:"机构选择",visible:e.dialogVisible,"append-to-body":e.appendToBody},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-tree",{attrs:{data:e.showlist,"node-key":"branch_id",props:e.defaultProps,"default-expanded-keys":e.dfks},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.node,i=t.data;return a("span",{staticClass:"custom-tree-node"},[a("span",[e._v(e._s(r.label))]),e._v(" "),a("span",[a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(){return e.nodec(i)}}},[e._v("\n\t\t\t            选择\n\t\t\t          ")])],1)])}}])})],1)],1)},staticRenderFns:[]}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-form",{attrs:{inline:!0,model:e.form}},[e.isSiteDetail?a("el-button",{attrs:{type:"warning",size:"small",loading:e.loading},on:{click:e.exportSiteInfos}},[e._v("导出全部查询数据")]):e._e(),e._v(" "),a("div",{staticStyle:{"margin-top":"15px"}},[a("el-form-item",{attrs:{label:"新建日期",prop:"start_date"}},[a("el-date-picker",{staticStyle:{width:"200px"},attrs:{type:"date","value-format":"yyyy-MM-dd",clearable:"",placeholder:"选择日期"},model:{value:e.form.start_date,callback:function(t){e.$set(e.form,"start_date",t)},expression:"form.start_date"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"——",prop:"end_date"}},[a("el-date-picker",{staticStyle:{width:"200px"},attrs:{type:"date","value-format":"yyyy-MM-dd",clearable:"",placeholder:"选择日期"},model:{value:e.form.end_date,callback:function(t){e.$set(e.form,"end_date",t)},expression:"form.end_date"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"所属机构",prop:"orgid"}},[a("div",{staticStyle:{display:"flex"}},[a("el-input",{attrs:{readonly:"",size:"small"},model:{value:e.orgname,callback:function(t){e.orgname=t},expression:"orgname"}}),e._v(" "),a("BranchTreePicker",{on:{nodeselect:e.nodeselectForSerchOrg}})],1)]),e._v(" "),a("el-form-item",{attrs:{label:"落地支行",prop:"bankid"}},[a("div",{staticStyle:{display:"flex"}},[a("el-input",{attrs:{readonly:"",size:"small"},model:{value:e.bankname,callback:function(t){e.bankname=t},expression:"bankname"}}),e._v(" "),a("BranchTreePickerAll",{on:{nodeselect:e.nodeselectForSerchBank}})],1)]),e._v(" "),a("el-form-item",{attrs:{label:"站点编号"}},[a("el-input",{attrs:{clearable:"",placeholder:"请输入站点编号",size:"small"},model:{value:e.form.site_no,callback:function(t){e.$set(e.form,"site_no",t)},expression:"form.site_no"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"站点名称"}},[a("el-input",{attrs:{clearable:"",placeholder:"请输入站点名称",size:"small"},model:{value:e.form.site_name,callback:function(t){e.$set(e.form,"site_name",t)},expression:"form.site_name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"站点状态",prop:"status"}},[a("el-select",{attrs:{clearable:"",size:"small"},model:{value:e.form.status,callback:function(t){e.$set(e.form,"status",t)},expression:"form.status"}},[a("el-option",{key:"0",attrs:{label:"试营业",value:"0"}}),e._v(" "),a("el-option",{key:"1",attrs:{label:"试营业（已申请pos）",value:"1"}}),e._v(" "),a("el-option",{key:"2",attrs:{label:"已开业",value:"2"}}),e._v(" "),a("el-option",{key:"3",attrs:{label:"已退出",value:"3"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"客户经理编号"}},[a("el-input",{attrs:{clearable:"",placeholder:"请输入客户经理编号",size:"small"},model:{value:e.form.mgr_id,callback:function(t){e.$set(e.form,"mgr_id",t)},expression:"form.mgr_id"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"站长姓名"}},[a("el-input",{attrs:{clearable:"",placeholder:"请输入站长姓名",size:"small"},model:{value:e.form.master_name,callback:function(t){e.$set(e.form,"master_name",t)},expression:"form.master_name"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-search"},on:{click:e.getSiteList}},[e._v("搜索\n                ")])],1)],1)],1),e._v(" "),a("base-table",{attrs:{list:e.dataList,data:e.siteList}},[a("el-table-column",{attrs:{fixed:"right",label:"操作",align:"center",width:"240"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.isSiteDetail?e._e():a("el-dropdown",{attrs:{placement:"bottom"}},[a("span",{staticClass:"el-dropdown-link",staticStyle:{color:"#e6a23c","margin-left":"10px"},on:{click:function(a){return e.beforeUpdate(t.row.status,t.row.approval_status,t.row.site_show)}}},[e._v("\n           状态调整"),a("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),e._v(" "),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},["试营业"==t.row.status&&"2"==t.row.approval_status&&"0"==t.row.site_show?a("el-dropdown-item",{nativeOn:{click:function(a){return e.toPos(t.row.id,!1,e.type006)}}},[e._v("pos申请\n                        ")]):e._e(),e._v(" "),"试营业"!=t.row.status&&"试营业（已申请pos）"!=t.row.status||"2"!=t.row.approval_status||"0"!=t.row.site_show?e._e():a("el-dropdown-item",{nativeOn:{click:function(a){return e.toOpen(t.row.id,!1,e.type007)}}},[e._v("pos和开业申请\n                        ")]),e._v(" "),"已开业"==t.row.status&&"2"==t.row.approval_status&&"0"==t.row.site_show?a("el-dropdown-item",{nativeOn:{click:function(a){return e.toOpen(t.row.id,!1,e.type022)}}},[e._v("转试营业申请\n                        ")]):e._e(),e._v(" "),"已退出"!=t.row.status&&"2"==t.row.approval_status&&"0"==t.row.site_show?a("el-dropdown-item",{nativeOn:{click:function(a){return e.toQuit(t.row.id,!1,e.type008)}}},[e._v("退出申请\n                        ")]):e._e()],1)],1),e._v(" "),e.isSiteDetail?[a("el-button",{attrs:{type:"text"},nativeOn:{click:function(a){return e.editSite(t.row.id,!0)}}},[e._v("查看")])]:a("el-dropdown",{attrs:{placement:"bottom"}},[a("span",{staticClass:"el-dropdown-link",staticStyle:{color:"#e6a23c","margin-left":"10px"},on:{click:function(a){return e.beforeEdit(t.row.approval_status,t.row.site_show)}}},[e._v("\n           信息调整"),a("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),e._v(" "),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},["2"==t.row.approval_status&&"0"==t.row.site_show?a("el-dropdown-item",{nativeOn:{click:function(a){return e.editSite(t.row.id,!1,e.type005)}}},[e._v("站点基本信息调整\n                        ")]):e._e(),e._v(" "),"2"==t.row.approval_status&&"0"==t.row.site_show?a("el-dropdown-item",{nativeOn:{click:function(a){return e.editSite(t.row.id,!1,e.type016)}}},[e._v("站点站长信息调整\n                        ")]):e._e(),e._v(" "),"2"==t.row.approval_status&&"0"==t.row.site_show?a("el-dropdown-item",{nativeOn:{click:function(a){return e.editSite(t.row.id,!1,e.type017)}}},[e._v("站点POS信息调整\n                        ")]):e._e(),e._v(" "),"2"==t.row.approval_status&&"0"==t.row.site_show?a("el-dropdown-item",{nativeOn:{click:function(a){return e.editSite(t.row.id,!1,e.type018)}}},[e._v("站点管辖客户经理调整\n                        ")]):e._e(),e._v(" "),"2"==t.row.approval_status&&"0"==t.row.site_show?a("el-dropdown-item",{nativeOn:{click:function(a){return e.editSite(t.row.id,!1,e.type019)}}},[e._v("站点落地支行调整\n                        ")]):e._e()],1)],1)]}}])})],1),e._v(" "),a("base-page",{attrs:{page:e.pageNum,size:e.pageSize,total:e.total},on:{size:e.changeSize,page:e.changePage}})],1)},staticRenderFns:[]}},function(e,t){},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(6),i=a.n(r),o=a(772),l=a.n(o),s=a(226),n=a.n(s),p=a(33),c=a.n(p),u=a(787),d=(a.n(u),a(159)),m=a(788),f=a(117),_=a.n(f),h=a(160),v=a.n(h),b=a(5),g=a.n(b);t.default={components:{BranchTreePickerAll:_.a,showChart:v.a,baseTable:g.a},name:"addSite",mixins:[d.a,m.a],data:function(){return{showDelete:!1,options:u.regionData,isload:!1,form:{suggestion:"",p_site_adr_arry:[],p_master_adr_arry:[]},dialogVisible:!1,cityProps:{value:"label"},check:!1,accountList:[],dialogImageUrl:"",disabled:!1,type004:this.$loacalData.code_GetEnums(this.$loacalData.listApprovalType,"004").code,type005:this.$loacalData.code_GetEnums(this.$loacalData.listApprovalType,"005").code,type006:this.$loacalData.code_GetEnums(this.$loacalData.listApprovalType,"006").code,type007:this.$loacalData.code_GetEnums(this.$loacalData.listApprovalType,"007").code,type008:this.$loacalData.code_GetEnums(this.$loacalData.listApprovalType,"008").code,type016:this.$loacalData.code_GetEnums(this.$loacalData.listApprovalType,"016").code,type017:this.$loacalData.code_GetEnums(this.$loacalData.listApprovalType,"017").code,type018:this.$loacalData.code_GetEnums(this.$loacalData.listApprovalType,"018").code,type019:this.$loacalData.code_GetEnums(this.$loacalData.listApprovalType,"019").code,type022:this.$loacalData.code_GetEnums(this.$loacalData.listApprovalType,"022").code,approval_type:"",site_status:"",temFileId:"",busId:"",mgrList:[],showList:{},fileList:[{business:"site",code:"site01",name:"广东南粤银行银行卡助农取款业务申请表",file_type:0,file_url:""},{business:"site",code:"site02",name:"站长身份证正面",file_type:0,file_url:""},{business:"site",code:"site03",name:"站长身份证反面",file_type:0,file_url:""},{business:"site",code:"site04",name:"站长征信报告",file_type:0,file_url:""},{business:"site",code:"site05",name:"站长无犯罪证明",file_type:0,file_url:""},{business:"site",code:"site21",name:"站长学历证明",file_type:0,file_url:""},{business:"site",code:"site06",name:"其他材料",file_type:0,file_url:""}],fileList1:[{business:"site",code:"site07",name:"主卡正面照片",file_type:0,file_url:""},{business:"site",code:"site08",name:"普惠金融支付服务点受理银联卡业务协议书",file_type:1,file_url:""},{business:"site",code:"site09",name:"服务点工商营业执照",file_type:1,file_url:""}],fileList2:[{business:"site",code:"site10",name:"服务点装修照片",file_type:2,file_url:""},{business:"site",code:"site11",name:"其他资料",file_type:2,file_url:""}],fileList3:[{business:"site",code:"site12",name:"普惠金融支付服务点助农终端撤销申请表",file_type:3,file_url:""},{business:"site",code:"site13",name:"站长退出资料",file_type:3,file_url:""}],update_items:[],baseForm:{},baseFileList:[],use_up:"",req_place:"",parms:{},hisLogList:[{label:"申请日期",prop:"create_time",sort:!0},{label:"申请编号",prop:"id"},{label:"审批类型",prop:"approval_type_name"},{label:"审批状态",prop:"approval_status_name"}],approvalHisLogList:[],hisList:[{label:"时间",prop:"create_time",sort:!0},{label:"节点名称",prop:"role_name"},{label:"操作人员编号",prop:"approval_user"},{label:"操作人员姓名",prop:"name"},{label:"操作",prop:"approval_opinion"},{label:"处理意见",prop:"approval_desc"}],approvalHisList:[],his_visible:!1}},computed:{bankList:{get:function(){return this.$store.state.bankList},set:function(e){this.$store.state.bankList=e}},rules:function(){var e=function(e,t,a){if(void 0!==t&&""!=t&&null!=t||a(),!/^1[3456789]\d{9}$/.test(t))return a(new Error("手机号码非法"));a()},t=function(e,t,a){if(void 0!==t&&""!==t&&null!==t||a(),!/^[0-9]\d{0,31}$/.test(t))return a(new Error("服务点主卡卡号非法"));a()},a=function(e,t,a){if(void 0!==t&&""!=t&&null!=t||a(),!/^[1-9]\d{7}((0\d)|(1[0-2]))(([0|1|2]\d)|3[0-1])\d{3}$|^[1-9]\d{5}[1-9]\d{3}((0\d)|(1[0-2]))(([0|1|2]\d)|3[0-1])\d{3}([0-9]|X)$/.test(t))return a(new Error("身份证非法"));a()},r=function(e,t,a){if(void 0!==t&&""!=t&&null!=t||a(),!/^(0|([1-9][0-9]*)|(([0]\.\d{1,2}|[1-9][0-9]*\.\d{1,2})))$/.test(t))return a(new Error("数值非法"));a()};return{site_name:[{required:void 0==this.$route.query.approval_type||this.$route.query.approval_type==this.type004||this.$route.query.approval_type==this.type005,message:"请输入站点名称",trigger:"blur"}],mgr_id:[{required:void 0==this.$route.query.approval_type||this.$route.query.approval_type==this.type004||this.$route.query.approval_type==this.type018,message:"请选择管辖客户经理",trigger:"change"}],branch_id:[{required:void 0==this.$route.query.approval_type||this.$route.query.approval_type==this.type004||this.$route.query.approval_type==this.type019,message:"请选择落地支行",trigger:"change"}],site_source:[{required:void 0==this.$route.query.approval_type||this.$route.query.approval_type==this.type004||this.$route.query.approval_type==this.type004||this.$route.query.approval_type==this.type005,message:"请选择站点来源",trigger:"change"}],recommender:[{required:void 0==this.$route.query.approval_type||this.$route.query.approval_type==this.type004||this.$route.query.approval_type==this.type005,message:"请输入推荐人工号",trigger:"blur"}],contract_date:[{required:void 0==this.$route.query.approval_type||this.$route.query.approval_type==this.type004||this.$route.query.approval_type==this.type005,message:"请选择签约时间",trigger:"blur"}],open_date:[{required:void 0==this.$route.query.approval_type||this.$route.query.approval_type==this.type004||this.$route.query.approval_type==this.type005,message:"请选择预计开业时间",trigger:"blur"}],site_adr:[{required:void 0==this.$route.query.approval_type||this.$route.query.approval_type==this.type004||this.$route.query.approval_type==this.type005,message:"请输入站点地址",trigger:"blur"}],service_radius:[{required:void 0==this.$route.query.approval_type||this.$route.query.approval_type==this.type004||this.$route.query.approval_type==this.type005,message:"请选择服务半径",trigger:"change"}],card_open_bank:[{required:this.$route.query.approval_type==this.type006||this.$route.query.approval_type==this.type007||this.$route.query.approval_type==this.type017,message:"请输入主卡开户行",trigger:"blur"}],card_no:[{validator:t,trigger:"blur"}],card_account_name:[{required:this.$route.query.approval_type==this.type006||this.$route.query.approval_type==this.type007||this.$route.query.approval_type==this.type017,message:"请输入主卡账户名",trigger:"blur"}],virtual_employee:[{required:this.$route.query.approval_type==this.type006||this.$route.query.approval_type==this.type007||this.$route.query.approval_type==this.type017,message:"请输入虚拟柜员号",trigger:"blur"}],terminal_no:[{required:this.$route.query.approval_type==this.type006||this.$route.query.approval_type==this.type007||this.$route.query.approval_type==this.type017,message:"请输入终端编号",trigger:"blur"}],terminal_sn:[{required:this.$route.query.approval_type==this.type006||this.$route.query.approval_type==this.type007||this.$route.query.approval_type==this.type017,message:"请输入终端SN号",trigger:"blur"}],terminal_type:[{required:this.$route.query.approval_type==this.type006||this.$route.query.approval_type==this.type007||this.$route.query.approval_type==this.type017,message:"请选择终端型号",trigger:"change"}],master_name:[{required:void 0==this.$route.query.approval_type||this.$route.query.approval_type==this.type004||this.$route.query.approval_type==this.type016,message:"请输入站长姓名",trigger:"blur"}],master_identify_no:[{required:void 0==this.$route.query.approval_type||this.$route.query.approval_type==this.type004||this.$route.query.approval_type==this.type016,message:"请输入站长身份证号码",trigger:"blur"},{validator:a,trigger:"blur"}],master_tel:[{required:void 0==this.$route.query.approval_type||this.$route.query.approval_type==this.type004||this.$route.query.approval_type==this.type016,message:"请输入站长联系号码",trigger:"blur"},{validator:e,trigger:"blur"}],master_adr:[{required:void 0==this.$route.query.approval_type||this.$route.query.approval_type==this.type004||this.$route.query.approval_type==this.type016,message:"请输入站长居住地址",trigger:"blur"}],cooperate_date:[{required:void 0==this.$route.query.approval_type||this.$route.query.approval_type==this.type004||this.$route.query.approval_type==this.type016,message:"请选择合作起始日期",trigger:"blur"}],education:[{required:void 0==this.$route.query.approval_type||this.$route.query.approval_type==this.type004||this.$route.query.approval_type==this.type016,message:"请选择站长学历",trigger:"change"}],special_staff:[{required:void 0==this.$route.query.approval_type||this.$route.query.approval_type==this.type004||this.$route.query.approval_type==this.type016,message:"请选择站长是否特殊人员",trigger:"change"}],occupation:[{required:void 0==this.$route.query.approval_type||this.$route.query.approval_type==this.type004||this.$route.query.approval_type==this.type016,message:"请选择站长候选人信息情况",trigger:"change"}],credit_investigation:[{required:void 0==this.$route.query.approval_type||this.$route.query.approval_type==this.type004||this.$route.query.approval_type==this.type016,message:"请选择站长征信逾期情况",trigger:"change"}],over_due_term:[{required:void 0==this.$route.query.approval_type||this.$route.query.approval_type==this.type004||this.$route.query.approval_type==this.type016,message:"请选择站长近2年是否发生过90天及以上的逾期",trigger:"change"}],credit_bal:[{required:void 0==this.$route.query.approval_type||this.$route.query.approval_type==this.type004||this.$route.query.approval_type==this.type016,message:"请输入站长信用类、保证类贷款余额",trigger:"blur"},{validator:r,trigger:"blur"}],approval_user:[{required:!0,message:"请选择审批人",trigger:"change"}]}}},mounted:function(){var e=this;this.approval_type=this.$route.query.approval_type||this.type004,this.check="false"!==this.$route.query.check&&Boolean(this.$route.query.check),console.log(this.check),this.id=this.$route.query.id,this.req_place=this.$route.query.req_place||"0",this.id?(this.isload=!0,this.$api.getSite({id:this.id}).then(function(t){if(e.form=t.data.siteDetail,e.baseForm=JSON.parse(c()(t.data.siteDetail)),e.site_status=t.data.siteDetail.status,e.form.p_site_adr&&(e.form.p_site_adr_arry=e.form.p_site_adr.split("/")),e.form.p_master_adr&&(e.form.p_master_adr_arry=e.form.p_master_adr.split("/")),null!=t.data.fileList&&t.data.fileList.length>0){e.fileList=e.fileList.concat(t.data.fileList);for(var a=0;a<e.fileList.length;a++)e.fileList[a].id&&(e.fileList[a].file_id=e.fileList[a].id,e.fileList[a].filelastname=e.fileList[a].local_file_path.substring(e.fileList[a].local_file_path.lastIndexOf(".")+1)),"site01"===e.fileList[a].code&&(e.fileList[a].name="广东南粤银行银行卡助农取款业务申请表"),"site02"===e.fileList[a].code&&(e.fileList[a].name="站长身份证正面"),"site03"===e.fileList[a].code&&(e.fileList[a].name="站长身份证反面"),"site04"===e.fileList[a].code&&(e.fileList[a].name="站长征信报告"),"site05"===e.fileList[a].code&&(e.fileList[a].name="站长无犯罪证明"),"site06"===e.fileList[a].code&&(e.fileList[a].name="其他材料"),"site07"===e.fileList[a].code&&(e.fileList[a].name="主卡正面照片"),"site08"===e.fileList[a].code&&(e.fileList[a].name="普惠金融支付服务点受理银联卡业务协议书"),"site09"===e.fileList[a].code&&(e.fileList[a].name="服务点工商营业执照"),"site10"===e.fileList[a].code&&(e.fileList[a].name="服务点装修照片"),"site11"===e.fileList[a].code&&(e.fileList[a].name="其他资料"),"site12"===e.fileList[a].code&&(e.fileList[a].name="普惠金融支付服务点助农终端撤销申请表"),"site13"===e.fileList[a].code&&(e.fileList[a].name="站长退出资料"),"site21"===e.fileList[a].code&&(e.fileList[a].name="站长学历证明")}else"1"===e.site_status?e.fileList=e.fileList.concat(e.fileList1):"2"===e.site_status?e.approval_type!==e.type022&&(e.fileList=e.fileList.concat(e.fileList1).concat(e.fileList2)):"3"===e.site_status&&(e.fileList=e.fileList.concat(e.fileList3));e.approval_type===e.type006&&(e.fileList=e.fileList.concat(e.fileList1)),e.approval_type===e.type007&&(e.fileList=e.fileList.concat(e.fileList1).concat(e.fileList2)),e.approval_type===e.type008&&"0"!==e.site_status&&"3"!==e.site_status&&(e.fileList=e.fileList.concat(e.fileList3)),e.approval_type!==e.type005&&e.approval_type!==e.type016&&e.approval_type!==e.type017&&e.approval_type!==e.type018&&e.approval_type!==e.type019||"2"===e.site_status&&(e.fileList=e.fileList.concat(e.fileList2)),e.baseFileList=JSON.parse(c()(e.fileList)),e.handleShowList(),e.isload=!1}).catch(function(){e.isload=!1})):(this.isload=!0,this.$api.getTempSiteDetail({}).then(function(t){if(t.data.siteDetail&&(e.form=t.data.siteDetail,e.site_status=t.data.siteDetail.status,e.form.p_site_adr&&(e.form.p_site_adr_arry=e.form.p_site_adr.split("/")),e.form.p_master_adr&&(e.form.p_master_adr_arry=e.form.p_master_adr.split("/")),null!=t.data.fileList&&t.data.fileList.length>0)){e.fileList=e.fileList.concat(t.data.fileList);for(var a=0;a<e.fileList.length;a++)e.fileList[a].id&&(e.fileList[a].file_id=e.fileList[a].id,e.fileList[a].filelastname=e.fileList[a].local_file_path.substring(e.fileList[a].local_file_path.lastIndexOf(".")+1)),"site01"===e.fileList[a].code&&(e.fileList[a].name="广东南粤银行银行卡助农取款业务申请表"),"site02"===e.fileList[a].code&&(e.fileList[a].name="站长身份证正面"),"site03"===e.fileList[a].code&&(e.fileList[a].name="站长身份证反面"),"site04"===e.fileList[a].code&&(e.fileList[a].name="站长征信报告"),"site05"===e.fileList[a].code&&(e.fileList[a].name="站长无犯罪证明"),"site06"===e.fileList[a].code&&(e.fileList[a].name="其他材料"),"site07"===e.fileList[a].code&&(e.fileList[a].name="主卡正面照片"),"site08"===e.fileList[a].code&&(e.fileList[a].name="普惠金融支付服务点受理银联卡业务协议书"),"site09"===e.fileList[a].code&&(e.fileList[a].name="服务点工商营业执照"),"site10"===e.fileList[a].code&&(e.fileList[a].name="服务点装修照片"),"site11"===e.fileList[a].code&&(e.fileList[a].name="其他资料"),"site12"===e.fileList[a].code&&(e.fileList[a].name="普惠金融支付服务点助农终端撤销申请表"),"site13"===e.fileList[a].code&&(e.fileList[a].name="站长退出资料"),"site21"===e.fileList[a].code&&(e.fileList[a].name="站长学历证明")}e.handleShowList(),e.isload=!1}).catch(function(){e.isload=!1})),this.getMgrList(),this.check||this.getApprovalQY(),this.check&&"0"===this.req_place&&this.getApprovalHisLogList(this.id)},watch:{visible:function(e){e||(this.form={})}},methods:{getApprovalHisLogList:function(e){var t=this;this.$api.getApprovalHisLogList({req_type:"0",id:e}).then(function(e){t.approvalHisLogList=e.data})},showHisDetail:function(e){var t=this;this.approvalHisList=[],this.$api.getApprovalHisList({apply_id:e}).then(function(e){t.his_visible=!0,t.approvalHisList=e.data})},handleHisClose:function(){this.his_visible=!1},open:function(){var e=this;this.$prompt("","申请说明",{confirmButtonText:"确定",cancelButtonText:"取消",inputType:"textarea",inputPattern:/^(.|\n){1,300}$/,inputErrorMessage:"申请说明不能为空且不能超过300字",inputPlaceholder:"输入内容不能超过300字"}).then(function(t){var a=t.value;e.form.suggestion=a,e.onSubmit()}).catch(function(){e.$message({type:"info",message:"取消提交"})})},getThanData:function(e){var t=this;this.parms.query_date=e.name;var a=this.parms,r=this.parms.query_item;"amt1"===r||"amt2"===r||"amt3"===r||"amt4"===r?this.$api.getReport001List(a).then(function(e){t.tooltip='<div style="padding: 0 10px">\n                                        <h5><span>时点值:</span><span>'+e.data[r]+"</span></h5>\n                                        <h5><span>比上日:</span><span>"+e.data.than_last_day+"</span></h5>\n                                        <h5><span>比上月:</span><span>"+e.data.than_last_month+"</span></h5>\n                                        <h5><span>比年初:</span><span>"+e.data.than_last_year+"</span></h5>\n                                      </div>\n                                      "}):"cus_num1"!==r&&"cus_num2"!==r&&"cus_num3"!==r&&"cus_num4"!==r||this.$api.getReport002List(a).then(function(e){t.tooltip='<div style="padding: 0 10px">\n                                        <h5><span>时点值:</span><span>'+e.data[r]+"</span></h5>\n                                        <h5><span>比上日:</span><span>"+e.data.than_last_day+"</span></h5>\n                                        <h5><span>比上月:</span><span>"+e.data.than_last_month+"</span></h5>\n                                        <h5><span>比年初:</span><span>"+e.data.than_last_year+"</span></h5>\n                                      </div>\n                                      "})},childSearch:function(e){this.parms.query_date=e.query_date,this.getData(this.parms)},getData:function(e){var t=this;this.parms=e,this.$api.getReport004List(e).then(function(e){t.option.xAxis.data=e.data.dateList,t.option.series[0].data=e.data.dataList})},changeSource:function(){"1"!=this.form.site_source&&this.$set(this.form,"recommender",null)},beforeAvatarUpload:function(e){console.log(e)},compareFile:function(){var e=this,t=[];this.fileList.forEach(function(a){e.baseFileList.some(function(e){return e.file_id===a.file_id})||t.push(a)}),this.baseFileList.forEach(function(a){e.fileList.some(function(e){return e.file_id===a.file_id})||t.push(a)}),console.log(t),t=n()(new l.a(t.map(function(t){return e.showList[t.code].name}))),this.update_items=this.update_items.concat(t)},fileUploaded:function(e,t,a){var r=e.data[0];this.fileList[this.fileList.length]={code:e.data[0].code,file_url:e.data[0].file_url,file_id:e.data[0].id,filelastname:e.data[0].local_file_path.substring(e.data[0].local_file_path.lastIndexOf(".")+1)},r.file_url&&this.showList[r.code].fileList.push({code:e.data[0].code,file_url:e.data[0].file_url,file_id:e.data[0].id,filelastname:e.data[0].local_file_path.substring(e.data[0].local_file_path.lastIndexOf(".")+1)})},fileUploadedError:function(e,t,a){console.log(JSON.parse(e.message)),this.$message.error(JSON.parse(e.message).tips.message)},nodeselectForShow:function(e){console.log(e),this.$set(this.form,"branch_name",e.branch_name),this.$set(this.form,"branch_id",e.branch_id)},getMgrList:function(){var e=this;0==this.mgrList.length&&this.$api.geManagerList({}).then(function(t){e.mgrList=t.data,console.log(e.mgrList)})},getApprovalAccountList:function(){var e=this;this.$api.getApprovalAccountList(i()({approval_type:this.$route.query.approval_type||this.type004},this.form)).then(function(t){e.accountList=t.data.dataList})},getApprovalQY:function(){var e=this;this.$api.getApprovalQY({approval_type:this.$route.query.approval_type||this.type004}).then(function(t){e.use_up=t.data.use_up})},tempSubmit:function(){var e=this;if(this.check)return void this.$router.back(-1);void 0!=this.form.p_site_adr_arry&&null!=this.form.p_site_adr_arry&&(this.form.p_site_adr=this.form.p_site_adr_arry.join("/")),void 0!=this.form.p_master_adr_arry&&null!=this.form.p_master_adr_arry&&(this.form.p_master_adr=this.form.p_master_adr_arry.join("/")),this.form.fileIdList=[];for(var t=0;t<this.fileList.length;t++)void 0!==this.fileList[t].file_id&&null!==this.fileList[t].file_id&&this.form.fileIdList.push(this.fileList[t].file_id);this.$api.tempaddSite(this.form).then(function(t){e.$message.success("暂存成功")})},onSubmit:function(){var e=this;if(this.check)return void this.$router.back(-1);this.$refs.form.validate(function(t){if(t){if(e.form.approval_type=e.$route.query.approval_type||e.type004,e.form.req_place=e.req_place,e.form.apply_id=e.$route.query.apply_id||"",e.form.use_up=e.use_up,!(void 0!=e.form.p_site_adr_arry&&null!=e.form.p_site_adr_arry&&0!=e.form.p_site_adr_arry.length||e.form.approval_type!=e.type004&&e.form.approval_type!=e.type005))return void e.$message.error("请选择站点区域");if(!(void 0!=e.form.p_master_adr_arry&&null!=e.form.p_master_adr_arry&&0!=e.form.p_master_adr_arry.length||e.form.approval_type!=e.type004&&e.form.approval_type!=e.type016))return void e.$message.error("请选择站长居住区域");if(!(void 0!=e.form.card_no&&null!=e.form.card_no&&0!=e.form.card_no.length||e.form.approval_type!=e.type006&&e.form.approval_type!=e.type007))return void e.$message.error("请输入服务点主卡卡号");void 0!=e.form.p_site_adr_arry&&null!=e.form.p_site_adr_arry&&(e.form.p_site_adr=e.form.p_site_adr_arry.join("/")),void 0!=e.form.p_master_adr_arry&&null!=e.form.p_master_adr_arry&&(e.form.p_master_adr=e.form.p_master_adr_arry.join("/")),e.form.fileIdList=[];var a="",r=["site06","site11","site13"],i=e.form.education;"0"!=i&&"1"!=i||(r=["site06","site11","site13","site21"]);for(var o=0;o<e.fileList.length;o++)void 0!==e.fileList[o].file_id&&null!==e.fileList[o].file_id&&(r.push(e.fileList[o].code),e.form.fileIdList.push(e.fileList[o].file_id));if(e.fileList.forEach(function(e){var t=!1;r.forEach(function(a){a===e.code&&(t=!0)}),t||(a+=e.name+",")}),a.length>0)return void e.$message.error("请上传以下文件:"+a);for(var l in e.baseForm)e.baseForm[l]!=e.form[l]&&e.update_items.push(e.labelList[l]);e.compareFile(),e.update_items.length>0&&(e.form.update_items=e.update_items.join(",")),e.$api.addSite(e.form).then(function(t){e.handleClose(),e.$message.success("操作成功，你已跳转至我的申请页面"),e.$router.push({path:"/approvalApply",name:"我的申请"})})}})},handleClose:function(){this.dialogVisible=!1,this.visible=!1,this.form={}},handleRemove:function(e,t,a){var r=void 0;r=e.file_id?e.file_id:e.response.data[0].id,t.splice(a,1),this.fileList=this.fileList.filter(function(e){return e.file_id!==r})},handleShowList:function(){var e=this;console.log(this.fileList,444444),this.fileList.forEach(function(t){t.url=t.file_url,e.showList[t.code]?t.url&&e.showList[t.code].fileList.push(t):e.$set(e.showList,t.code,{name:t.name,code:t.code,file_type:t.file_type,business:t.business,fileList:t.url?[t]:[]})})}},beforeRouteLeave:function(e,t,a){e.params.searchKey=this.$route.params.searchKey,a()}}},,,,,,,,,,,,,,,,,function(e,t,a){"use strict";t.a={data:function(){return{teamCusList:[{label:"所有客户数",key:"cus_num1"},{label:"高净值客户数",key:"cus_num2"},{label:"价值客户数",key:"cus_num3"},{label:"有效客户数",key:"cus_num4"}],depositList:[{label:"资产余额",key:"amt1"},{label:"资产年日均",key:"amt2"},{label:"存款余额",key:"amt3"},{label:"存款年日均",key:"amt4"}]}},computed:{}}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-form",{ref:"form",attrs:{"status-icon":"",rules:e.rules,model:e.form,"label-width":"150px"}},[a("el-row",{attrs:{gutter:50}},[a("el-col",{attrs:{span:12}},[a("el-divider",{attrs:{direction:"horizontal","content-position":"left"}},[e._v("\n          站点基本信息\n        ")]),e._v(" "),e.form.id?a("el-form-item",{attrs:{label:"站点编号",prop:"site_no"}},[a("el-input",{attrs:{disabled:!0},model:{value:e.form.site_no,callback:function(t){e.$set(e.form,"site_no",t)},expression:"form.site_no"}})],1):e._e(),e._v(" "),a("el-form-item",{attrs:{label:"站点名称",prop:"site_name"}},[a("el-input",{attrs:{disabled:e.check||e.approval_type!==e.type005&&e.approval_type!==e.type004,placeholder:"参考模板:XX区/镇/街道XX村惠农服务点"},model:{value:e.form.site_name,callback:function(t){e.$set(e.form,"site_name",t)},expression:"form.site_name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"落地支行",prop:"branch_id"}},[a("div",{staticStyle:{display:"flex"}},[a("el-input",{attrs:{disabled:!0},model:{value:this.form.branch_name,callback:function(t){e.$set(this.form,"branch_name",t)},expression:"this.form.branch_name"}}),e._v(" "),a("BranchTreePickerAll",{directives:[{name:"show",rawName:"v-show",value:!e.check&&(e.approval_type===e.type019||e.approval_type===e.type004),expression:"!check && (approval_type === type019 || approval_type === type004)"}],attrs:{dfks:this.form.branch_id,appendToBody:!0},on:{nodeselect:e.nodeselectForShow}})],1)]),e._v(" "),a("el-form-item",{attrs:{label:"管辖客户经理",prop:"mgr_id"}},[a("el-select",{attrs:{disabled:e.check||e.approval_type!==e.type018&&e.approval_type!==e.type004,filterable:"",clearable:""},model:{value:e.form.mgr_id,callback:function(t){e.$set(e.form,"mgr_id",t)},expression:"form.mgr_id"}},e._l(e.mgrList,function(e){return a("el-option",{key:e.account_id,attrs:{label:e.account_id+"-"+e.name,value:e.account_id}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"站点来源",prop:"site_source"}},[a("el-radio-group",{attrs:{disabled:e.check||e.approval_type!==e.type005&&e.approval_type!==e.type004},on:{change:e.changeSource},model:{value:e.form.site_source,callback:function(t){e.$set(e.form,"site_source",t)},expression:"form.site_source"}},[a("el-radio",{attrs:{label:"0"}},[e._v("自拓")]),e._v(" "),a("el-radio",{attrs:{label:"1"}},[e._v("转介绍")]),e._v(" "),a("el-radio",{attrs:{label:"2"}},[e._v("其他")])],1)],1),e._v(" "),"1"===this.form.site_source?a("el-form-item",{attrs:{label:"推荐人工号",prop:"recommender"}},[a("el-input",{attrs:{disabled:e.check||e.approval_type!==e.type005&&e.approval_type!==e.type004},model:{value:e.form.recommender,callback:function(t){e.$set(e.form,"recommender",t)},expression:"form.recommender"}})],1):e._e(),e._v(" "),a("el-form-item",{attrs:{label:"签约时间",prop:"contract_date"}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date","value-format":"yyyy-MM-dd",placeholder:"选择日期",disabled:e.check||e.approval_type!==e.type005&&e.approval_type!==e.type004},model:{value:e.form.contract_date,callback:function(t){e.$set(e.form,"contract_date",t)},expression:"form.contract_date"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"预计开业时间",prop:"open_date"}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date","value-format":"yyyy-MM-dd",placeholder:"选择日期",disabled:e.check||e.approval_type!==e.type005&&e.approval_type!==e.type004},model:{value:e.form.open_date,callback:function(t){e.$set(e.form,"open_date",t)},expression:"form.open_date"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"站点区域",prop:"p_site_adr"}},[a("el-cascader",{ref:"cascaderAddr",staticStyle:{width:"350px"},attrs:{size:"large",options:e.options,props:e.cityProps,disabled:e.check||e.approval_type!==e.type005&&e.approval_type!==e.type004,clearable:""},model:{value:e.form.p_site_adr_arry,callback:function(t){e.$set(e.form,"p_site_adr_arry",t)},expression:"form.p_site_adr_arry"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"站点地址",prop:"site_adr"}},[a("el-input",{attrs:{disabled:e.check||e.approval_type!==e.type005&&e.approval_type!==e.type004,placeholder:"参考模板:XX镇/XX街道XX村XX路XX号"},model:{value:e.form.site_adr,callback:function(t){e.$set(e.form,"site_adr",t)},expression:"form.site_adr"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"定位经度",prop:"lng"}},[a("el-input",{attrs:{disabled:e.check||e.approval_type!==e.type005&&e.approval_type!==e.type004},model:{value:e.form.lng,callback:function(t){e.$set(e.form,"lng",t)},expression:"form.lng"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"定位纬度",prop:"lat"}},[a("el-input",{attrs:{disabled:e.check||e.approval_type!==e.type005&&e.approval_type!==e.type004},model:{value:e.form.lat,callback:function(t){e.$set(e.form,"lat",t)},expression:"form.lat"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"服务半径",prop:"service_radius"}},[a("el-radio-group",{attrs:{disabled:e.check||e.approval_type!==e.type005&&e.approval_type!==e.type004},model:{value:e.form.service_radius,callback:function(t){e.$set(e.form,"service_radius",t)},expression:"form.service_radius"}},[a("el-radio",{attrs:{label:"0"}},[e._v("0-5公里")]),e._v(" "),a("el-radio",{attrs:{label:"1"}},[e._v("5-50公里")]),e._v(" "),a("el-radio",{attrs:{label:"2"}},[e._v("50公里以上")])],1)],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-divider",{attrs:{direction:"horizontal","content-position":"left"}},[e._v("\n          站点站长信息\n        ")]),e._v(" "),a("el-form-item",{attrs:{label:"站长姓名",prop:"master_name"}},[a("el-input",{attrs:{disabled:e.check||e.approval_type!==e.type016&&e.approval_type!==e.type004},model:{value:e.form.master_name,callback:function(t){e.$set(e.form,"master_name",t)},expression:"form.master_name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"站长身份证号码",prop:"master_identify_no"}},[a("el-input",{attrs:{disabled:e.check||e.approval_type!==e.type016&&e.approval_type!==e.type004},model:{value:e.form.master_identify_no,callback:function(t){e.$set(e.form,"master_identify_no",t)},expression:"form.master_identify_no"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"站长联系号码",prop:"master_tel"}},[a("el-input",{attrs:{disabled:e.check||e.approval_type!==e.type016&&e.approval_type!==e.type004},model:{value:e.form.master_tel,callback:function(t){e.$set(e.form,"master_tel",t)},expression:"form.master_tel"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"站长居住区域",prop:"p_master_adr"}},[a("el-cascader",{ref:"cascaderAddr",staticStyle:{width:"350px"},attrs:{size:"large",options:e.options,props:e.cityProps,disabled:e.check||e.approval_type!==e.type016&&e.approval_type!==e.type004,clearable:""},model:{value:e.form.p_master_adr_arry,callback:function(t){e.$set(e.form,"p_master_adr_arry",t)},expression:"form.p_master_adr_arry"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"站长居住地址",prop:"master_adr"}},[a("el-input",{attrs:{disabled:e.check||e.approval_type!==e.type016&&e.approval_type!==e.type004,placeholder:"参考模板:XX镇/XX街道XX村XX路XX号"},model:{value:e.form.master_adr,callback:function(t){e.$set(e.form,"master_adr",t)},expression:"form.master_adr"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"合作起始日期",prop:"cooperate_date"}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date","value-format":"yyyy-MM-dd",placeholder:"选择日期",disabled:e.check||e.approval_type!==e.type016&&e.approval_type!==e.type004},model:{value:e.form.cooperate_date,callback:function(t){e.$set(e.form,"cooperate_date",t)},expression:"form.cooperate_date"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"社会关系",prop:"relationship"}},[a("el-input",{attrs:{disabled:e.check||e.approval_type!==e.type016&&e.approval_type!==e.type004},model:{value:e.form.relationship,callback:function(t){e.$set(e.form,"relationship",t)},expression:"form.relationship"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"站长是否特殊人员",prop:"special_staff"}},[a("el-radio-group",{attrs:{disabled:e.check||e.approval_type!==e.type016&&e.approval_type!==e.type004},model:{value:e.form.special_staff,callback:function(t){e.$set(e.form,"special_staff",t)},expression:"form.special_staff"}},[a("el-radio",{attrs:{label:"0"}},[e._v("否")]),e._v(" "),a("el-radio",{attrs:{label:"1"}},[e._v("是")])],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"站长候选人信息情况",prop:"occupation"}},[a("el-radio-group",{attrs:{disabled:e.check||e.approval_type!==e.type016&&e.approval_type!==e.type004},model:{value:e.form.occupation,callback:function(t){e.$set(e.form,"occupation",t)},expression:"form.occupation"}},[a("el-radio",{attrs:{label:"0"}},[e._v("企业主或个体户")]),e._v(" "),a("el-radio",{attrs:{label:"1"}},[e._v("村委人员或家属")]),e._v(" "),a("el-radio",{attrs:{label:"2"}},[e._v("企事单位职员")]),e._v(" "),a("el-radio",{attrs:{label:"3"}},[e._v("打工返乡人员(现无业)")]),e._v(" "),a("el-radio",{attrs:{label:"4"}},[e._v("毕业返乡人员(现无业)")]),e._v(" "),a("el-radio",{attrs:{label:"5"}},[e._v("自由职业")]),e._v(" "),a("el-radio",{attrs:{label:"10"}},[e._v("其他"),a("input",{directives:[{name:"model",rawName:"v-model",value:e.form.occupation_explain,expression:"form.occupation_explain"}],staticClass:"el-input_noborder",attrs:{disabled:e.check||e.approval_type!==e.type016&&e.approval_type!==e.type004},domProps:{value:e.form.occupation_explain},on:{input:function(t){t.target.composing||e.$set(e.form,"occupation_explain",t.target.value)}}})])],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"学历",prop:"education"}},[a("el-radio-group",{attrs:{disabled:e.check||e.approval_type!==e.type016&&e.approval_type!==e.type004},model:{value:e.form.education,callback:function(t){e.$set(e.form,"education",t)},expression:"form.education"}},[a("el-radio",{attrs:{label:"0"}},[e._v("初中及以下")]),e._v(" "),a("el-radio",{attrs:{label:"1"}},[e._v("高中(含中专等)")]),e._v(" "),a("el-radio",{attrs:{label:"2"}},[e._v("大专")]),e._v(" "),a("el-radio",{attrs:{label:"3"}},[e._v("本科")]),e._v(" "),a("el-radio",{attrs:{label:"4"}},[e._v("研究生及以上")])],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"征信逾期情况",prop:"credit_investigation"}},[a("el-radio-group",{attrs:{disabled:e.check||e.approval_type!==e.type016&&e.approval_type!==e.type004},model:{value:e.form.credit_investigation,callback:function(t){e.$set(e.form,"credit_investigation",t)},expression:"form.credit_investigation"}},[a("el-radio",{attrs:{label:"0"}},[e._v("当期无逾期")]),e._v(" "),a("el-radio",{attrs:{label:"1"}},[e._v("当期有逾期")])],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"近2年是否发生过90天及以上的逾期",prop:"over_due_term"}},[a("el-radio-group",{attrs:{disabled:e.check||e.approval_type!==e.type016&&e.approval_type!==e.type004},model:{value:e.form.over_due_term,callback:function(t){e.$set(e.form,"over_due_term",t)},expression:"form.over_due_term"}},[a("el-radio",{attrs:{label:"0"}},[e._v("否")]),e._v(" "),a("el-radio",{attrs:{label:"1"}},[e._v("是")])],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"信用类、保证类贷款余额(元)",prop:"credit_bal"}},[a("el-input",{attrs:{disabled:e.check||e.approval_type!==e.type016&&e.approval_type!==e.type004},model:{value:e.form.credit_bal,callback:function(t){e.$set(e.form,"credit_bal",t)},expression:"form.credit_bal"}})],1)],1)],1),e._v(" "),a("el-row",{attrs:{gutter:50}},[a("el-col",{attrs:{span:12}},[a("el-divider",{attrs:{direction:"horizontal","content-position":"left"}},[e._v("\n          站点POS信息\n        ")]),e._v(" "),a("el-form-item",{attrs:{label:"服务点主卡卡号",prop:"card_no"}},[a("el-input",{attrs:{disabled:e.check||e.approval_type!==e.type017&&e.approval_type!==e.type004&&e.approval_type!==e.type006&&e.approval_type!==e.type007,onblur:"checkCarNo"},model:{value:e.form.card_no,callback:function(t){e.$set(e.form,"card_no",t)},expression:"form.card_no"}})],1),e._v(" "),this.approval_type===this.type006||this.approval_type===this.type007||"1"===this.site_status||"2"===this.site_status?a("el-form-item",{attrs:{label:"主卡开户行",prop:"card_open_bank"}},[a("el-input",{attrs:{disabled:e.check||e.approval_type!==e.type017&&e.approval_type!==e.type004&&e.approval_type!==e.type006&&e.approval_type!==e.type007},model:{value:e.form.card_open_bank,callback:function(t){e.$set(e.form,"card_open_bank",t)},expression:"form.card_open_bank"}})],1):e._e(),e._v(" "),this.approval_type===this.type006||this.approval_type===this.type007||"1"===this.site_status||"2"===this.site_status?a("el-form-item",{attrs:{label:"主卡账户名",prop:"card_account_name"}},[a("el-input",{attrs:{disabled:e.check||e.approval_type!==e.type017&&e.approval_type!==e.type004&&e.approval_type!==e.type006&&e.approval_type!==e.type007},model:{value:e.form.card_account_name,callback:function(t){e.$set(e.form,"card_account_name",t)},expression:"form.card_account_name"}})],1):e._e(),e._v(" "),this.approval_type===this.type006||this.approval_type===this.type007||"1"===this.site_status||"2"===this.site_status?a("el-form-item",{attrs:{label:"虚拟柜员号",prop:"virtual_employee"}},[a("el-input",{attrs:{disabled:e.check||e.approval_type!==e.type017&&e.approval_type!==e.type004&&e.approval_type!==e.type006&&e.approval_type!==e.type007},model:{value:e.form.virtual_employee,callback:function(t){e.$set(e.form,"virtual_employee",t)},expression:"form.virtual_employee"}})],1):e._e(),e._v(" "),this.approval_type===this.type006||this.approval_type===this.type007||"1"===this.site_status||"2"===this.site_status?a("el-form-item",{attrs:{label:"终端编号",prop:"terminal_no"}},[a("el-input",{attrs:{disabled:e.check||e.approval_type!==e.type017&&e.approval_type!==e.type004&&e.approval_type!==e.type006&&e.approval_type!==e.type007},model:{value:e.form.terminal_no,callback:function(t){e.$set(e.form,"terminal_no",t)},expression:"form.terminal_no"}})],1):e._e(),e._v(" "),this.approval_type===this.type006||this.approval_type===this.type007||"1"===this.site_status||"2"===this.site_status?a("el-form-item",{attrs:{label:"终端SN号",prop:"terminal_sn"}},[a("el-input",{attrs:{disabled:e.check||e.approval_type!==e.type017&&e.approval_type!==e.type004&&e.approval_type!==e.type006&&e.approval_type!==e.type007},model:{value:e.form.terminal_sn,callback:function(t){e.$set(e.form,"terminal_sn",t)},expression:"form.terminal_sn"}})],1):e._e(),e._v(" "),this.approval_type===this.type006||this.approval_type===this.type007||"1"===this.site_status||"2"===this.site_status?a("el-form-item",{attrs:{label:"终端型号",prop:"terminal_type"}},[a("el-select",{attrs:{clearable:"",disabled:e.check||e.approval_type!==e.type017&&e.approval_type!==e.type004&&e.approval_type!==e.type006&&e.approval_type!==e.type007},model:{value:e.form.terminal_type,callback:function(t){e.$set(e.form,"terminal_type",t)},expression:"form.terminal_type"}},[a("el-option",{key:"0",attrs:{label:"PAXE700-百富",value:"0"}}),e._v(" "),a("el-option",{key:"1",attrs:{label:"Q7S-实达",value:"1"}})],1)],1):e._e()],1)],1),e._v(" "),a("el-divider",{attrs:{direction:"horizontal","content-position":"left"}},[e._v("\n      站点文件信息\n    ")]),e._v(" "),e._l(e.showList,function(t,r){return a("el-form-item",{key:r,attrs:{label:t.name}},[a("div",{staticClass:"uploaditem",staticStyle:{width:"100%",overflow:"auto"}},[e._l(t.fileList,function(r,i){return a("div",{key:i,staticStyle:{position:"relative"},on:{mouseenter:function(t){e.showDelete=!0},mouseleave:function(t){e.showDelete=!1}}},[e.showDelete&&!e.check?a("div",{staticClass:"delete-logo",on:{click:function(a){return e.handleRemove(r,t.fileList,i)}}},[a("i",{staticClass:"el-icon-delete",attrs:{size:"24"}})]):e._e(),e._v(" "),"pdf"!==r.filelastname&&"doc"!==r.filelastname&&"docx"!==r.filelastname&&"xls"!==r.filelastname&&"xlsx"!==r.filelastname&&"txt"!==r.filelastname?a("el-image",{staticClass:"fileimg",attrs:{src:r.file_url,"preview-src-list":[r.file_url]}},[a("div",{staticClass:"imgtigger",attrs:{slot:"error"},slot:"error"},[e._v("没有图片")])]):e._e(),e._v(" "),"doc"===r.filelastname||"docx"===r.filelastname?a("a",{attrs:{target:"_blank",href:r.file_url}},[a("i",{staticClass:"fa fa-file-word-o",attrs:{"aria-hidden":"true"}})]):e._e(),e._v(" "),"xls"===r.filelastname||"xlsx"===r.filelastname?a("a",{attrs:{target:"_blank",href:r.file_url}},[a("i",{staticClass:"fa fa-file-excel-o",attrs:{"aria-hidden":"true"}})]):e._e(),e._v(" "),"pdf"===r.filelastname?a("a",{attrs:{target:"_blank",href:r.file_url}},[a("i",{staticClass:"fa fa-file-pdf-o",attrs:{"aria-hidden":"true"}})]):e._e(),e._v(" "),"txt"===r.filelastname?a("a",{attrs:{target:"_blank",href:r.file_url}},[a("i",{staticClass:"fa fa-file-o",attrs:{"aria-hidden":"true"}})]):e._e()],1)}),e._v(" "),a("el-upload",{ref:"upload",refInFor:!0,staticClass:"upload-demo",attrs:{name:t.code,action:"/hnm/txCtrl?txcode=upload001","show-file-list":!1,"list-type":"picture-card","file-list":t.fileList,"before-upload":e.beforeAvatarUpload,data:{name:t.name,code:t.code,file_type:t.file_type,business:t.business},"on-success":e.fileUploaded,"on-error":e.fileUploadedError,headers:{Accept:"application/json"},disabled:e.check}},[a("i",{directives:[{name:"show",rawName:"v-show",value:!e.check,expression:"!check"}],staticClass:"el-icon-plus",attrs:{slot:"default"},slot:"default"})])],2)])}),e._v(" "),e.check||"1"!==this.use_up||"1"===e.req_place?e._e():a("el-form-item",{attrs:{label:"审批人",prop:"approval_user"}},[a("el-select",{attrs:{disabled:e.check,clearable:"",filterable:""},nativeOn:{click:function(t){return e.getApprovalAccountList.apply(null,arguments)}},model:{value:e.form.approval_user,callback:function(t){e.$set(e.form,"approval_user",t)},expression:"form.approval_user"}},e._l(e.accountList,function(e){return a("el-option",{key:e.account_id,attrs:{label:e.approval_name,value:e.account_id}})}),1)],1),e._v(" "),a("el-form-item",[e.check||e.approval_type!==e.type004||"1"===e.req_place?e._e():a("el-button",{attrs:{id:"tempButton",type:"primary",size:"medium"},on:{click:e.tempSubmit}},[e._v(e._s("暂存")+"\n      ")]),e._v(" "),e.check?e._e():a("el-button",{attrs:{id:"editButton",type:"primary",size:"medium"},on:{click:e.open}},[e._v("\n        "+e._s("提交")+"\n      ")])],1)],2),e._v(" "),e.check&&"0"===e.req_place?a("el-row",{attrs:{gutter:50}},[a("el-col",{attrs:{span:12}},[a("el-divider",{attrs:{direction:"horizontal","content-position":"left"}},[e._v("\n        站点客户数据\n      ")]),e._v(" "),e._l(e.teamCusList,function(t,r){return a("el-row",{key:t.key,staticClass:"table-item"},[a("el-col",{attrs:{span:8}},[e._v(e._s(t.label))]),e._v(" "),a("el-col",{attrs:{span:8}},[e._v(e._s(e.form[t.key]))]),e._v(" "),a("el-col",{attrs:{span:8}},[a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.showChart({site_no:e.form.site_no,query_item:t.key})}}},[e._v("查看视图")])],1)],1)})],2),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-divider",{attrs:{direction:"horizontal","content-position":"left"}},[e._v("\n        站点业绩数据\n      ")]),e._v(" "),e._l(e.depositList,function(t,r){return a("el-row",{key:t.key,staticClass:"table-item"},[a("el-col",{attrs:{span:8}},[e._v(e._s(t.label))]),e._v(" "),a("el-col",{attrs:{span:8}},[e._v(e._s(e.form[t.key]))]),e._v(" "),a("el-col",{attrs:{span:8}},[a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.showChart({site_no:e.form.site_no,query_item:t.key})}}},[e._v("查看视图")])],1)],1)})],2)],1):e._e(),e._v(" "),a("show-chart",{ref:"chartShow",attrs:{option:e.option},on:{"get-data":e.childSearch}}),e._v(" "),e.check&&"0"===e.req_place?a("el-row",{attrs:{gutter:50}},[a("el-col",{attrs:{span:24}},[a("el-divider",{attrs:{direction:"horizontal","content-position":"center"}},[e._v("\n        审批记录\n      ")]),e._v(" "),a("base-table",{attrs:{list:e.hisLogList,data:e.approvalHisLogList}},[a("el-table-column",{attrs:{fixed:"right",label:"操作",align:"center",width:"240"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text"},nativeOn:{click:function(a){return e.showHisDetail(t.row.id)}}},[e._v("详情")])]}}],null,!1,261131152)})],1)],1)],1):e._e(),e._v(" "),a("el-dialog",{attrs:{title:"审批历史",visible:e.his_visible,width:"80%","before-close":e.handleHisClose},on:{"update:visible":function(t){e.his_visible=t}}},[a("base-table",{attrs:{list:e.hisList,data:e.approvalHisList}}),e._v(" "),a("div",{staticStyle:{"text-align":"center"},attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:e.handleHisClose}},[e._v("关 闭")])],1)],1)],1)},staticRenderFns:[]}},function(e,t,a){a(791);var r=a(3)(a(792),a(793),"data-v-6ff59d72",null);e.exports=r.exports},function(e,t){},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(6),i=a.n(r),o=a(22),l=a.n(o),s=a(117),n=a.n(s);t.default={name:"exportSiteInfos",components:{BranchTreePicker:l.a,BranchTreePickerAll:n.a},data:function(){return{form:{},orgid:"",bankid:"",orgname:"",bankname:""}},mounted:function(){},methods:{nodeselectForSerchOrg:function(e){console.log(e),this.orgname=e.branch_name,this.orgid=e.branch_id},nodeselectForSerchBank:function(e){console.log(e),this.bankname=e.branch_name,this.bankid=e.branch_id},exportSiteInfos:function(){var e=this;this.$api.exportSiteInfos(i()({orgid:this.orgid,bankid:this.bankid,source:1},this.form)).then(function(t){e.loading=!1;var a=t.data.fileName,r=t.data.filePath;if(null==a||null==r)return e.$message({message:"导出失败，系统异常",type:"error"}),!1;var i=document.createElement("form");document.body.appendChild(i),i.method="post",i.action="/hnm/txCtrl?txcode=mediaFile",i.enctype="multipart/form-data";var o=document.createElement("input"),l=document.createElement("input"),s=document.createElement("input"),n=document.createElement("input");o.setAttribute("name","filePath"),o.setAttribute("type","hidden"),o.setAttribute("value",r),l.setAttribute("name","fileName"),l.setAttribute("type","hidden"),l.setAttribute("value",a),s.setAttribute("name","isDownload"),s.setAttribute("type","hidden"),s.setAttribute("value","1"),n.setAttribute("name","isDelete"),n.setAttribute("type","hidden"),n.setAttribute("value","1"),i.appendChild(o),i.appendChild(l),i.appendChild(s),i.appendChild(n),i.submit(),e.$message({message:"导出成功",type:"success"})})}}}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{attrs:{inline:!0,model:e.form}},[a("el-button",{attrs:{type:"warning",size:"small"},on:{click:e.exportSiteInfos}},[e._v("导出全部查询数据")]),e._v(" "),a("div",{staticStyle:{"margin-top":"15px"}},[a("el-form-item",{attrs:{label:"新建日期",prop:"start_date"}},[a("el-date-picker",{staticStyle:{width:"200px"},attrs:{type:"date","value-format":"yyyy-MM-dd",clearable:"",placeholder:"选择日期"},model:{value:e.form.start_date,callback:function(t){e.$set(e.form,"start_date",t)},expression:"form.start_date"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"——",prop:"end_date"}},[a("el-date-picker",{staticStyle:{width:"200px"},attrs:{type:"date","value-format":"yyyy-MM-dd",clearable:"",placeholder:"选择日期"},model:{value:e.form.end_date,callback:function(t){e.$set(e.form,"end_date",t)},expression:"form.end_date"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"所属机构",prop:"orgid"}},[a("div",{staticStyle:{display:"flex"}},[a("el-input",{attrs:{readonly:"",size:"small"},model:{value:e.orgname,callback:function(t){e.orgname=t},expression:"orgname"}}),e._v(" "),a("BranchTreePicker",{on:{nodeselect:e.nodeselectForSerchOrg}})],1)]),e._v(" "),a("el-form-item",{attrs:{label:"落地支行",prop:"bankid"}},[a("div",{staticStyle:{display:"flex"}},[a("el-input",{attrs:{readonly:"",size:"small"},model:{value:e.bankname,callback:function(t){e.bankname=t},expression:"bankname"}}),e._v(" "),a("BranchTreePickerAll",{on:{nodeselect:e.nodeselectForSerchBank}})],1)]),e._v(" "),a("el-form-item",{attrs:{label:"站点编号"}},[a("el-input",{attrs:{clearable:"",placeholder:"请输入站点编号",size:"small"},model:{value:e.form.site_no,callback:function(t){e.$set(e.form,"site_no",t)},expression:"form.site_no"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"站点名称"}},[a("el-input",{attrs:{clearable:"",placeholder:"请输入站点名称",size:"small"},model:{value:e.form.site_name,callback:function(t){e.$set(e.form,"site_name",t)},expression:"form.site_name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"站点状态",prop:"status"}},[a("el-select",{attrs:{clearable:"",size:"small"},model:{value:e.form.status,callback:function(t){e.$set(e.form,"status",t)},expression:"form.status"}},[a("el-option",{key:"0",attrs:{label:"试营业",value:"0"}}),e._v(" "),a("el-option",{key:"1",attrs:{label:"试营业（已申请pos）",value:"1"}}),e._v(" "),a("el-option",{key:"2",attrs:{label:"已开业",value:"2"}}),e._v(" "),a("el-option",{key:"3",attrs:{label:"已退出",value:"3"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"客户经理编号"}},[a("el-input",{attrs:{clearable:"",placeholder:"请输入客户经理编号",size:"small"},model:{value:e.form.mgr_id,callback:function(t){e.$set(e.form,"mgr_id",t)},expression:"form.mgr_id"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"站长姓名"}},[a("el-input",{attrs:{clearable:"",placeholder:"请输入站长姓名",size:"small"},model:{value:e.form.master_name,callback:function(t){e.$set(e.form,"master_name",t)},expression:"form.master_name"}})],1)],1)],1)},staticRenderFns:[]}},function(e,t,a){var r=a(3)(a(795),a(799),null,null);e.exports=r.exports},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(6),i=a.n(r),o=a(5),l=a.n(o),s=a(10),n=a.n(s),p=a(796),c=a.n(p);t.default={components:{baseTable:l.a,basePage:n.a,approvalField:c.a},name:"approvalType",data:function(){return{role_id:sessionStorage.getItem("role_id"),props:{multiple:!0},form:{},dataList:[{label:"审批类型编号",prop:"approval_type",sort:!0},{label:"审批类型名称",prop:"approval_type_name",sort:!0},{label:"备注",prop:"remarks"},{label:"是否启用",prop:"use_up"}],rules:{approval_type:[{required:!0,message:"请输入审批类型编号",trigger:"blur"}],approval_type_name:[{required:!0,message:"请输入审批类型名称",trigger:"blur"}],use_up:[{required:!0,message:"请选择是否启用",trigger:"change"}]},approvalTypeList:[],pageNum:1,pageSize:10,total:0,visible:!1,items:[]}},mounted:function(){},watch:{visible:function(e){e||(this.form={})}},methods:{getApprovalField:function(e){var t=this;this.$api.getApprovalField({approval_type:e}).then(function(e){t.items=[];var a=e.data;if(null!=a&&a.length>0)for(var r=0;r<a.length;r++){var i={},o=[];i.value=a[r].approval_items,i.label=a[r].approval_name;for(var l=a[r].list,s=0;s<l.length;s++){var n={};n.value=l[s].approval_items,n.label=l[s].approval_name,o.push(n)}i.children=o,t.items.push(i)}})},addApprovalType:function(){var e=this;this.$refs.form.validate(function(t){if(t){if(!e.form.approval_type.match("[0-9]{3,3}"))return void e.$message.error("审批类型编号格式不正确；例：001");e.$api.checkApprovalType(e.form).then(function(t){e.form.id?e.$api.updateApprovalType(e.form).then(function(t){e.handleClose(),e.getApprovalTypeList()}):e.$api.addApprovalType(e.form).then(function(t){e.handleClose(),e.getApprovalTypeList()})}).catch(function(){})}}),this.items=[]},editApprovalType:function(e,t){var a=this;this.$api.getApprovalType({id:e}).then(function(e){console.log(e),a.visible=!0,a.form=e.data.msg[0],a.form.approval_items=e.data.approval_items}),this.getApprovalField(t)},getApprovalTypeList:function(){var e=this;this.$api.getApprovalTypeList(i()({page:this.pageNum-1,number:this.pageSize},this.form)).then(function(t){t.data.approvalTypeList.map(function(e){return e.use_up="0"==e.use_up?"否":"是"}),e.approvalTypeList=t.data.approvalTypeList,e.total=t.data.total})},changeSize:function(e){this.pageSize=e,this.getApprovalTypeList()},changePage:function(e){this.pageNum=e,this.getApprovalTypeList()},deleteApprovalType:function(e){var t=this;this.$confirm("确定删除该审批类型吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!0}).then(function(){t.$api.deleteApprovalType({id:e}).then(function(e){console.log(e),t.getApprovalTypeList()})}).catch(function(){})},handleClose:function(){this.visible=!1,this.form={},this.items=[]}},beforeRouteEnter:function(e,t,a){a(function(t){e.params.searchKey&&(t.form=e.params.searchKey),t.getApprovalTypeList()})}}},function(e,t,a){var r=a(3)(a(797),a(798),null,null);e.exports=r.exports},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(33),i=a.n(r),o=a(6),l=a.n(o);t.default={name:"approvalField",data:function(){return{rules:{approval_name:[{required:!0,message:"请输入审核项名称",trigger:"blur"}],approval_items:[{required:!0,message:"请输入审核项值",trigger:"blur"}],is_role:[{required:!0,message:"请选择是否为角色类",trigger:"blur"}]},form:{},data:[],disible:!1,dialogVisible:!1}},mounted:function(){},methods:{getApprovalTypeByEnum:function(){var e=this;this.data=[],this.$api.getApprovalTypeByEnum().then(function(t){t.data.map(function(t){var a=[],r={};r.label=t.approvalTypeName,r.value=t.approvalType,r.approval_type=t.approvalType,e.$api.getApprovalField({approval_type:t.approvalType}).then(function(e){var t=e.data;if(null!=t&&t.length>0)for(var r=0;r<t.length;r++){var i={},o=[];i.value=t[r].approval_items,i.id=t[r].id,i.label=t[r].approval_name,i.approval_type=t[r].approval_type;for(var l=t[r].list,s=0;s<l.length;s++){var n={};n.value=l[s].approval_items,n.label=l[s].approval_name,n.id=l[s].id,o.push(n)}i.children=o,a.push(i)}}),r.children=a,e.data.push(r)})})},addApprovalField:function(){var e=this;return null===this.form.children&&void 0===this.form.children||delete this.form.children,null===this.form.approval_name||void 0===this.form.approval_name?void this.$message.error("请输入审核项名称"):null===this.form.approval_items||void 0===this.form.approval_items?void this.$message.error("请输入审核项值"):null===this.form.is_role||void 0===this.form.is_role?void this.$message.error("请选择是否为角色类"):void this.$api.addApprovalField(l()({},this.form)).then(function(){e.$message.success("添加成功"),e.handleClose(),e.getApprovalTypeByEnum()})},handleClose:function(){this.disible=!1},append:function(e){this.disible=!0,this.form=JSON.parse(i()(e))},remove:function(e,t){var a=this;this.$api.addApprovalField({id:t.id,deleted:"1"}).then(function(){a.$message.success("删除成功"),a.getApprovalTypeByEnum()})},approvalField:function(){this.dialogVisible=!0,this.getApprovalTypeByEnum()}}}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{"margin-left":"1px"}},[a("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){return e.approvalField()}}},[e._v("免审批项目管理")]),e._v(" "),a("el-dialog",{attrs:{title:"免审批项目管理",visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-dialog",{attrs:{visible:e.disible,title:e.form.label},on:{"update:visible":function(t){e.disible=t}}},[a("el-form",{attrs:{model:e.form,rules:e.rules}},[a("el-form-item",{staticStyle:{width:"200px"},attrs:{label:"审核项名称",prop:"approval_name"}},[a("el-input",{model:{value:e.form.approval_name,callback:function(t){e.$set(e.form,"approval_name",t)},expression:"form.approval_name"}})],1),e._v(" "),a("el-form-item",{staticStyle:{width:"200px"},attrs:{label:"审核项值",prop:"approval_items"}},[a("el-input",{model:{value:e.form.approval_items,callback:function(t){e.$set(e.form,"approval_items",t)},expression:"form.approval_items"}})],1),e._v(" "),a("el-form-item",{staticStyle:{width:"300px"},attrs:{label:"是否为角色类",prop:"is_role"}},[a("el-radio",{attrs:{label:"0"},model:{value:e.form.is_role,callback:function(t){e.$set(e.form,"is_role",t)},expression:"form.is_role"}},[e._v("是")]),e._v(" "),a("el-radio",{attrs:{label:"1"},model:{value:e.form.is_role,callback:function(t){e.$set(e.form,"is_role",t)},expression:"form.is_role"}},[e._v("否")])],1)],1),e._v(" "),a("div",{staticStyle:{"text-align":"center"},attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:e.handleClose}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.addApprovalField}},[e._v("确 定\n        ")])],1)],1),e._v(" "),a("el-tree",{attrs:{data:e.data,"node-key":"id",accordion:"","expand-on-click-node":!1},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.node,i=t.data;return a("span",{staticClass:"custom-tree-node"},[a("span",[e._v(e._s(r.label))]),e._v(" "),a("div",[3!==r.level?a("span",[a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(){return e.append(i)}}},[e._v("\n          添加\n        ")])],1):e._e(),e._v(" "),1!==r.level?a("span",[a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(){return e.remove(r,i)}}},[e._v("\n          删除\n        ")])],1):e._e()])])}}])})],1)],1)},staticRenderFns:[]}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-button",{staticStyle:{"margin-bottom":"10px"},attrs:{type:"primary",size:"small"},on:{click:function(t){e.visible=!0}}},[e._v("新增类型\n    ")]),e._v(" "),a("el-button-group",["2021061500000001"===e.role_id?a("approval-field"):e._e()],1),e._v(" "),a("el-form",{staticStyle:{"margin-top":"15px"},attrs:{inline:!0,model:e.form}},[a("el-form-item",{attrs:{label:"审批类型编号"}},[a("el-input",{attrs:{clearable:"",placeholder:"请输入审批类型编号",size:"small"},model:{value:e.form.approval_type,callback:function(t){e.$set(e.form,"approval_type",t)},expression:"form.approval_type"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"审批类型名称"}},[a("el-input",{attrs:{clearable:"",placeholder:"请输入审批类型名称",size:"small"},model:{value:e.form.approval_type_name,callback:function(t){e.$set(e.form,"approval_type_name",t)},expression:"form.approval_type_name"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-search"},on:{click:e.getApprovalTypeList}},[e._v("搜索\n        ")])],1)],1),e._v(" "),a("base-table",{attrs:{list:e.dataList,data:e.approvalTypeList}},[a("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",icon:"el-icon-edit-outline"},on:{click:function(a){return e.editApprovalType(t.row.id,t.row.approval_type)}}},[e._v("编辑\n          ")]),e._v(" "),a("el-button",{staticStyle:{color:"red"},attrs:{type:"text",icon:"el-icon-delete"},on:{click:function(a){return e.deleteApprovalType(t.row.id)}}},[e._v("删除\n          ")])]}}])})],1),e._v(" "),a("base-page",{attrs:{page:e.pageNum,size:e.pageSize,total:e.total},on:{size:e.changeSize,page:e.changePage}}),e._v(" "),a("el-dialog",{attrs:{title:e.form.id?"修改类型":"新增类型",visible:e.visible,width:"45%","before-close":e.handleClose},on:{"update:visible":function(t){e.visible=t}}},[a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"90px"}},[e.form.id?a("el-form-item",{attrs:{label:"审批类型编号",prop:"approval_type"}},[a("el-input",{attrs:{size:"small",disabled:!0},model:{value:e.form.approval_type,callback:function(t){e.$set(e.form,"approval_type",t)},expression:"form.approval_type"}})],1):e._e(),e._v(" "),e.form.id?e._e():a("el-form-item",{attrs:{label:"审批类型编号",prop:"approval_type"}},[a("el-input",{attrs:{size:"small"},model:{value:e.form.approval_type,callback:function(t){e.$set(e.form,"approval_type",t)},expression:"form.approval_type"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"审批类型名称",prop:"approval_type_name"}},[a("el-input",{attrs:{size:"small"},model:{value:e.form.approval_type_name,callback:function(t){e.$set(e.form,"approval_type_name",t)},expression:"form.approval_type_name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"免审批项",prop:"approval_items"}},[a("el-cascader",{attrs:{options:e.items,props:e.props,clearable:"",filterable:""},model:{value:e.form.approval_items,callback:function(t){e.$set(e.form,"approval_items",t)},expression:"form.approval_items"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"是否启用",prop:"use_up"}},[a("el-radio",{attrs:{label:"0"},model:{value:e.form.use_up,callback:function(t){e.$set(e.form,"use_up",t)},expression:"form.use_up"}},[e._v("否")]),e._v(" "),a("el-radio",{attrs:{label:"1"},model:{value:e.form.use_up,callback:function(t){e.$set(e.form,"use_up",t)},expression:"form.use_up"}},[e._v("是")])],1),e._v(" "),a("el-form-item",{attrs:{label:"备注",prop:"remarks"}},[a("el-input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:4},placeholder:"请输入内容"},model:{value:e.form.remarks,callback:function(t){e.$set(e.form,"remarks",t)},expression:"form.remarks"}})],1)],1),e._v(" "),a("div",{staticStyle:{"text-align":"center"},attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:e.handleClose}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.addApprovalType}},[e._v("确 定\n        ")])],1)],1)],1)},staticRenderFns:[]}},function(e,t,a){var r=a(3)(a(801),a(802),null,null);e.exports=r.exports},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(6),i=a.n(r),o=a(5),l=a.n(o),s=a(10),n=a.n(s);t.default={components:{baseTable:l.a,basePage:n.a},name:"approvalProcess",data:function(){return{form:{},dataList:[{label:"审批类型编号",prop:"approval_type",sort:!0},{label:"审批类型名称",prop:"approval_type_name",sort:!0},{label:"备注",prop:"remarks"}],approvalTypeList:[],pageNum:1,pageSize:10,total:0,visible:!1}},mounted:function(){},watch:{visible:function(e){e||(this.form={})}},methods:{getApprovalTypeForProcessList:function(){var e=this;this.$api.getApprovalTypeForProcessList(i()({page:this.pageNum-1,number:this.pageSize},this.form)).then(function(t){e.approvalTypeList=t.data.approvalTypeList,e.total=t.data.total})},showApprovalType:function(e){this.$router.push({path:"/approvalProcessDetail",name:"流程信息",query:{approval_type:e},params:{}})},changeSize:function(e){this.pageSize=e,this.getApprovalTypeForProcessList()},changePage:function(e){this.pageNum=e,this.getApprovalTypeForProcessList()}},beforeRouteEnter:function(e,t,a){a(function(t){e.params.searchKey&&(t.form=e.params.searchKey),t.getApprovalTypeForProcessList()})}}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-form",{staticStyle:{"margin-top":"15px"},attrs:{inline:!0,model:e.form}},[a("el-form-item",{attrs:{label:"审批类型编号"}},[a("el-input",{attrs:{clearable:"",placeholder:"请输入审批类型编号",size:"small"},model:{value:e.form.approval_type,callback:function(t){e.$set(e.form,"approval_type",t)},expression:"form.approval_type"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"审批类型名称"}},[a("el-input",{attrs:{clearable:"",placeholder:"请输入审批类型名称",size:"small"},model:{value:e.form.approval_type_name,callback:function(t){e.$set(e.form,"approval_type_name",t)},expression:"form.approval_type_name"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-search"},on:{click:e.getApprovalTypeForProcessList}},[e._v("搜索\n            ")])],1)],1),e._v(" "),a("base-table",{attrs:{list:e.dataList,data:e.approvalTypeList}},[a("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",icon:"el-icon-edit-outline"},on:{click:function(a){return e.showApprovalType(t.row.approval_type)}}},[e._v("查看\n                ")])]}}])})],1),e._v(" "),a("base-page",{attrs:{page:e.pageNum,size:e.pageSize,total:e.total},on:{size:e.changeSize,page:e.changePage}})],1)},staticRenderFns:[]}},function(e,t,a){a(804);var r=a(3)(a(805),a(808),null,null);e.exports=r.exports},function(e,t){},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(6),i=a.n(r),o=a(33),l=a.n(o),s=a(78),n=a.n(s),p=a(184),c=a.n(p),u=a(5),d=a.n(u),m=a(10),f=a.n(m),_=a(303),h=a.n(_);t.default={components:{baseTable:d.a,basePage:f.a,BranchTreePickerFH:h.a},name:"approvalProcessDetail",data:function(){return{defaultProps:{children:"sub_tree",label:"node_name"},labelPosition:"right",form2:{},data:[],visible2:!1,approvalItemList:[],approvalSymbolList1:[">",">=","<","<=","=","!="],approvalSymbolList2:["=","!="],approvalSymbolList3:["包含","不包含"],num:"0000",form:{},dataList:[{label:"审批流程编号",prop:"id",sort:!0},{label:"审批流程名称",prop:"approval_process_name",sort:!0},{label:"审批类型",prop:"approval_type"},{label:"所属分行",prop:"branch"},{label:"备注",prop:"remarks"}],rules:{approval_process_name:[{required:!0,message:"请输入审批流程名称",trigger:"blur"}]},rules2:{role_id:[{required:!0,message:"请选择角色",trigger:"change"}]},approvalRoleList:[],approvalProcessList:[],pageNum:1,pageSize:10,total:0,visible:!1}},computed:{},mounted:function(){this.getApprovalRoleList(),this.getApprovalItemList(),this.initNodeData()},watch:{visible:function(e){e||(this.form={})}},methods:{changeValue:function(e){var t={};t=this.approvalRoleList.find(function(t){return t.role_id===e}),this.$set(this.form2,"role_name",t.role_name)},initNodeData:function(){this.data=[]},appendFirst:function(){this.form2={},this.visible2=!0},checkItem:function(e){try{var t=JSON.parse(e);if(Array.isArray(t))return this.$message({message:"审批项格式错误,首级节点不能为数组",type:"error"}),!1;var a=c()(t),r=0,i=0,o=0;return a.forEach(function(e){if("或项"===e)r=1;else{if("和项"!==e)return o=1,!1;i=1}}),1===o?(this.$message({message:"审批项格式错误,首级节点只能包括或项/和项",type:"error"}),!1):1===r&&1===i?(this.$message({message:"审批项格式错误,首级节点只能包括一个或项/和项",type:"error"}),!1):this.checkItemDetail(t,a)}catch(e){console.log(e),this.$message({message:"审批项格式错误,json解析错误",type:"error"})}},checkItemDetail:function(e,t){return this.num="0000",this.checkItemDetail2(e,t),"0000"===this.num},checkItemDetail2:function(e,t){for(var a=this,r="0",i="0",o="0",l="0",s=0;s<t.length;s++){var p=t[s];if("或项"===p)if(r="1",Array.isArray(e.或项))for(var u=0;u<e.或项.length;u++){var d=e.或项[u];if(Array.isArray(d))return this.$message({message:"审批项格式错误,节点:"+p+"不能重复为数组",type:"error"}),this.num=r+i+o+l,!1;"0"!==o||"0"!==l||"0"!==r&&"0"!==i||this.checkItemDetail2(d,c()(d))}else"0"!==o||"0"!==l||"0"!==r&&"0"!==i||this.checkItemDetail2(e.或项,c()(e.或项));else if("和项"===p)if(r="1",Array.isArray(e.和项))for(var m=0;m<e.和项.length;m++){var f=e.和项[m];if(Array.isArray(f))return this.$message({message:"审批项格式错误,节点:"+p+"不能重复为数组",type:"error"}),this.num=r+i+o+l,!1;"0"!==o||"0"!==l||"0"!==r&&"0"!==i||this.checkItemDetail2(f,c()(f))}else"0"!==o||"0"!==l||"0"!==r&&"0"!==i||this.checkItemDetail2(e.和项,c()(e.和项));else if("项目"===p){var _=function(){if(i="1",Array.isArray(e.项目))return l="1",a.$message({message:"审批项格式错误,节点:"+p+"不能为数组",type:"error"}),a.num=r+i+o+l,{v:!1};var t=e.项目,s=t.split(" ");if(3!==s.length)return l="1",a.$message({message:"审批项格式错误,节点:"+p+"格式不正确",type:"error"}),a.num=r+i+o+l,{v:!1};var n=s[0],c=s[1],u=s[2];if(void 0===a.approvalItemList.find(function(e){return e.approval_item===n}))return l="1",a.$message({message:"审批项格式错误,节点:"+p+"含有非支持校验项:"+n,type:"error"}),a.num=r+i+o+l,{v:!1};if("年龄"===n){if(void 0===a.approvalSymbolList1.find(function(e){return e===c}))return l="1",a.$message({message:"审批项格式错误,校验项:"+n+"含有非支持符号:"+c,type:"error"}),a.num=r+i+o+l,{v:!1};if(!/^(0|\+?[1-9][0-9]*)$/.test(u))return l="1",a.$message({message:"审批项格式错误,校验项:"+n+"含有非支持值:"+u,type:"error"}),a.num=r+i+o+l,{v:!1}}if("信用类、保证类贷款余额"===n){if(void 0===a.approvalSymbolList1.find(function(e){return e===c}))return l="1",a.$message({message:"审批项格式错误,校验项:"+n+"含有非支持符号:"+c,type:"error"}),a.num=r+i+o+l,{v:!1};if(!/^(([1-9][0-9]*)|(([0]\.\d{1,2}|[1-9][0-9]*\.\d{1,2})))$/.test(u))return l="1",a.$message({message:"审批项格式错误,校验项:"+n+"含有非支持值:"+u,type:"error"}),a.num=r+i+o+l,{v:!1}}if("站长是否特殊人员"===n){if(void 0===a.approvalSymbolList2.find(function(e){return e===c}))return l="1",a.$message({message:"审批项格式错误,校验项:"+n+"含有非支持符号:"+c,type:"error"}),a.num=r+i+o+l,{v:!1};if(void 0===a.approvalItemList.find(function(e){if("站长是否特殊人员"===e.approval_item){return e.approval_item_value.split("|").find(function(e){return e===u})}}))return l="1",a.$message({message:"审批项格式错误,校验项:"+n+"含有非支持值:"+u,type:"error"}),a.num=r+i+o+l,{v:!1}}if("征信逾期情况"===n){if(void 0===a.approvalSymbolList2.find(function(e){return e===c}))return l="1",a.$message({message:"审批项格式错误,校验项:"+n+"含有非支持符号:"+c,type:"error"}),a.num=r+i+o+l,{v:!1};if(void 0===a.approvalItemList.find(function(e){if("征信逾期情况"===e.approval_item){return e.approval_item_value.split("|").find(function(e){return e===u})}}))return l="1",a.$message({message:"审批项格式错误,校验项:"+n+"含有非支持值:"+u,type:"error"}),a.num=r+i+o+l,{v:!1}}if("近2年是否发生过90天及以上的逾期"===n){if(void 0===a.approvalSymbolList2.find(function(e){return e===c}))return l="1",a.$message({message:"审批项格式错误,校验项:"+n+"含有非支持符号:"+c,type:"error"}),a.num=r+i+o+l,{v:!1};if(void 0===a.approvalItemList.find(function(e){if("近2年是否发生过90天及以上的逾期"===e.approval_item){return e.approval_item_value.split("|").find(function(e){return e===u})}}))return l="1",a.$message({message:"审批项格式错误,校验项:"+n+"含有非支持值:"+u,type:"error"}),a.num=r+i+o+l,{v:!1}}if("学历"===n){if(void 0===a.approvalSymbolList3.find(function(e){return e===c}))return l="1",a.$message({message:"审批项格式错误,校验项:"+n+"含有非支持符号:"+c,type:"error"}),a.num=r+i+o+l,{v:!1};u.split("|").forEach(function(e){var t=!1;if(a.approvalItemList.forEach(function(a){if("学历"===a.approval_item){a.approval_item_value.split("|").forEach(function(a){e===a&&(t=!0)})}}),!t)return l="1",a.$message({message:"审批项格式错误,校验项:"+n+"含有非支持值:"+u,type:"error"}),a.num=r+i+o+l,!1})}if("站长候选人信息情况"===n){if(void 0===a.approvalSymbolList3.find(function(e){return e===c}))return l="1",a.$message({message:"审批项格式错误,校验项:"+n+"含有非支持符号:"+c,type:"error"}),a.num=r+i+o+l,{v:!1};u.split("|").forEach(function(e){var t=!1;if(a.approvalItemList.forEach(function(a){if("站长候选人信息情况"===a.approval_item){a.approval_item_value.split("|").forEach(function(a){e===a&&(t=!0)})}}),!t)return l="1",a.$message({message:"审批项格式错误,校验项:"+n+"含有非支持值:"+u,type:"error"}),a.num=r+i+o+l,!1})}}();if("object"===(void 0===_?"undefined":n()(_)))return _.v}else{if("备注"!==p)return o="1",this.$message({message:"审批项格式错误,节点含有非支持条件项:"+p,type:"error"}),this.num=r+i+o+l,!1;if(i="1",Array.isArray(e.备注))return l="1",this.$message({message:"审批项格式错误,节点:"+p+"不能为数组",type:"error"}),this.num=r+i+o+l,!1}}if("1"===r&&"1"===i)return this.$message({message:"审批项格式错误,同级节点不能同时存在归集项及条件项",type:"error"}),this.num=r+i+o+l,!1},createNode:function(){var e=this;this.$refs.form2.validate(function(t){if(t)if(e.form2.node_code){if(e.form2.approval_item&&!e.checkItem(e.form2.approval_item))return;var a={};a.node_code=e.form2.node_code,a.node_id=e.form2.role_id,a.node_name=e.form2.role_name,e.form2.approval_item?a.node_item=JSON.parse(e.form2.approval_item):a.node_item=e.form2.approval_item,e.updateNodeData(e.data,a),e.form2={},e.visible2=!1}else{if(e.form2.approval_item&&!e.checkItem(e.form2.approval_item))return;var r={};r.node_code=e.guid(),r.node_id=e.form2.role_id,r.node_name=e.form2.role_name,e.form2.approval_item?r.node_item=JSON.parse(e.form2.approval_item):r.node_item=e.form2.approval_item,r.super_code=e.form2.super_code,r.sub_tree=[],e.pushNodeData(e.data,r),e.form2={},e.visible2=!1}})},pushNodeData:function(e,t){var a=this;t.super_code?e.map(function(e){e.node_code==t.super_code?e.sub_tree.push(t):e.sub_tree.length>0&&a.pushNodeData(e.sub_tree,t)}):e.push(t)},updateNodeData:function(e,t){var a=this;e.map(function(e){e.node_code==t.node_code?(e.node_id=t.node_id,e.node_name=t.node_name,e.node_item=t.node_item,e.role_id=t.node_id,e.role_name=t.node_name,t.node_item?e.approval_item=l()(t.node_item,null,4):e.approval_item=t.node_item):e.sub_tree.length>0&&a.updateNodeData(e.sub_tree,t)})},append:function(e,t){this.visible2=!0,this.$set(this.form2,"super_code",t.node_code)},editNode:function(e){console.log(e),this.visible2=!0,this.form2=e,this.$set(this.form2,"role_id",e.node_id),this.$set(this.form2,"role_name",e.node_name),e.node_item?this.$set(this.form2,"approval_item",l()(e.node_item,null,4)):this.$set(this.form2,"approval_item",e.node_item)},removeNode:function(e){var t=this;this.$confirm("确定删除审批流节点？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!0}).then(function(){t.deleteNodeData(t.data,e.node_code)}).catch(function(){})},deleteNodeData:function(e,t){var a=this;e.map(function(r){if(r.node_code==t){if(r.sub_tree.length>0)return void a.$message({message:"存在下级节点，不可删除",type:"warning"});var i=e.indexOf(r);i>-1&&e.splice(i,1)}else r.sub_tree.length>0&&a.deleteNodeData(r.sub_tree,t)})},guid:function(){function e(){return(65536*(1+Math.random())|0).toString(16).substring(1)}return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()},getApprovalItemList:function(){var e=this,t=this.$route.query.approval_type;this.$api.getApprovalItemList({approval_type:t}).then(function(t){e.approvalItemList=t.data})},nodeselectForShow:function(e){this.$set(this.form,"branch_name",e.branch_name),this.$set(this.form,"branch_id",e.branch_id)},getApprovalRoleList:function(){var e=this;this.$api.getApprovalRoleList().then(function(t){e.approvalRoleList=t.data})},addApprovalProcess:function(){var e=this;this.$refs.form.validate(function(t){var a=e.$route.query.approval_type;if(t){if(e.data.length<1)return void e.$message({message:"请设置审批流程",type:"error"});e.form.new_approval_process=l()(e.data),e.form.id?e.$api.updateApprovalProcess(i()({approval_type:a},e.form)).then(function(t){e.handleClose(),e.getApprovalProcessList()}):e.$api.addApprovalProcess(i()({approval_type:a},e.form)).then(function(t){e.handleClose(),e.getApprovalProcessList()})}})},editApprovalProcess:function(e){var t=this;this.$api.getApprovalProcess({id:e}).then(function(e){console.log(e),t.visible=!0,t.form=e.data.msg[0],t.data=[],e.data.msg[0].new_approval_process&&(t.data=JSON.parse(e.data.msg[0].new_approval_process))})},getApprovalProcessList:function(){var e=this,t=this.$route.query.approval_type;this.$api.getApprovalProcessList(i()({page:this.pageNum-1,number:this.pageSize,approval_type:t},this.form)).then(function(t){e.approvalProcessList=t.data.approvalProcessList,e.total=t.data.total})},changeSize:function(e){this.pageSize=e,this.getApprovalProcessList()},changePage:function(e){this.pageNum=e,this.getApprovalProcessList()},deleteApprovalProcess:function(e){var t=this;this.$confirm("确定删除该审批流程吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!0}).then(function(){t.$api.deleteApprovalProcess({id:e}).then(function(e){console.log(e),t.getApprovalProcessList()})}).catch(function(){})},handleClose:function(){this.visible=!1,this.form={}}},beforeRouteEnter:function(e,t,a){a(function(t){e.params.searchKey&&(t.form=e.params.searchKey),t.getApprovalProcessList()})}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={name:"basePage",props:{dfk:{type:String,default:""},appendToBody:!1},data:function(){return{dialogVisible:!1,showlist:[],defaultProps:{children:"children",label:"branch_name"},dfks:[]}},methods:{nodec:function(e){console.log(e),this.$emit("nodeselect",e),this.dialogVisible=!1},geBankList:function(){var e=this;if(this.showlist.length>0)return void(this.dialogVisible=!0);this.$api.getBranchByLevel({bran_level:"1"}).then(function(t){e.dealwithBranch(t.data),e.dialogVisible=!0})},dealwithBranch:function(e){this.showlist=e,this.dfks=[this.dfk]},findchildren:function(e,t){var a=[];console.log(t,11);for(var r=0;r<e.length;r++)if(e[r].porgid==t.branch_id){var i=this.findchildren(e,e[r]);i.length>0&&(e[r].children=i),a.push(e[r])}return a}}}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{"margin-left":"1px"}},[a("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){return e.geBankList()}}},[e._v("选择")]),e._v(" "),a("el-dialog",{attrs:{title:"机构选择",visible:e.dialogVisible,"append-to-body":e.appendToBody},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-tree",{attrs:{data:e.showlist,"node-key":"branch_id",props:e.defaultProps,"default-expanded-keys":e.dfks},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.node,i=t.data;return a("span",{staticClass:"custom-tree-node"},[a("span",[e._v(e._s(r.label))]),e._v(" "),a("span",[a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(){return e.nodec(i)}}},[e._v("\n\t\t\t            选择\n\t\t\t          ")])],1)])}}])})],1)],1)},staticRenderFns:[]}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-button",{staticStyle:{"margin-bottom":"10px"},attrs:{type:"primary",size:"small"},on:{click:function(t){e.visible=!0,e.data=[]}}},[e._v("新增流程\n    ")]),e._v(" "),a("el-form",{staticStyle:{"margin-top":"15px"},attrs:{inline:!0,model:e.form}},[a("el-form-item",{attrs:{label:"审批流程编号"}},[a("el-input",{attrs:{clearable:"",placeholder:"请输入审批流程编号",size:"small"},model:{value:e.form.id,callback:function(t){e.$set(e.form,"id",t)},expression:"form.id"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"审批流程名称"}},[a("el-input",{attrs:{clearable:"",placeholder:"请输入审批流程名称",size:"small"},model:{value:e.form.approval_process_name,callback:function(t){e.$set(e.form,"approval_process_name",t)},expression:"form.approval_process_name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"所属分行"}},[a("el-input",{attrs:{clearable:"",placeholder:"请输入所属分行",size:"small"},model:{value:e.form.branch,callback:function(t){e.$set(e.form,"branch",t)},expression:"form.branch"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-search"},on:{click:e.getApprovalProcessList}},[e._v("搜索\n            ")])],1)],1),e._v(" "),a("base-table",{attrs:{list:e.dataList,data:e.approvalProcessList}},[a("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",icon:"el-icon-edit-outline"},on:{click:function(a){return e.editApprovalProcess(t.row.id)}}},[e._v("编辑\n                ")]),e._v(" "),a("el-button",{staticStyle:{color:"red"},attrs:{type:"text",icon:"el-icon-delete"},on:{click:function(a){return e.deleteApprovalProcess(t.row.id)}}},[e._v("删除\n                ")])]}}])})],1),e._v(" "),a("base-page",{attrs:{page:e.pageNum,size:e.pageSize,total:e.total},on:{size:e.changeSize,page:e.changePage}}),e._v(" "),a("el-dialog",{attrs:{title:e.form.id?"修改流程":"新增流程",visible:e.visible,width:"45%","before-close":e.handleClose},on:{"update:visible":function(t){e.visible=t}}},[a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"90px"}},[a("el-form-item",{attrs:{label:"审批流程名称",prop:"approval_process_name"}},[a("el-input",{attrs:{size:"small"},model:{value:e.form.approval_process_name,callback:function(t){e.$set(e.form,"approval_process_name",t)},expression:"form.approval_process_name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"所属分行",prop:"branch_id"}},[a("div",{staticStyle:{display:"flex"}},[a("el-input",{attrs:{disabled:!0},model:{value:this.form.branch_name,callback:function(t){e.$set(this.form,"branch_name",t)},expression:"this.form.branch_name"}}),e._v(" "),a("BranchTreePickerFH",{directives:[{name:"show",rawName:"v-show",value:!e.form.id,expression:"!form.id"}],attrs:{dfks:this.form.branch_id,appendToBody:!0},on:{nodeselect:e.nodeselectForShow}})],1)]),e._v(" "),a("el-form-item",{attrs:{label:"备注",prop:"remarks"}},[a("el-input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:4},placeholder:"请输入内容"},model:{value:e.form.remarks,callback:function(t){e.$set(e.form,"remarks",t)},expression:"form.remarks"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"审批流程配置"}},[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(){return e.appendFirst(e.data)}}},[e._v("\n                    添加审批流节点\n                ")]),e._v(" "),a("el-popover",{attrs:{placement:"top-start",trigger:"hover"}},[a("div",{staticStyle:{color:"red",height:"600px",overflow:"auto"}},[a("h5",[e._v("1、目前可以对【新增站点】【风险处置整改】字段规则判断")]),e._v(" "),a("h5",[e._v("        (1)、年龄:可以使用【>/>=/</<=/=/!=】操作符,例:年龄 > 60")]),e._v(" "),a("h5",[e._v("        (2)、学历:可以使用【包含/不包含】操作符,若值为多项,请以|分割,例:学历 包括 本科|研究生及以上")]),e._v(" "),a("h5",[e._v("        (3)、站长候选人信息情况:可以使用【包含/不包含】操作符,若值为多项,请以|分割,例:站长候选人信息情况 包括 企业主或个体户|企事单位职员")]),e._v(" "),a("h5",[e._v("        (4)、站长是否特殊人员:可以使用【=/!=】操作符,例:站长是否特殊人员 = 是")]),e._v(" "),a("h5",[e._v("        (5)、征信逾期情况:可以使用【=/!=】操作符,例:征信逾期情况 = 当期有逾期")]),e._v(" "),a("h5",[e._v("        (6)、近2年是否发生过90天及以上的逾期:可以使用【=/!=】操作符,例:近2年是否发生过90天及以上的逾期 = 是")]),e._v(" "),a("h5",[e._v("        (7)、信用类、保证类贷款余额:可以使用【>/>=/</<=/=/!=】操作符,例:信用类、保证类贷款余额 >= 500000")]),e._v(" "),a("h5",[e._v("        (8)、风险等级:可以使用【=/!=】操作符,例:风险等级 = 高")]),e._v(" "),a("h5",[e._v("2、可以使用或项/和项关系符,或项下的节点只需满足其一即可,和项下的节点需要全部满足")]),e._v(" "),a("h5",[e._v("            模板一:"),a("br"),e._v("\n                                                    {"),a("br"),e._v('\n                                                                "或项":['),a("br"),e._v("\n                                                                            {"),a("br"),e._v('\n                                                                                        "项目":"年龄 > 60",'),a("br"),e._v('\n                                                                                        "备注":"无"'),a("br"),e._v("\n                                                                            },"),a("br"),e._v("\n                                                                            {"),a("br"),e._v('\n                                                                                        "项目":"学历 包含 本科|研究生及以上",'),a("br"),e._v('\n                                                                                        "备注":"无"'),a("br"),e._v("\n                                                                            }"),a("br"),e._v("\n                                                                ]"),a("br"),e._v("\n                                                    }\n                        ")]),e._v(" "),a("h5",[e._v("            模板二:"),a("br"),e._v("\n                                                    {"),a("br"),e._v('\n                                                                "或项":['),a("br"),e._v("\n                                                                            {"),a("br"),e._v('\n                                                                                        "或项":['),a("br"),e._v("\n                                                                                                    {"),a("br"),e._v('\n                                                                                                                "项目":"年龄 > 60",'),a("br"),e._v('\n                                                                                                                "备注":"无"'),a("br"),e._v("\n                                                                                                    },"),a("br"),e._v("\n                                                                                                    {"),a("br"),e._v('\n                                                                                                                "项目":"学历 包含 本科|研究生及以上",'),a("br"),e._v('\n                                                                                                                "备注":"无"'),a("br"),e._v("\n                                                                                                    }"),a("br"),e._v("\n                                                                                        ]"),a("br"),e._v("\n                                                                            },"),a("br"),e._v("\n                                                                            {"),a("br"),e._v('\n                                                                                        "和项":['),a("br"),e._v("\n                                                                                                    {"),a("br"),e._v('\n                                                                                                                "项目":"年龄 <= 60",'),a("br"),e._v('\n                                                                                                                "备注":"无"'),a("br"),e._v("\n                                                                                                    },"),a("br"),e._v("\n                                                                                                    {"),a("br"),e._v('\n                                                                                                                "项目":"征信逾期情况 = 当期有逾期",'),a("br"),e._v('\n                                                                                                                "备注":"无"'),a("br"),e._v("\n                                                                                                    }"),a("br"),e._v("\n                                                                                        ]"),a("br"),e._v("\n                                                                            }"),a("br"),e._v("\n                                                                ]"),a("br"),e._v("\n                                                    }\n                        ")])]),e._v(" "),a("span",{staticStyle:{color:"red"},attrs:{slot:"reference"},slot:"reference"},[e._v("说明")])])],1)],1),e._v(" "),a("div",[a("el-tree",{attrs:{data:e.data,props:e.defaultProps,"node-key":"path","default-expand-all":"","expand-on-click-node":!1},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.node,i=t.data;return a("div",{staticClass:"custom-tree-node"},[a("span",[a("i",{staticClass:"el-icon-user"}),e._v(e._s(r.label)+" ")]),e._v(" "),a("el-popover",{attrs:{placement:"top-start",trigger:"hover",width:"500"}},[a("span",{staticStyle:{color:"red"}},[e._v("备注:"),a("br"),e._v("\n                                    一、若符合下面条件,则由该节点角色审批"),a("br"),e._v("\n                                    二、若不符合下面条件,则转同级节点的下一角色处理（若无下一角色或不满\n                                        \n                            足所有角色条件,则结束审批）\n                                            \n                                            \n                                            \n                        ")]),e._v(" "),a("el-input",{attrs:{type:"textarea",autosize:{minRows:6,maxRows:12},placeholder:"请输入内容",value:JSON.stringify(i.node_item,null,4)}}),e._v(" "),a("span",{attrs:{slot:"reference"},slot:"reference"},[e._v("说明")])],1),e._v(" "),a("span",[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(){return e.append(r,i)}}},[e._v("\n                            添加\n                          ")]),e._v(" "),a("el-button",{attrs:{type:"warning",size:"small"},on:{click:function(){return e.editNode(i)}}},[e._v("\n                            编辑\n                          ")]),e._v(" "),a("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(){return e.removeNode(i)}}},[e._v("\n                            删除\n                          ")])],1)],1)}}])})],1),e._v(" "),a("div",{staticStyle:{"text-align":"center"},attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:e.handleClose}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.addApprovalProcess}},[e._v("确 定\n            ")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"审批流节点设置",visible:e.visible2,width:"40%","show-close":!1},on:{"update:visible":function(t){e.visible2=t}}},[a("el-form",{ref:"form2",attrs:{model:e.form2,rules:e.rules2,"label-position":"right","label-width":"60px"}},[a("el-form-item",{attrs:{label:"角色",prop:"role_id"}},[a("el-select",{on:{change:e.changeValue},model:{value:e.form2.role_id,callback:function(t){e.$set(e.form2,"role_id",t)},expression:"form2.role_id"}},e._l(e.approvalRoleList,function(e){return a("el-option",{key:e.role_id,attrs:{label:e.role_name,value:e.role_id}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"条件项",prop:"approval_item"}},[a("el-input",{attrs:{type:"textarea",autosize:{minRows:6,maxRows:12},placeholder:"请输入内容"},model:{value:e.form2.approval_item,callback:function(t){e.$set(e.form2,"approval_item",t)},expression:"form2.approval_item"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:function(t){e.visible2=!1,e.form2={}}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.createNode}},[e._v("确 定\n            ")])],1)],1)],1)},staticRenderFns:[]}},function(e,t,a){var r=a(3)(a(810),a(811),null,null);e.exports=r.exports},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(6),i=a.n(r),o=a(5),l=a.n(o),s=a(10),n=a.n(s);t.default={components:{baseTable:l.a,basePage:n.a},name:"approvalApply",data:function(){return{role:sessionStorage.getItem("role"),form:{},dataList:[{label:"申请编号",prop:"id",sort:!0},{label:"申请类型",prop:"approval_type_name"},{label:"申请项目",prop:"message"},{label:"审批状态",prop:"approval_status_name"},{label:"申请时间",prop:"create_time",sort:!0}],approvalTypeList:[],approvalStatusList:[],approvalApplyList:[],pageNum:1,pageSize:10,total:0,visible:!1}},mounted:function(){this.getApprovalTypeList(),this.getApprovalStatusList()},watch:{visible:function(e){e||(this.form={})}},methods:{getApprovalTypeList:function(){var e=this;0==this.approvalTypeList.length&&this.$api.getApprovalTypeByEnum().then(function(t){e.approvalTypeList=t.data})},getApprovalStatusList:function(){var e=this;0==this.approvalStatusList.length&&this.$api.getApprovalStatusByEnum().then(function(t){e.approvalStatusList=t.data})},getApprovalApplyList:function(){var e=this;this.$api.getApprovalApplyList(i()({page:this.pageNum-1,number:this.pageSize},this.form)).then(function(t){e.approvalApplyList=t.data.approvalApplyList,e.total=t.data.total})},showApprovalApply:function(e,t,a,r){var i=!0;"4"==r&&(i=!1),this.$router.push({path:"/approvalApplyDetail",name:"申请信息",query:{id:a,role:this.role,check:i,apply_id:e,approval_type:t,req_place:"1"},params:{searchKey:this.form}})},fqApprovalApply:function(e,t){var a=this;this.$confirm("确定废弃该申请吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!0}).then(function(){a.$api.fqApprovalApply({apply_id:e,approval_type:t}).then(function(e){console.log(e),a.getApprovalApplyList()})}).catch(function(){})},hfApprovalApply:function(e,t){var a=this;this.$confirm("确定恢复该申请吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!0}).then(function(){a.$api.hfApprovalApply({apply_id:e,approval_type:t}).then(function(e){console.log(e),a.getApprovalApplyList()})}).catch(function(){})},changeSize:function(e){this.pageSize=e,this.getApprovalApplyList()},changePage:function(e){this.pageNum=e,this.getApprovalApplyList()}},beforeRouteEnter:function(e,t,a){a(function(t){e.params.searchKey&&(t.form=e.params.searchKey),t.getApprovalApplyList()})}}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-form",{staticStyle:{"margin-top":"15px"},attrs:{inline:!0,model:e.form}},[a("el-form-item",{attrs:{label:"申请日期",prop:"start_date"}},[a("el-date-picker",{staticStyle:{width:"200px"},attrs:{type:"date","value-format":"yyyy-MM-dd",clearable:"",placeholder:"选择日期"},model:{value:e.form.start_date,callback:function(t){e.$set(e.form,"start_date",t)},expression:"form.start_date"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"——",prop:"end_date"}},[a("el-date-picker",{staticStyle:{width:"200px"},attrs:{type:"date","value-format":"yyyy-MM-dd",clearable:"",placeholder:"选择日期"},model:{value:e.form.end_date,callback:function(t){e.$set(e.form,"end_date",t)},expression:"form.end_date"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"申请编号"}},[a("el-input",{attrs:{clearable:"",placeholder:"请输入申请编号",size:"small"},model:{value:e.form.id,callback:function(t){e.$set(e.form,"id",t)},expression:"form.id"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"申请类型",prop:"approval_type"}},[a("el-select",{attrs:{clearable:"",size:"small"},model:{value:e.form.approval_type,callback:function(t){e.$set(e.form,"approval_type",t)},expression:"form.approval_type"}},e._l(e.approvalTypeList,function(e){return a("el-option",{key:e.approvalType,attrs:{label:e.approvalTypeName,value:e.approvalType}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"审批状态",prop:"approval_status"}},[a("el-select",{attrs:{clearable:"",size:"small"},model:{value:e.form.approval_status,callback:function(t){e.$set(e.form,"approval_status",t)},expression:"form.approval_status"}},e._l(e.approvalStatusList,function(e){return a("el-option",{key:e.approvalStatus,attrs:{label:e.approvalStatusName,value:e.approvalStatus}})}),1)],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-search"},on:{click:e.getApprovalApplyList}},[e._v("搜索\n            ")])],1)],1),e._v(" "),a("base-table",{attrs:{list:e.dataList,data:e.approvalApplyList}},[a("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",icon:"el-icon-edit-outline"},on:{click:function(a){return e.showApprovalApply(t.row.id,t.row.approval_type,t.row.relation_id,t.row.approval_status)}}},[e._v("查看\n                ")]),e._v(" "),"1"==t.row.approval_status?a("el-button",{attrs:{type:"text",icon:"el-icon-star-on"},on:{click:function(a){return e.fqApprovalApply(t.row.id,t.row.approval_type)}}},[e._v("废弃\n                ")]):e._e(),e._v(" "),"9"==t.row.approval_status?a("el-button",{attrs:{type:"text",icon:"el-icon-star-off"},on:{click:function(a){return e.hfApprovalApply(t.row.id,t.row.approval_type)}}},[e._v("恢复\n                ")]):e._e()]}}])})],1),e._v(" "),a("base-page",{attrs:{page:e.pageNum,size:e.pageSize,total:e.total},on:{size:e.changeSize,page:e.changePage}})],1)},staticRenderFns:[]}},function(e,t,a){var r=a(3)(a(813),a(819),null,null);e.exports=r.exports},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(90),i=a.n(r),o=a(91),l=a.n(o),s=a(79),n=a.n(s),p=a(118),c=a.n(p),u=a(119),d=a.n(u);t.default={components:{baseInfoRisk:d.a,baseInfoStaff:i.a,baseInfoSite:l.a,baseInfoTeam:n.a,approvalHis:c.a},name:"approvalApplyDetail",data:function(){return{activeNames:["baseInfo"],approval_type:"",apply_id:"",approvalStepList:[],approvalApplyDetail:{},type002:this.$loacalData.code_GetEnums(this.$loacalData.listApprovalType,"002").code,type003:this.$loacalData.code_GetEnums(this.$loacalData.listApprovalType,"003").code,type004:this.$loacalData.code_GetEnums(this.$loacalData.listApprovalType,"004").code,type005:this.$loacalData.code_GetEnums(this.$loacalData.listApprovalType,"005").code,type006:this.$loacalData.code_GetEnums(this.$loacalData.listApprovalType,"006").code,type007:this.$loacalData.code_GetEnums(this.$loacalData.listApprovalType,"007").code,type008:this.$loacalData.code_GetEnums(this.$loacalData.listApprovalType,"008").code,type009:this.$loacalData.code_GetEnums(this.$loacalData.listApprovalType,"009").code,type010:this.$loacalData.code_GetEnums(this.$loacalData.listApprovalType,"010").code,type011:this.$loacalData.code_GetEnums(this.$loacalData.listApprovalType,"011").code,type012:this.$loacalData.code_GetEnums(this.$loacalData.listApprovalType,"012").code,type013:this.$loacalData.code_GetEnums(this.$loacalData.listApprovalType,"013").code,type014:this.$loacalData.code_GetEnums(this.$loacalData.listApprovalType,"014").code,type015:this.$loacalData.code_GetEnums(this.$loacalData.listApprovalType,"015").code,type016:this.$loacalData.code_GetEnums(this.$loacalData.listApprovalType,"016").code,type017:this.$loacalData.code_GetEnums(this.$loacalData.listApprovalType,"017").code,type018:this.$loacalData.code_GetEnums(this.$loacalData.listApprovalType,"018").code,type019:this.$loacalData.code_GetEnums(this.$loacalData.listApprovalType,"019").code,type020:this.$loacalData.code_GetEnums(this.$loacalData.listApprovalType,"020").code,type021:this.$loacalData.code_GetEnums(this.$loacalData.listApprovalType,"021").code,type022:this.$loacalData.code_GetEnums(this.$loacalData.listApprovalType,"022").code,type023:this.$loacalData.code_GetEnums(this.$loacalData.listApprovalType,"023").code}},mounted:function(){this.apply_id=this.$route.query.apply_id,this.approval_type=this.$route.query.approval_type,this.getApprovalStepList(),this.getUpdateInfo()},watch:{visible:function(e){e||(this.form={})}},methods:{getApprovalStepList:function(){var e=this;this.$api.getApprovalStepList({apply_id:this.apply_id}).then(function(t){e.approvalStepList=t.data.approvalStepList})},getUpdateInfo:function(){var e=this;this.$api.getUpdateInfo({apply_id:this.apply_id}).then(function(t){e.approvalApplyDetail=t.data})},handleChange:function(e){console.log(e)},handleClose:function(){this.visible=!1,this.form={}}}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(5),i=a.n(r);t.default={components:{baseTable:i.a},name:"approvalHis",data:function(){return{dataList:[{label:"时间",prop:"create_time",sort:!0},{label:"节点名称",prop:"role_name"},{label:"操作人员编号",prop:"approval_user"},{label:"操作人员姓名",prop:"name"},{label:"操作",prop:"approval_opinion"},{label:"处理意见",prop:"approval_desc"}],approvalHisList:[]}},mounted:function(){var e=this,t=this.$route.query.apply_id;this.$api.getApprovalHisList({apply_id:t}).then(function(t){e.approvalHisList=t.data})},methods:{}}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("base-table",{attrs:{list:e.dataList,data:e.approvalHisList}})],1)},staticRenderFns:[]}},function(e,t){},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={name:"riskDetail",data:function(){return{rules:{schedule:[{required:!0,message:"整改进度不能为空",trigger:"change"}],status:[{required:!0,message:"请选择整改状态",trigger:"change"}],written:[{required:!0,message:"请选择反馈人姓名",trigger:"change"}]},items:[{label:"已整改",value:1},{label:"无需整改",value:2},{label:"无法整改",value:3}],apply_id:"",req_place:"",check:!1,risk:[],dialogVisible:!1,dialogImageUrl:"",fileList:[],userList:[]}},mounted:function(){var e=this;this.$api.getRiskDetail({apply_id:this.$route.query.apply_id}).then(function(t){e.risk=t.data,e.risk.risk_photo&&e.$api.getPhotoList({ids:e.risk.risk_photo}).then(function(t){e.fileList=t.data.photoList,e.risk.risk_photo="",e.fileList.map(function(t){t.response={data:[{id:t.name}]},e.risk.risk_photo+="'"+t.response.data[0].id+"',"}),e.risk.risk_photo=e.risk.risk_photo.substr(0,e.risk.risk_photo.length-1)})}),this.check="false"!==this.$route.query.check&&Boolean(this.$route.query.check),this.req_place=this.$route.query.req_place,this.apply_id=this.$route.query.apply_id,this.getAccountList(),this.getApprovalQY()},methods:{getApprovalQY:function(){var e=this;this.$api.getApprovalQY({approval_type:"023"}).then(function(t){e.use_up=t.data.use_up})},getAccountList:function(e){var t=this;e?this.$api.getAccountList({deleted:0}).then(function(e){t.userList=e.data}):this.$api.getAccountList({all:""}).then(function(e){t.userList=e.data})},addOrEditRisk:function(){var e=this;this.$refs.form.validate(function(t){if(e.flag)e.handleClose();else if(t){if(e.risk.use_up=e.use_up,e.risk.req_place=e.req_place,e.risk.apply_id=e.apply_id,e.risk.approval_type="023",1===e.risk.status&&(null===e.risk.risk_photo||void 0===e.risk.risk_photo||e.risk.risk_photo.length<=0))return void e.$message.error("整改图片必需上传");e.$api.addOrEditRisk(e.risk).then(function(){e.$message.success("整改成功"),e.$router.push({path:"/approvalApply",name:"我的申请",query:{}})})}})},handleClose:function(){this.visible=!1,this.risk={},this.fileList=[],this.flag=!1},handleRemove:function(e,t){var a=this;this.form.risk_photo="",t.map(function(e){a.form.risk_photo+="'"+e.response.data[0].id+"',"}),this.form.risk_photo=this.form.risk_photo.substr(0,this.form.risk_photo.length-1),console.log(this.form.risk_photo)},handlePictureCardPreview:function(e){this.dialogImageUrl=e.url,this.dialogVisible=!0},uploadReturn:function(e,t,a){var r=this;console.log(t),this.risk.risk_photo="",a.map(function(e){r.risk.risk_photo+="'"+e.response.data[0].id+"',"}),this.risk.risk_photo=this.risk.risk_photo.substr(0,this.risk.risk_photo.length-1),console.log(this.risk.risk_photo)},beforeAvatarUpload:function(e){return"image/png"===e.type||"image/jpg"===e.type||"image/jpeg"===e.type||(this.$message.error("不支持png、jpg、jpeg以外格式的图片"),!1)}}}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-descriptions",{attrs:{title:"风险信息"}},[a("el-descriptions-item",{attrs:{label:"工单流水号"}},[e._v(e._s(e.risk.id))]),e._v(" "),a("el-descriptions-item",{attrs:{label:"项目名称"}},[e._v(e._s(e.risk.project_name))]),e._v(" "),a("el-descriptions-item",{attrs:{label:"分行名称"}},[e._v(e._s(e.risk.porgid))]),e._v(" "),a("el-descriptions-item",{attrs:{label:"支行名称"}},[e._v(e._s(e.risk.branch_id))]),e._v(" "),a("el-descriptions-item",{attrs:{label:"整改机构或站点"}},[e._v(e._s(e.risk.site_no))]),e._v(" "),a("el-descriptions-item",{attrs:{label:"整改要求"}},[e._v(e._s(e.risk.requirement))]),e._v(" "),a("el-descriptions-item",{attrs:{label:"问题描述"}},[e._v(e._s(e.risk.content_text))]),e._v(" "),a("el-descriptions-item",{attrs:{label:"风险等级"}},[e._v(e._s(e.risk.risk_level))]),e._v(" "),a("el-descriptions-item",{attrs:{label:"问题发现日期"}},[e._v(e._s(e.risk.created))]),e._v(" "),a("el-descriptions-item",{attrs:{label:"问题发现人"}},[e._v(e._s(e.risk.discoverer))]),e._v(" "),a("el-descriptions-item",{attrs:{label:"整改预计完成日期"}},[e._v(e._s(e.risk.end_date))]),e._v(" "),a("el-descriptions-item",{attrs:{label:"问题整改人"}},[e._v(e._s(e.risk.name))])],1),e._v(" "),a("el-divider"),e._v(" "),a("el-form",{ref:"form",attrs:{model:e.risk,rules:e.rules,"label-width":"90px",disabled:e.check}},[a("el-row",[a("el-col",{attrs:{span:7}},[a("el-form-item",{attrs:{prop:"schedule",label:"整改完成情况"}},[a("el-input",{attrs:{type:"textarea",size:"small",label:"整改完成情况"},model:{value:e.risk.schedule,callback:function(t){e.$set(e.risk,"schedule",t)},expression:"risk.schedule"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:8}},[a("el-form-item",{staticStyle:{width:"360px"},attrs:{prop:"written",label:"反馈人姓名",disabled:"true"}},[a("el-select",{staticStyle:{width:"150px"},attrs:{filterable:"",clearable:""},nativeOn:{click:function(t){return e.getAccountList(!0)}},model:{value:e.risk.written,callback:function(t){e.$set(e.risk,"written",t)},expression:"risk.written"}},e._l(e.userList,function(t){return a("el-option",{key:t.account_id,attrs:{label:t.name,value:t.account_id}},[a("span",[e._v(e._s(t.name)+"("+e._s(t.account_id)+")")])])}),1)],1)],1),e._v(" "),a("el-col",{attrs:{span:8}},[a("el-form-item",{staticStyle:{width:"360px"},attrs:{prop:"status",label:"整改状态"}},[a("el-select",{staticStyle:{width:"150px"},model:{value:e.risk.status,callback:function(t){e.$set(e.risk,"status",t)},expression:"risk.status"}},e._l(e.items,function(e){return a("el-option",{key:e.label,attrs:{label:e.label,value:e.value}})}),1)],1)],1)],1),e._v(" "),a("el-row",[a("el-col",[a("el-form-item",{attrs:{label:"整改证明",prop:"risk_photo"}},[a("el-upload",{ref:"upload",class:{disUoloadSty:e.check},attrs:{action:"/hnm/txCtrl?txcode=upload001","list-type":"picture-card","before-upload":e.beforeAvatarUpload,"file-list":e.fileList,data:{business:"risk",name:"123"},headers:{Accept:"application/json"},"on-success":e.uploadReturn,"on-preview":e.handlePictureCardPreview,"on-remove":e.handleRemove,limit:10}},[a("i",{staticClass:"el-icon-plus"})]),e._v(" "),a("el-dialog",{attrs:{visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("img",{attrs:{width:"100%",src:e.dialogImageUrl,alt:""}})])],1)],1)],1)],1),e._v(" "),e.check?e._e():a("div",{staticStyle:{"text-align":"center"},attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:e.handleClose}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.addOrEditRisk}},[e._v("确 定\n    ")])],1)],1)},staticRenderFns:[]}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-steps",{attrs:{space:200}},e._l(e.approvalStepList,function(e,t){return a("el-step",{key:e.role_id+t,attrs:{title:e.role_name+":"+e.approval_user_name,status:e.status}})}),1),e._v(" "),a("el-collapse",{on:{change:e.handleChange},model:{value:e.activeNames,callback:function(t){e.activeNames=t},expression:"activeNames"}},[a("el-collapse-item",{attrs:{title:"审批历史(点击展开)",name:"approvalHis"}},[a("approval-his")],1),e._v(" "),e.approval_type==e.type003||e.approval_type==e.type005||e.approval_type==e.type006||e.approval_type==e.type007||e.approval_type==e.type008||e.approval_type==e.type010||e.approval_type==e.type011||e.approval_type==e.type012||e.approval_type==e.type013||e.approval_type==e.type014||e.approval_type==e.type015||e.approval_type==e.type016||e.approval_type==e.type017||e.approval_type==e.type018||e.approval_type==e.type019?a("el-collapse-item",{attrs:{title:"修改信息(点击展开)",name:"updateInfo"}},[a("div",[a("label",{staticStyle:{color:"red"}},[e._v(e._s(this.approvalApplyDetail.update_items))])])]):e._e(),e._v(" "),a("el-collapse-item",{attrs:{title:"申请详情(点击展开)",name:"baseInfo"}},[e.approval_type==e.type002||e.approval_type==e.type003||e.approval_type==e.type014||e.approval_type==e.type015||e.approval_type==e.type021?a("base-info-staff"):e._e(),e._v(" "),e.approval_type==e.type004||e.approval_type==e.type005||e.approval_type==e.type006||e.approval_type==e.type007||e.approval_type==e.type008||e.approval_type==e.type016||e.approval_type==e.type017||e.approval_type==e.type018||e.approval_type==e.type019||e.approval_type==e.type022?a("base-info-site"):e._e(),e._v(" "),e.approval_type==e.type009||e.approval_type==e.type010||e.approval_type==e.type011||e.approval_type==e.type012||e.approval_type==e.type013||e.approval_type==e.type020?a("base-info-team"):e._e(),e._v(" "),e.approval_type==e.type023?a("base-info-risk"):e._e()],1)],1)],1)},staticRenderFns:[]}},function(e,t,a){var r=a(3)(a(821),a(822),null,null);e.exports=r.exports},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(6),i=a.n(r),o=a(5),l=a.n(o),s=a(10),n=a.n(s);t.default={components:{baseTable:l.a,basePage:n.a},name:"approval",data:function(){return{activeName:"approval1",role:sessionStorage.getItem("role"),form:{},dataList:[{label:"申请编号",prop:"apply_id",sort:!0},{label:"申请人编号",prop:"operator"},{label:"申请人姓名",prop:"name"},{label:"申请人机构",prop:"branch_name"},{label:"审批类型",prop:"approval_type_name"},{label:"审批项目",prop:"message"},{label:"审批状态",prop:"approval_status_name"},{label:"申请时间",prop:"create_time",sort:!0}],approvalTypeList:[],approvalStatusList:[],approvalList:[],pageNum:1,pageSize:10,total:0,visible:!1}},mounted:function(){this.getApprovalTypeList(),this.getApprovalStatusList()},watch:{visible:function(e){e||(this.form={})}},methods:{handleClick:function(e,t){console.log(e,t),this.form={},this.approvalList=[],this.pageNum=1,this.pageSize=10,this.total=0,this.visible=!1,this.getApprovalList()},getApprovalTypeList:function(){var e=this;0==this.approvalTypeList.length&&this.$api.getApprovalTypeByEnum().then(function(t){e.approvalTypeList=t.data})},getApprovalStatusList:function(){var e=this;0==this.approvalStatusList.length&&this.$api.getApprovalStatusByEnum().then(function(t){e.approvalStatusList=t.data})},getApprovalList:function(){var e=this;"approval1"==this.activeName?this.$api.getApproval1List(i()({page:this.pageNum-1,number:this.pageSize},this.form)).then(function(t){e.approvalList=t.data.approvalList,e.total=t.data.total}):this.$api.getApproval2List(i()({page:this.pageNum-1,number:this.pageSize},this.form)).then(function(t){e.approvalList=t.data.approvalList,e.total=t.data.total})},showApproval:function(e,t,a,r){this.$router.push({path:"/approvalDetail",name:"审批信息",query:{id:a,role:this.role,check:!0,apply_id:e,approval_type:t,next_role:r,activeName:this.activeName,req_place:"2"},params:{searchKey:this.form}})},changeSize:function(e){this.pageSize=e,this.getApprovalList()},changePage:function(e){this.pageNum=e,this.getApprovalList()}},beforeRouteEnter:function(e,t,a){a(function(t){e.params.searchKey&&(t.form=e.params.searchKey),t.getApprovalList()})}}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-tabs",{on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"待审批列表",name:"approval1"}},[a("div",[a("el-form",{staticStyle:{"margin-top":"15px"},attrs:{inline:!0,model:e.form}},[a("el-form-item",{attrs:{label:"申请日期",prop:"start_date"}},[a("el-date-picker",{staticStyle:{width:"200px"},attrs:{type:"date","value-format":"yyyy-MM-dd",clearable:"",placeholder:"选择日期"},model:{value:e.form.start_date,callback:function(t){e.$set(e.form,"start_date",t)},expression:"form.start_date"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"——",prop:"end_date"}},[a("el-date-picker",{staticStyle:{width:"200px"},attrs:{type:"date","value-format":"yyyy-MM-dd",clearable:"",placeholder:"选择日期"},model:{value:e.form.end_date,callback:function(t){e.$set(e.form,"end_date",t)},expression:"form.end_date"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"申请编号"}},[a("el-input",{attrs:{clearable:"",placeholder:"请输入申请编号",size:"small"},model:{value:e.form.apply_id,callback:function(t){e.$set(e.form,"apply_id",t)},expression:"form.apply_id"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"申请人编号"}},[a("el-input",{attrs:{clearable:"",placeholder:"请输入申请人编号",size:"small"},model:{value:e.form.operator,callback:function(t){e.$set(e.form,"operator",t)},expression:"form.operator"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"审批类型",prop:"approval_type"}},[a("el-select",{attrs:{clearable:"",size:"small"},model:{value:e.form.approval_type,callback:function(t){e.$set(e.form,"approval_type",t)},expression:"form.approval_type"}},e._l(e.approvalTypeList,function(e){return a("el-option",{key:e.approvalType,attrs:{label:e.approvalTypeName,value:e.approvalType}})}),1)],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-search"},on:{click:e.getApprovalList}},[e._v("搜索\n                    ")])],1)],1),e._v(" "),a("base-table",{attrs:{list:e.dataList,data:e.approvalList}},[a("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",icon:"el-icon-edit-outline"},on:{click:function(a){return e.showApproval(t.row.apply_id,t.row.approval_type,t.row.relation_id,t.row.next_role)}}},[e._v("查看\n                        ")])]}}])})],1),e._v(" "),a("base-page",{attrs:{page:e.pageNum,size:e.pageSize,total:e.total},on:{size:e.changeSize,page:e.changePage}})],1)]),e._v(" "),a("el-tab-pane",{attrs:{label:"已审批列表",name:"approval2"}},[a("div",[a("el-form",{staticStyle:{"margin-top":"15px"},attrs:{inline:!0,model:e.form}},[a("el-form-item",{attrs:{label:"申请日期",prop:"start_date"}},[a("el-date-picker",{staticStyle:{width:"200px"},attrs:{type:"date","value-format":"yyyy-MM-dd",clearable:"",placeholder:"选择日期"},model:{value:e.form.start_date,callback:function(t){e.$set(e.form,"start_date",t)},expression:"form.start_date"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"——",prop:"end_date"}},[a("el-date-picker",{staticStyle:{width:"200px"},attrs:{type:"date","value-format":"yyyy-MM-dd",clearable:"",placeholder:"选择日期"},model:{value:e.form.end_date,callback:function(t){e.$set(e.form,"end_date",t)},expression:"form.end_date"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"申请编号"}},[a("el-input",{attrs:{clearable:"",placeholder:"请输入申请编号",size:"small"},model:{value:e.form.apply_id,callback:function(t){e.$set(e.form,"apply_id",t)},expression:"form.apply_id"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"申请人编号"}},[a("el-input",{attrs:{clearable:"",placeholder:"请输入申请人编号",size:"small"},model:{value:e.form.operator,callback:function(t){e.$set(e.form,"operator",t)},expression:"form.operator"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"审批类型",prop:"approval_type"}},[a("el-select",{attrs:{clearable:"",size:"small"},model:{value:e.form.approval_type,callback:function(t){e.$set(e.form,"approval_type",t)},expression:"form.approval_type"}},e._l(e.approvalTypeList,function(e){return a("el-option",{key:e.approvalType,attrs:{label:e.approvalTypeName,value:e.approvalType}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"审批状态",prop:"approval_status"}},[a("el-select",{attrs:{clearable:"",size:"small"},model:{value:e.form.approval_status,callback:function(t){e.$set(e.form,"approval_status",t)},expression:"form.approval_status"}},e._l(e.approvalStatusList,function(e){return a("el-option",{key:e.approvalStatus,attrs:{label:e.approvalStatusName,value:e.approvalStatus}})}),1)],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-search"},on:{click:e.getApprovalList}},[e._v("搜索\n                    ")])],1)],1),e._v(" "),a("base-table",{attrs:{list:e.dataList,data:e.approvalList}},[a("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",icon:"el-icon-edit-outline"},on:{click:function(a){return e.showApproval(t.row.apply_id,t.row.approval_type,t.row.relation_id,t.row.next_role)}}},[e._v("查看\n                        ")])]}}])})],1),e._v(" "),a("base-page",{attrs:{page:e.pageNum,size:e.pageSize,total:e.total},on:{size:e.changeSize,page:e.changePage}})],1)])],1)},staticRenderFns:[]}},function(e,t,a){var r=a(3)(a(824),a(825),null,null);e.exports=r.exports},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(6),i=a.n(r),o=a(90),l=a.n(o),s=a(91),n=a.n(s),p=a(79),c=a.n(p),u=a(118),d=a.n(u),m=a(119),f=a.n(m);t.default={components:{baseInfoRisk:f.a,baseInfoStaff:l.a,baseInfoSite:n.a,baseInfoTeam:c.a,approvalHis:d.a},name:"approvalDetail",data:function(){return{form:{},rules:{approval_opinion:[{required:!0,message:"请选择审批意见",trigger:"blur"}],approval_desc:[{required:!0,message:"请输入审批意见描述",trigger:"blur"}]},user:{},activeNames:["baseInfo"],approval_type:this.$route.query.approval_type,apply_id:this.$route.query.apply_id,activeName:this.$route.query.activeName,next_role:this.$route.query.next_role,relation_id:this.$route.query.id,visible:!1,accountList:[],upaccountList:[],gtaccountList:[],approvalApplyDetail:{},type002:this.$loacalData.code_GetEnums(this.$loacalData.listApprovalType,"002").code,type003:this.$loacalData.code_GetEnums(this.$loacalData.listApprovalType,"003").code,type004:this.$loacalData.code_GetEnums(this.$loacalData.listApprovalType,"004").code,type005:this.$loacalData.code_GetEnums(this.$loacalData.listApprovalType,"005").code,type006:this.$loacalData.code_GetEnums(this.$loacalData.listApprovalType,"006").code,type007:this.$loacalData.code_GetEnums(this.$loacalData.listApprovalType,"007").code,type008:this.$loacalData.code_GetEnums(this.$loacalData.listApprovalType,"008").code,type009:this.$loacalData.code_GetEnums(this.$loacalData.listApprovalType,"009").code,type010:this.$loacalData.code_GetEnums(this.$loacalData.listApprovalType,"010").code,type011:this.$loacalData.code_GetEnums(this.$loacalData.listApprovalType,"011").code,type012:this.$loacalData.code_GetEnums(this.$loacalData.listApprovalType,"012").code,type013:this.$loacalData.code_GetEnums(this.$loacalData.listApprovalType,"013").code,type014:this.$loacalData.code_GetEnums(this.$loacalData.listApprovalType,"014").code,type015:this.$loacalData.code_GetEnums(this.$loacalData.listApprovalType,"015").code,type016:this.$loacalData.code_GetEnums(this.$loacalData.listApprovalType,"016").code,type017:this.$loacalData.code_GetEnums(this.$loacalData.listApprovalType,"017").code,type018:this.$loacalData.code_GetEnums(this.$loacalData.listApprovalType,"018").code,type019:this.$loacalData.code_GetEnums(this.$loacalData.listApprovalType,"019").code,type020:this.$loacalData.code_GetEnums(this.$loacalData.listApprovalType,"020").code,type021:this.$loacalData.code_GetEnums(this.$loacalData.listApprovalType,"021").code,type022:this.$loacalData.code_GetEnums(this.$loacalData.listApprovalType,"022").code,type023:this.$loacalData.code_GetEnums(this.$loacalData.listApprovalType,"023").code}},mounted:function(){this.getApprovalAccountList(),this.getApprovalUpAccountList(),this.getAllAccountList(),this.getUpdateInfo(),this.user=JSON.parse(sessionStorage.getItem("user"))},watch:{visible:function(e){e||(this.form={})}},methods:{getUpdateInfo:function(){var e=this;this.$api.getUpdateInfo({apply_id:this.apply_id}).then(function(t){e.approvalApplyDetail=t.data})},cleanApprovalUser:function(){"2"!=this.form.approval_opinion&&"3"!=this.form.approval_opinion&&"4"!=this.form.approval_opinion&&"5"!=this.form.approval_opinion||this.$set(this.form,"approval_user",null),"1"!=this.form.approval_opinion&&"2"!=this.form.approval_opinion&&"4"!=this.form.approval_opinion&&"5"!=this.form.approval_opinion||this.$set(this.form,"up_approval_user",null),"1"!=this.form.approval_opinion&&"2"!=this.form.approval_opinion&&"3"!=this.form.approval_opinion&&"4"!=this.form.approval_opinion||this.$set(this.form,"gt_approval_user",null)},handleChange:function(e){console.log(e)},handleClose:function(){this.visible=!1,this.form={}},getApprovalAccountList:function(){var e=this;this.$api.getApprovalAccountList2({apply_id:this.apply_id}).then(function(t){e.accountList=t.data,1==t.data.length&&e.$set(e.form,"approval_user",t.data[0].account_id)})},getApprovalUpAccountList:function(){var e=this;this.$api.getApprovalUpAccountList({apply_id:this.apply_id}).then(function(t){e.upaccountList=t.data;for(var a=0;a<e.upaccountList.length;a++)e.upaccountList[a].account_id===e.user.account_id&&e.upaccountList.splice(a,1);1==t.data.length&&e.$set(e.form,"up_approval_user",t.data[0].account_id)})},getAllAccountList:function(){var e=this;this.$api.getAllAccountList({}).then(function(t){e.gtaccountList=t.data;for(var a=0;a<e.gtaccountList.length;a++)e.gtaccountList[a].account_id===e.user.account_id&&e.gtaccountList.splice(a,1);1==t.data.length&&e.$set(e.form,"gt_approval_user",t.data[0].account_id)})},submitApproval:function(){var e=this;this.$refs.form.validate(function(t){if(t){if("1"==e.form.approval_opinion&&e.next_role&&!e.form.approval_user)return void e.$message.error("请选择下一审批人");if("3"==e.form.approval_opinion&&!e.form.up_approval_user)return void e.$message.error("请选择转办人");if("5"==e.form.approval_opinion&&(!e.form.gt_approval_user||""==e.form.gt_approval_user))return void e.$message.error("请选择沟通人");e.$api.submitApproval(i()({apply_id:e.apply_id,relation_id:e.relation_id},e.form)).then(function(t){e.$router.back(-1)})}})}}}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",["approval1"==e.activeName?a("el-button",{staticStyle:{"margin-bottom":"10px"},attrs:{type:"primary",size:"small"},on:{click:function(t){e.visible=!0}}},[e._v("提交审批\n  ")]):e._e(),e._v(" "),a("el-collapse",{on:{change:e.handleChange},model:{value:e.activeNames,callback:function(t){e.activeNames=t},expression:"activeNames"}},[a("el-collapse-item",{attrs:{title:"审批历史(点击展开)",name:"approvalHis"}},[a("approval-his")],1),e._v(" "),e.approval_type==e.type003||e.approval_type==e.type005||e.approval_type==e.type006||e.approval_type==e.type007||e.approval_type==e.type008||e.approval_type==e.type010||e.approval_type==e.type011||e.approval_type==e.type012||e.approval_type==e.type013||e.approval_type==e.type014||e.approval_type==e.type015||e.approval_type==e.type016||e.approval_type==e.type017||e.approval_type==e.type018||e.approval_type==e.type019?a("el-collapse-item",{attrs:{title:"修改信息(点击展开)",name:"updateInfo"}},[a("div",[a("label",{staticStyle:{color:"red"}},[e._v(e._s(this.approvalApplyDetail.update_items))])])]):e._e(),e._v(" "),a("el-collapse-item",{attrs:{title:"申请详情(点击展开)",name:"baseInfo"}},[e.approval_type==e.type002||e.approval_type==e.type003||e.approval_type==e.type014||e.approval_type==e.type015||e.approval_type==e.type021?a("base-info-staff"):e._e(),e._v(" "),e.approval_type==e.type004||e.approval_type==e.type005||e.approval_type==e.type006||e.approval_type==e.type007||e.approval_type==e.type008||e.approval_type==e.type016||e.approval_type==e.type017||e.approval_type==e.type018||e.approval_type==e.type019||e.approval_type==e.type022?a("base-info-site"):e._e(),e._v(" "),e.approval_type==e.type009||e.approval_type==e.type010||e.approval_type==e.type011||e.approval_type==e.type012||e.approval_type==e.type013||e.approval_type==e.type020?a("base-info-team"):e._e(),e._v(" "),e.approval_type==e.type023?a("base-info-risk"):e._e()],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"提交审批",visible:e.visible,width:"45%","before-close":e.handleClose},on:{"update:visible":function(t){e.visible=t}}},[a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"90px"}},[a("el-form-item",{attrs:{label:"审批意见",prop:"approval_opinion"}},[a("el-select",{on:{change:e.cleanApprovalUser},model:{value:e.form.approval_opinion,callback:function(t){e.$set(e.form,"approval_opinion",t)},expression:"form.approval_opinion"}},[a("el-option",{key:"1",attrs:{label:"通过",value:"1"}},[e._v("通过")]),e._v(" "),a("el-option",{key:"2",attrs:{label:"不通过",value:"2"}},[e._v("不通过")]),e._v(" "),a("el-option",{key:"3",attrs:{label:"转办",value:"3"}},[e._v("转办")]),e._v(" "),a("el-option",{key:"4",attrs:{label:"驳回",value:"4"}},[e._v("驳回")]),e._v(" "),a("el-option",{key:"5",attrs:{label:"沟通",value:"5"}},[e._v("沟通")])],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"审批意见描述",prop:"approval_desc"}},[a("el-input",{attrs:{type:"textarea",maxlength:"300","show-word-limit":"",autosize:{minRows:2,maxRows:4},placeholder:"请输入内容，最多300字"},model:{value:e.form.approval_desc,callback:function(t){e.$set(e.form,"approval_desc",t)},expression:"form.approval_desc"}})],1),e._v(" "),"1"==e.form.approval_opinion&&e.next_role?a("el-form-item",{attrs:{label:"下一审批人",prop:"approval_user"}},[a("el-select",{attrs:{clearable:"",filterable:""},model:{value:e.form.approval_user,callback:function(t){e.$set(e.form,"approval_user",t)},expression:"form.approval_user"}},e._l(e.accountList,function(e){return a("el-option",{key:e.account_id,attrs:{label:e.approval_name,value:e.account_id}})}),1)],1):e._e(),e._v(" "),"3"==e.form.approval_opinion?a("el-form-item",{attrs:{label:"转办人",prop:"up_approval_user"}},[a("el-select",{attrs:{clearable:"",filterable:""},model:{value:e.form.up_approval_user,callback:function(t){e.$set(e.form,"up_approval_user",t)},expression:"form.up_approval_user"}},e._l(e.upaccountList,function(e){return a("el-option",{key:e.account_id,attrs:{label:e.approval_name,value:e.account_id}})}),1)],1):e._e(),e._v(" "),"5"==e.form.approval_opinion?a("el-form-item",{attrs:{label:"沟通人",prop:"gt_approval_user"}},[a("el-select",{attrs:{clearable:"",filterable:"",multiple:!0},model:{value:e.form.gt_approval_user,callback:function(t){e.$set(e.form,"gt_approval_user",t)},expression:"form.gt_approval_user"}},e._l(e.gtaccountList,function(e){return a("el-option",{key:e.account_id,attrs:{label:e.account_id+"-"+e.name,value:e.account_id}})}),1)],1):e._e()],1),e._v(" "),a("div",{staticStyle:{"text-align":"center"},attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:e.handleClose}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.submitApproval}},[e._v("确 定\n      ")])],1)],1)],1)},staticRenderFns:[]}},function(e,t,a){var r=a(3)(a(827),a(828),null,null);e.exports=r.exports},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(6),i=a.n(r),o=a(5),l=a.n(o),s=a(10),n=a.n(s);t.default={components:{baseTable:l.a,basePage:n.a},name:"approvalConnect",data:function(){return{activeName:"approvalConnect1",role:sessionStorage.getItem("role"),form:{},dataList:[{label:"申请编号",prop:"apply_id",sort:!0},{label:"申请人编号",prop:"operator"},{label:"申请人姓名",prop:"name"},{label:"审批人编号",prop:"approval_user"},{label:"审批人姓名",prop:"approval_user_name"},{label:"申请人机构",prop:"branch_name"},{label:"审批类型",prop:"approval_type_name"},{label:"审批项目",prop:"message"},{label:"申请时间",prop:"create_time",sort:!0}],approvalTypeList:[],approvalConnectList:[],pageNum:1,pageSize:10,total:0,visible:!1}},mounted:function(){this.getApprovalTypeList()},watch:{visible:function(e){e||(this.form={})}},methods:{handleClick:function(e,t){console.log(e,t),this.form={},this.approvalConnectList=[],this.pageNum=1,this.pageSize=10,this.total=0,this.visible=!1,this.getApprovalConnectList()},getApprovalTypeList:function(){var e=this;0==this.approvalTypeList.length&&this.$api.getApprovalTypeByEnum().then(function(t){e.approvalTypeList=t.data})},getApprovalConnectList:function(){var e=this;"approvalConnect1"==this.activeName?this.$api.getApprovalConnect1List(i()({page:this.pageNum-1,number:this.pageSize},this.form)).then(function(t){e.approvalConnectList=t.data.approvalConnectList,e.total=t.data.total}):this.$api.getApprovalConnect2List(i()({page:this.pageNum-1,number:this.pageSize},this.form)).then(function(t){e.approvalConnectList=t.data.approvalConnectList,e.total=t.data.total})},showApprovalConnect:function(e,t,a){this.$router.push({path:"/approvalConnectDetail",name:"沟通信息",query:{id:a,role:this.role,check:!0,apply_id:e,approval_type:t,activeName:this.activeName,req_place:"3"},params:{searchKey:this.form}})},changeSize:function(e){this.pageSize=e,this.getApprovalConnectList()},changePage:function(e){this.pageNum=e,this.getApprovalConnectList()}},beforeRouteEnter:function(e,t,a){a(function(t){e.params.searchKey&&(t.form=e.params.searchKey),t.getApprovalConnectList()})}}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-tabs",{on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"待沟通列表",name:"approvalConnect1"}},[a("div",[a("el-form",{staticStyle:{"margin-top":"15px"},attrs:{inline:!0,model:e.form}},[a("el-form-item",{attrs:{label:"申请日期",prop:"start_date"}},[a("el-date-picker",{staticStyle:{width:"200px"},attrs:{type:"date","value-format":"yyyy-MM-dd",clearable:"",placeholder:"选择日期"},model:{value:e.form.start_date,callback:function(t){e.$set(e.form,"start_date",t)},expression:"form.start_date"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"——",prop:"end_date"}},[a("el-date-picker",{staticStyle:{width:"200px"},attrs:{type:"date","value-format":"yyyy-MM-dd",clearable:"",placeholder:"选择日期"},model:{value:e.form.end_date,callback:function(t){e.$set(e.form,"end_date",t)},expression:"form.end_date"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"申请编号"}},[a("el-input",{attrs:{clearable:"",placeholder:"请输入申请编号",size:"small"},model:{value:e.form.apply_id,callback:function(t){e.$set(e.form,"apply_id",t)},expression:"form.apply_id"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"申请人编号"}},[a("el-input",{attrs:{clearable:"",placeholder:"请输入申请人编号",size:"small"},model:{value:e.form.operator,callback:function(t){e.$set(e.form,"operator",t)},expression:"form.operator"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"审批人编号"}},[a("el-input",{attrs:{clearable:"",placeholder:"请输入审批人编号",size:"small"},model:{value:e.form.approval_user,callback:function(t){e.$set(e.form,"approval_user",t)},expression:"form.approval_user"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"审批类型",prop:"approval_type"}},[a("el-select",{attrs:{clearable:"",size:"small"},model:{value:e.form.approval_type,callback:function(t){e.$set(e.form,"approval_type",t)},expression:"form.approval_type"}},e._l(e.approvalTypeList,function(e){return a("el-option",{key:e.approvalType,attrs:{label:e.approvalTypeName,value:e.approvalType}})}),1)],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-search"},on:{click:e.getApprovalConnectList}},[e._v("搜索\n                    ")])],1)],1),e._v(" "),a("base-table",{attrs:{list:e.dataList,data:e.approvalConnectList}},[a("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",icon:"el-icon-edit-outline"},on:{click:function(a){return e.showApprovalConnect(t.row.apply_id,t.row.approval_type,t.row.relation_id)}}},[e._v("查看\n                        ")])]}}])})],1),e._v(" "),a("base-page",{attrs:{page:e.pageNum,size:e.pageSize,total:e.total},on:{size:e.changeSize,page:e.changePage}})],1)]),e._v(" "),a("el-tab-pane",{attrs:{label:"已沟通列表",name:"approvalConnect2"}},[a("div",[a("el-form",{staticStyle:{"margin-top":"15px"},attrs:{inline:!0,model:e.form}},[a("el-form-item",{attrs:{label:"申请日期",prop:"start_date"}},[a("el-date-picker",{staticStyle:{width:"200px"},attrs:{type:"date","value-format":"yyyy-MM-dd",clearable:"",placeholder:"选择日期"},model:{value:e.form.start_date,callback:function(t){e.$set(e.form,"start_date",t)},expression:"form.start_date"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"——",prop:"end_date"}},[a("el-date-picker",{staticStyle:{width:"200px"},attrs:{type:"date","value-format":"yyyy-MM-dd",clearable:"",placeholder:"选择日期"},model:{value:e.form.end_date,callback:function(t){e.$set(e.form,"end_date",t)},expression:"form.end_date"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"申请编号"}},[a("el-input",{attrs:{clearable:"",placeholder:"请输入申请编号",size:"small"},model:{value:e.form.apply_id,callback:function(t){e.$set(e.form,"apply_id",t)},expression:"form.apply_id"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"申请人编号"}},[a("el-input",{attrs:{clearable:"",placeholder:"请输入申请人编号",size:"small"},model:{value:e.form.operator,callback:function(t){e.$set(e.form,"operator",t)},expression:"form.operator"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"审批人编号"}},[a("el-input",{attrs:{clearable:"",placeholder:"请输入审批人编号",size:"small"},model:{value:e.form.approval_user,callback:function(t){e.$set(e.form,"approval_user",t)},expression:"form.approval_user"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"审批类型",prop:"approval_type"}},[a("el-select",{attrs:{clearable:"",size:"small"},model:{value:e.form.approval_type,callback:function(t){e.$set(e.form,"approval_type",t)},expression:"form.approval_type"}},e._l(e.approvalTypeList,function(e){return a("el-option",{key:e.approvalType,attrs:{label:e.approvalTypeName,value:e.approvalType}})}),1)],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-search"},on:{click:e.getApprovalConnectList}},[e._v("搜索\n                    ")])],1)],1),e._v(" "),a("base-table",{attrs:{list:e.dataList,data:e.approvalConnectList}},[a("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",icon:"el-icon-edit-outline"},on:{click:function(a){return e.showApprovalConnect(t.row.apply_id,t.row.approval_type,t.row.relation_id)}}},[e._v("查看\n                        ")])]}}])})],1),e._v(" "),a("base-page",{attrs:{page:e.pageNum,size:e.pageSize,total:e.total},on:{size:e.changeSize,page:e.changePage}})],1)])],1)},staticRenderFns:[]}},function(e,t,a){var r=a(3)(a(830),a(831),null,null);e.exports=r.exports},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(6),i=a.n(r),o=a(90),l=a.n(o),s=a(91),n=a.n(s),p=a(79),c=a.n(p),u=a(118),d=a.n(u),m=a(119),f=a.n(m);t.default={components:{baseInfoStaff:l.a,baseInfoSite:n.a,baseInfoTeam:c.a,approvalHis:d.a,baseInfoRisk:f.a},name:"approvalConnectDetail",data:function(){return{form:{},rules:{approval_desc:[{required:!0,message:"请输入沟通意见",trigger:"blur"}]},activeNames:["baseInfo"],approval_type:this.$route.query.approval_type,apply_id:this.$route.query.apply_id,activeName:this.$route.query.activeName,relation_id:this.$route.query.id,visible:!1,approvalApplyDetail:{},type002:this.$loacalData.code_GetEnums(this.$loacalData.listApprovalType,"002").code,type003:this.$loacalData.code_GetEnums(this.$loacalData.listApprovalType,"003").code,type004:this.$loacalData.code_GetEnums(this.$loacalData.listApprovalType,"004").code,type005:this.$loacalData.code_GetEnums(this.$loacalData.listApprovalType,"005").code,type006:this.$loacalData.code_GetEnums(this.$loacalData.listApprovalType,"006").code,type007:this.$loacalData.code_GetEnums(this.$loacalData.listApprovalType,"007").code,type008:this.$loacalData.code_GetEnums(this.$loacalData.listApprovalType,"008").code,type009:this.$loacalData.code_GetEnums(this.$loacalData.listApprovalType,"009").code,type010:this.$loacalData.code_GetEnums(this.$loacalData.listApprovalType,"010").code,type011:this.$loacalData.code_GetEnums(this.$loacalData.listApprovalType,"011").code,type012:this.$loacalData.code_GetEnums(this.$loacalData.listApprovalType,"012").code,type013:this.$loacalData.code_GetEnums(this.$loacalData.listApprovalType,"013").code,type014:this.$loacalData.code_GetEnums(this.$loacalData.listApprovalType,"014").code,type015:this.$loacalData.code_GetEnums(this.$loacalData.listApprovalType,"015").code,type016:this.$loacalData.code_GetEnums(this.$loacalData.listApprovalType,"016").code,type017:this.$loacalData.code_GetEnums(this.$loacalData.listApprovalType,"017").code,type018:this.$loacalData.code_GetEnums(this.$loacalData.listApprovalType,"018").code,type019:this.$loacalData.code_GetEnums(this.$loacalData.listApprovalType,"019").code,type020:this.$loacalData.code_GetEnums(this.$loacalData.listApprovalType,"020").code,type021:this.$loacalData.code_GetEnums(this.$loacalData.listApprovalType,"021").code,type022:this.$loacalData.code_GetEnums(this.$loacalData.listApprovalType,"022").code,type023:this.$loacalData.code_GetEnums(this.$loacalData.listApprovalType,"023").code}},mounted:function(){this.getUpdateInfo()},watch:{visible:function(e){e||(this.form={})}},methods:{getUpdateInfo:function(){var e=this;this.$api.getUpdateInfo({apply_id:this.apply_id}).then(function(t){e.approvalApplyDetail=t.data})},handleChange:function(e){console.log(e)},handleClose:function(){this.visible=!1,this.form={}},submitApprovalConnect:function(){var e=this;this.$refs.form.validate(function(t){t&&e.$api.submitApprovalConnect(i()({apply_id:e.apply_id,relation_id:e.relation_id},e.form)).then(function(t){e.$router.back(-1)})})}}}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",["approvalConnect1"==e.activeName?a("el-button",{staticStyle:{"margin-bottom":"10px"},attrs:{type:"primary",size:"small"},on:{click:function(t){e.visible=!0}}},[e._v("提交沟通\n    ")]):e._e(),e._v(" "),a("el-collapse",{on:{change:e.handleChange},model:{value:e.activeNames,callback:function(t){e.activeNames=t},expression:"activeNames"}},[a("el-collapse-item",{attrs:{title:"审批历史(点击展开)",name:"approvalHis"}},[a("approval-his")],1),e._v(" "),e.approval_type==e.type003||e.approval_type==e.type005||e.approval_type==e.type006||e.approval_type==e.type007||e.approval_type==e.type008||e.approval_type==e.type010||e.approval_type==e.type011||e.approval_type==e.type012||e.approval_type==e.type013||e.approval_type==e.type014||e.approval_type==e.type015||e.approval_type==e.type016||e.approval_type==e.type017||e.approval_type==e.type018||e.approval_type==e.type019?a("el-collapse-item",{attrs:{title:"修改信息(点击展开)",name:"updateInfo"}},[a("div",[a("label",{staticStyle:{color:"red"}},[e._v(e._s(this.approvalApplyDetail.update_items))])])]):e._e(),e._v(" "),a("el-collapse-item",{attrs:{title:"申请详情(点击展开)",name:"baseInfo"}},[e.approval_type==e.type002||e.approval_type==e.type003||e.approval_type==e.type014||e.approval_type==e.type015||e.approval_type==e.type021?a("base-info-staff"):e._e(),e._v(" "),e.approval_type==e.type004||e.approval_type==e.type005||e.approval_type==e.type006||e.approval_type==e.type007||e.approval_type==e.type008||e.approval_type==e.type016||e.approval_type==e.type017||e.approval_type==e.type018||e.approval_type==e.type019||e.approval_type==e.type022?a("base-info-site"):e._e(),e._v(" "),e.approval_type==e.type009||e.approval_type==e.type010||e.approval_type==e.type011||e.approval_type==e.type012||e.approval_type==e.type013||e.approval_type==e.type020?a("base-info-team"):e._e(),e._v(" "),e.approval_type==e.type023?a("base-info-risk"):e._e()],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"提交",visible:e.visible,width:"45%","before-close":e.handleClose},on:{"update:visible":function(t){e.visible=t}}},[a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"90px"}},[a("el-form-item",{attrs:{label:"沟通意见",prop:"approval_desc"}},[a("el-input",{attrs:{type:"textarea",maxlength:"300","show-word-limit":"",autosize:{minRows:2,maxRows:4},placeholder:"请输入内容，最多300字"},model:{value:e.form.approval_desc,callback:function(t){e.$set(e.form,"approval_desc",t)},expression:"form.approval_desc"}})],1)],1),e._v(" "),a("div",{staticStyle:{"text-align":"center"},attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:e.handleClose}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.submitApprovalConnect}},[e._v("确 定\n            ")])],1)],1)],1)},staticRenderFns:[]}},function(e,t,a){var r=a(3)(a(833),a(834),null,null);e.exports=r.exports},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(6),i=a.n(r),o=a(5),l=a.n(o),s=a(10),n=a.n(s),p=a(22),c=a.n(p),u=a(303),d=a.n(u);t.default={components:{baseTable:l.a,basePage:n.a,BranchTreePicker:c.a,BranchTreePickerFH:d.a},name:"siteWarnTime",data:function(){var e=function(e,t,a){if(void 0!==t&&""!=t&&null!=t||a(),!/^[1-9]\d*$/.test(t))return a(new Error("提醒时间格式非法"));a()};return{role:sessionStorage.getItem("role"),form:{},bankid:"",bankname:"",showlist:[],dataList:[{label:"机构号",prop:"branch_id",sort:!0},{label:"机构名称",prop:"branch_name",sort:!0},{label:"站点试营业-开业提醒时间（天）",prop:"warn_time"},{label:"站点试营业-开业提醒间隔时间（天）",prop:"warn_ac_time"}],rules:{branch_id:[{required:!0,message:"请选择机构",trigger:"blur"}],warn_time:[{required:!0,message:"请输入站点试营业-开业提醒时间",trigger:"blur"},{validator:e,trigger:"blur"}],warn_ac_time:[{required:!0,message:"请站点试营业-开业提醒间隔时间",trigger:"blur"},{validator:e,trigger:"blur"}]},siteWarnTimeList:[],pageNum:1,pageSize:10,total:0,visible:!1}},computed:{bankList:{get:function(){return this.$store.state.bankList},set:function(e){this.$store.state.bankList=e}}},mounted:function(){},watch:{visible:function(e){e||(this.form={})}},methods:{nodeselectForSerch:function(e){console.log(e),this.bankname=e.branch_name,this.bankid=e.branch_id},nodeselectForShow:function(e){console.log(e),this.$set(this.form,"branch_name",e.branch_name),this.$set(this.form,"branch_id",e.branch_id)},addSiteWarnTime:function(){var e=this;this.$refs.form.validate(function(t){t&&(e.form.id?e.$api.updateSiteWarnTime(e.form).then(function(t){e.handleClose(),e.getSiteWarnTimeList()}):e.$api.addSiteWarnTime(e.form).then(function(t){e.handleClose(),e.getSiteWarnTimeList()}))})},editSiteWarnTime:function(e){var t=this;this.$api.getWarnTimeDetail({id:e}).then(function(e){console.log(e),t.visible=!0,t.form=e.data.msg[0]})},getSiteWarnTimeList:function(){var e=this;this.$api.getSiteWarnTimeList(i()({page:this.pageNum-1,number:this.pageSize,bankid:this.bankid},this.form)).then(function(t){e.siteWarnTimeList=t.data.siteWarnTimeList,e.total=t.data.total})},changeSize:function(e){this.pageSize=e,this.getSiteWarnTimeList()},changePage:function(e){this.pageNum=e,this.getSiteWarnTimeList()},deleteSiteWarnTime:function(e){var t=this;this.$confirm("确定删除吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!0}).then(function(){t.$api.deleteSiteWarnTime({id:e}).then(function(e){console.log(e),t.getSiteWarnTimeList()})}).catch(function(){})},handleClose:function(){this.visible=!1,this.form={}}},beforeRouteEnter:function(e,t,a){a(function(t){e.params.searchKey&&(t.form=e.params.searchKey),t.getSiteWarnTimeList()})}}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-button",{staticStyle:{"margin-bottom":"10px"},attrs:{type:"primary",size:"small"},on:{click:function(t){e.visible=!0}}},[e._v("新增\n    ")]),e._v(" "),a("el-form",{staticStyle:{"margin-top":"15px"},attrs:{inline:!0,model:e.form}},[a("el-form-item",{attrs:{label:"机构",prop:"bankid"}},[a("div",{staticStyle:{display:"flex"}},[a("el-input",{attrs:{readonly:"",size:"small"},model:{value:e.bankname,callback:function(t){e.bankname=t},expression:"bankname"}}),e._v(" "),a("BranchTreePicker",{on:{nodeselect:e.nodeselectForSerch}})],1)]),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-search"},on:{click:e.getSiteWarnTimeList}},[e._v("搜索\n            ")])],1)],1),e._v(" "),a("base-table",{attrs:{list:e.dataList,data:e.siteWarnTimeList}},[a("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",icon:"el-icon-edit-outline"},on:{click:function(a){return e.editSiteWarnTime(t.row.id)}}},[e._v("编辑\n                ")]),e._v(" "),a("el-button",{staticStyle:{color:"red"},attrs:{type:"text",icon:"el-icon-delete"},on:{click:function(a){return e.deleteSiteWarnTime(t.row.id)}}},[e._v("删除\n                ")])]}}])})],1),e._v(" "),a("base-page",{attrs:{page:e.pageNum,size:e.pageSize,total:e.total},on:{size:e.changeSize,page:e.changePage}}),e._v(" "),a("el-dialog",{attrs:{title:e.form.id?"修改":"新增",visible:e.visible,width:"45%","before-close":e.handleClose},on:{"update:visible":function(t){e.visible=t}}},[a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"90px"}},[a("el-form-item",{attrs:{label:"机构",prop:"branch_id"}},[a("div",{staticStyle:{display:"flex"}},[a("el-input",{attrs:{disabled:!0},model:{value:this.form.branch_name,callback:function(t){e.$set(this.form,"branch_name",t)},expression:"this.form.branch_name"}}),e._v(" "),a("BranchTreePickerFH",{directives:[{name:"show",rawName:"v-show",value:!e.form.id,expression:"!form.id"}],attrs:{dfks:this.form.branch_id,appendToBody:!0},on:{nodeselect:e.nodeselectForShow}})],1)]),e._v(" "),a("el-form-item",{attrs:{label:"站点试营业-开业提醒时间（天）",prop:"warn_time"}},[a("el-input",{attrs:{size:"small"},model:{value:e.form.warn_time,callback:function(t){e.$set(e.form,"warn_time",t)},expression:"form.warn_time"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"站点试营业-开业提醒间隔时间（天）",prop:"warn_ac_time"}},[a("el-input",{attrs:{size:"small"},model:{value:e.form.warn_ac_time,callback:function(t){e.$set(e.form,"warn_ac_time",t)},expression:"form.warn_ac_time"}})],1)],1),e._v(" "),a("div",{staticStyle:{"text-align":"center"},attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:e.handleClose}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.addSiteWarnTime}},[e._v("确 定\n            ")])],1)],1)],1)},staticRenderFns:[]}},function(e,t,a){var r=a(3)(a(836),a(837),null,null);e.exports=r.exports},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(6),i=a.n(r),o=a(5),l=a.n(o),s=a(10),n=a.n(s),p=a(22),c=a.n(p);t.default={components:{baseTable:l.a,basePage:n.a,BranchTreePicker:c.a},name:"siteWarnRecord",data:function(){return{role:sessionStorage.getItem("role"),form:{},orgid:"",orgname:"",dataList:[{label:"站点编号",prop:"site_no",sort:!0},{label:"站点名称",prop:"site_name",sort:!0},{label:"站点状态",prop:"site_status",sort:!0},{label:"提醒状态",prop:"site_step"},{label:"所属机构",prop:"org_name"},{label:"落地支行",prop:"branch_name"},{label:"客户经理",prop:"mgr_id"},{label:"手机号码",prop:"phone"},{label:"是否发送短信",prop:"send_msg"},{label:"是否推送消息",prop:"push_msg"},{label:"提醒时间",prop:"create_time",sort:!0}],siteWarnRecordList:[],pageNum:1,pageSize:10,total:0,visible:!1}},computed:{bankList:{get:function(){return this.$store.state.bankList},set:function(e){this.$store.state.bankList=e}}},mounted:function(){},watch:{visible:function(e){e||(this.form={})}},methods:{nodeselectForSerch:function(e){console.log(e),this.orgname=e.branch_name,this.orgid=e.branch_id},getSiteWarnRecordList:function(){var e=this;this.$api.getSiteWarnRecordList(i()({page:this.pageNum-1,number:this.pageSize,orgid:this.orgid},this.form)).then(function(t){t.data.siteWarnRecordList.map(function(e){return e.send_msg="1"==e.send_msg?"是":"否",e.push_msg="1"==e.push_msg?"是":"否",e.site_status="0"===e.site_status?"试营业":e.site_status="1"===e.site_status?"试营业（已申请pos）":"2"===e.site_status?"已开业":"已退出"}),e.siteWarnRecordList=t.data.siteWarnRecordList,e.total=t.data.total})},changeSize:function(e){this.pageSize=e,this.getSiteWarnRecordList()},changePage:function(e){this.pageNum=e,this.getSiteWarnRecordList()}},beforeRouteEnter:function(e,t,a){a(function(t){e.params.searchKey&&(t.form=e.params.searchKey),t.getSiteWarnRecordList()})}}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-form",{staticStyle:{"margin-top":"15px"},attrs:{inline:!0,model:e.form}},[a("el-form-item",{attrs:{label:"所属机构",prop:"orgid"}},[a("div",{staticStyle:{display:"flex"}},[a("el-input",{attrs:{readonly:"",size:"small"},model:{value:e.orgname,callback:function(t){e.orgname=t},expression:"orgname"}}),e._v(" "),a("BranchTreePicker",{on:{nodeselect:e.nodeselectForSerch}})],1)]),e._v(" "),a("el-form-item",{attrs:{label:"提醒日期",prop:"start_date"}},[a("el-date-picker",{staticStyle:{width:"200px"},attrs:{type:"date","value-format":"yyyy-MM-dd",clearable:"",placeholder:"选择日期"},model:{value:e.form.start_date,callback:function(t){e.$set(e.form,"start_date",t)},expression:"form.start_date"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"——",prop:"end_date"}},[a("el-date-picker",{staticStyle:{width:"200px"},attrs:{type:"date","value-format":"yyyy-MM-dd",clearable:"",placeholder:"选择日期"},model:{value:e.form.end_date,callback:function(t){e.$set(e.form,"end_date",t)},expression:"form.end_date"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"站点编号"}},[a("el-input",{attrs:{clearable:"",placeholder:"请输入站点编号",size:"small"},model:{value:e.form.site_no,callback:function(t){e.$set(e.form,"site_no",t)},expression:"form.site_no"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"站点名称"}},[a("el-input",{attrs:{clearable:"",placeholder:"请输入站点名称",size:"small"},model:{value:e.form.site_name,callback:function(t){e.$set(e.form,"site_name",t)},expression:"form.site_name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"客户经理编号"}},[a("el-input",{attrs:{clearable:"",placeholder:"请输入客户经理编号",size:"small"},model:{value:e.form.mgr_id,callback:function(t){e.$set(e.form,"mgr_id",t)},expression:"form.mgr_id"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-search"},on:{click:e.getSiteWarnRecordList}},[e._v("搜索\n      ")])],1)],1),e._v(" "),a("base-table",{attrs:{list:e.dataList,data:e.siteWarnRecordList}}),e._v(" "),a("base-page",{attrs:{page:e.pageNum,size:e.pageSize,total:e.total},on:{size:e.changeSize,page:e.changePage}})],1)},staticRenderFns:[]}},function(e,t,a){var r=a(3)(a(839),a(840),null,null);e.exports=r.exports},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(6),i=a.n(r),o=a(5),l=a.n(o),s=a(10),n=a.n(s),p=a(22),c=a.n(p);t.default={components:{baseTable:l.a,basePage:n.a,BranchTreePicker:c.a},name:"patrol",data:function(){return{role:sessionStorage.getItem("role"),form:{},siteList:[],dataList:[{label:"服务点名称",prop:"site_name",sort:!0},{label:"巡查类别",prop:"category",sort:!0},{label:"巡查人姓名",prop:"name",sort:!0},{label:"巡查时间",prop:"inspect_time",sort:!0},{label:"移动打卡",prop:"clock_in",sort:!0},{label:"巡查结果",prop:"patrol_remarks"},{label:"巡查结果描述",prop:"patrol_problem"}],rules:{site_id:[{required:!0,message:"请选择服务点",trigger:"change"}],account_id:[{required:!0,message:"请选择巡查人",trigger:"change"}],inspect_time:[{required:!0,message:"请选择巡查时间",trigger:"blur"}]},items:[{value:0,label:"开业定期巡查"},{value:1,label:"退出开业巡查"}],setFulltime:this.disabledDate(),patrolList:[],sysUserList:[],pageNum:1,pageSize:10,total:0,visible:!1,bankname:"",bankid:"",inspect_time:""}},computed:{bankList:{get:function(){return this.$store.state.bankList},set:function(e){this.$store.state.bankList=e}}},mounted:function(){this.getAccountList(),this.getSiteSelectList()},watch:{visible:function(e){e||(this.form={})}},methods:{disabledDate:function(){var e=this;return{disabledDate:function(t){var a=new Date("2022-04-14");return new Date(e.inspect_time)>a?t.getTime()<a:t.getTime()>a}}},nodeselectForSerch:function(e){console.log(e),this.bankname=e.branch_name,this.bankid=e.branch_id},getAccountList:function(){var e=this;0==this.sysUserList.length&&this.$api.getAccountList({}).then(function(t){e.sysUserList=t.data})},getSiteSelectList:function(){var e=this;this.$api.getSiteSelectList().then(function(t){e.siteList=t.data.siteList})},getPatrolList:function(e){var t=this;e&&(this.pageNum=1),this.$api.getPatrolList({page:this.pageNum-1,number:this.pageSize,bankid:this.bankid,site_id:this.form.site_id,account_id:this.form.account_id,inspect_start_time:this.form.inspect_start_time,inspect_end_time:this.form.inspect_end_time,category:this.form.category}).then(function(e){t.patrolList=e.data.patrolList,t.total=e.data.total,t.patrolList.map(function(e){null==e.log_sum&&(e.log_sum="0"),"0"==e.clock_in?e.clock_in="否":"1"==e.clock_in&&(e.role_level="是"),0===e.category?e.category="开业定期巡查":1===e.category&&(e.category="退出开业巡查")})})},addOrEditView:function(){this.visible=!0,this.form={},this.inspect_time="",console.log(this.form.patrol_id)},addtPatrol:function(){var e=this;this.$refs.form.validate(function(t){t&&(e.form.patrol_id?e.$api.updatePatrol(e.form).then(function(t){e.handleClose(),e.getPatrolList()}):e.$api.addPatrol(e.form).then(function(t){var a=t.data.patrol_id;a?(Object.defineProperty(e.form,"patrol_id",{value:a}),console.log(e.form),e.editMarkSheel(e.form)):(e.handleClose(),e.getPatrolList())}))})},editPatrol:function(e){var t=this;this.$api.getPatrolDetail({patrol_id:e}).then(function(e){console.log(e),t.visible=!0,t.form=e.data.msg[0],t.inspect_time=t.form.inspect_time})},deletePatrol:function(e,t){var a=this,r="确定删除吗？";t&&(r="若删除，将同时删除该任务下的巡查问题，请确认。"),this.$confirm(r,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!0}).then(function(){a.$api.deletePatrol({patrol_id:e}).then(function(e){console.log(e),a.getPatrolList()})}).catch(function(){})},editMarkSheel:function(e){var t="",a="",r=!1;if("退出开业巡查"===e.category||1===e.category)t="/quit_msheel.vue",a="退出巡检条款";else{new Date(e.inspect_time).getTime()>new Date("2022-04-14").getTime()?(t="/new_msheel.vue",a="巡检条款"):(t="/mark_sheel",a="巡查操作")}e.patrol_remarks&&(r=!0),this.$router.push({path:t,name:a,query:{patrol_id:e.patrol_id,inspect_time:e.inspect_time,flag:r,role:this.role}})},exportPatrolInfos:function(){var e=this;this.$api.exportPatrolInfos(i()({},this.form)).then(function(t){var a=t.data.fileName,r=t.data.filePath;if(null==a||null==r)return e.$message({message:"导出失败，系统异常",type:"error"}),!1;var i=document.createElement("form");document.body.appendChild(i),i.method="post",i.action="/hnm/txCtrl?txcode=mediaFile",i.enctype="multipart/form-data";var o=document.createElement("input"),l=document.createElement("input"),s=document.createElement("input"),n=document.createElement("input");o.setAttribute("name","filePath"),o.setAttribute("type","hidden"),o.setAttribute("value",r),l.setAttribute("name","fileName"),l.setAttribute("type","hidden"),l.setAttribute("value",a),s.setAttribute("name","isDownload"),s.setAttribute("type","hidden"),s.setAttribute("value","1"),n.setAttribute("name","isDelete"),n.setAttribute("type","hidden"),n.setAttribute("value","1"),i.appendChild(o),i.appendChild(l),i.appendChild(s),i.appendChild(n),i.submit(),e.$message({message:"导出成功",type:"success"})})},changeSize:function(e){this.pageSize=e,this.getPatrolList()},changePage:function(e){this.pageNum=e,this.getPatrolList()},handleClose:function(){this.visible=!1,this.form={},this.inspect_time=""}},beforeRouteEnter:function(e,t,a){a(function(t){e.params.searchKey&&(t.form=e.params.searchKey),t.getPatrolList()})}}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-button",{staticStyle:{"margin-bottom":"10px"},attrs:{type:"primary",size:"small"},on:{click:e.addOrEditView}},[e._v("\n    新增巡查任务\n  ")]),e._v(" "),a("el-button",{attrs:{type:"warning",size:"small"},on:{click:e.exportPatrolInfos}},[e._v("\n    导出全部查询数据\n  ")]),e._v(" "),a("el-form",{staticStyle:{"margin-top":"15px"},attrs:{inline:!0,model:e.form}},[a("el-form-item",{attrs:{label:"巡查时间",prop:"inspect_start_time"}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date","value-format":"yyyy-MM-dd",placeholder:"选择日期"},model:{value:e.form.inspect_start_time,callback:function(t){e.$set(e.form,"inspect_start_time",t)},expression:"form.inspect_start_time"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"-",prop:"inspect_end_time"}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date","value-format":"yyyy-MM-dd",placeholder:"选择日期"},model:{value:e.form.inspect_end_time,callback:function(t){e.$set(e.form,"inspect_end_time",t)},expression:"form.inspect_end_time"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"服务点",prop:"site_id"}},[a("el-select",{attrs:{filterable:"",clearable:"",size:"small"},model:{value:e.form.site_id,callback:function(t){e.$set(e.form,"site_id",t)},expression:"form.site_id"}},e._l(e.siteList,function(e){return a("el-option",{key:e.site_no,attrs:{label:e.site_name,value:e.site_no}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"巡查类别",prop:"category"}},[a("el-select",{attrs:{filterable:"",clearable:"",size:"small"},model:{value:e.form.category,callback:function(t){e.$set(e.form,"category",t)},expression:"form.category"}},e._l(e.items,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"巡查人姓名",prop:"account_id"}},[a("el-select",{attrs:{filterable:"",clearable:"",size:"small"},model:{value:e.form.account_id,callback:function(t){e.$set(e.form,"account_id",t)},expression:"form.account_id"}},e._l(e.sysUserList,function(t){return a("el-option",{key:t.account_id,attrs:{label:t.name,value:t.account_id}},[a("span",[e._v(e._s(t.name)+"("+e._s(t.account_id)+")")])])}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"所属机构",prop:"bankid"}},[a("div",{staticStyle:{display:"flex"}},[a("el-input",{attrs:{readonly:"",size:"small"},model:{value:e.bankname,callback:function(t){e.bankname=t},expression:"bankname"}}),e._v(" "),a("BranchTreePicker",{on:{nodeselect:e.nodeselectForSerch}})],1)]),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-search"},on:{click:function(t){return e.getPatrolList(!0)}}},[e._v("搜索\n      ")])],1)],1),e._v(" "),a("base-table",{attrs:{list:e.dataList,data:e.patrolList}},[a("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",icon:"el-icon-edit-outline"},on:{click:function(a){return e.editMarkSheel(t.row)}}},[e._v("\n          巡查操作\n        ")]),e._v(" "),a("el-button",{attrs:{type:"text",icon:"el-icon-edit-outline"},on:{click:function(a){return e.editPatrol(t.row.patrol_id)}}},[e._v("\n          编辑\n        ")]),e._v(" "),a("el-button",{staticStyle:{color:"red"},attrs:{type:"text",icon:"el-icon-delete"},on:{click:function(a){return e.deletePatrol(t.row.patrol_id,t.row.patrol_problem)}}},[e._v("删除\n        ")])]}}])})],1),e._v(" "),a("base-page",{attrs:{page:e.pageNum,size:e.pageSize,total:e.total},on:{size:e.changeSize,page:e.changePage}}),e._v(" "),a("el-dialog",{attrs:{title:e.form.patrol_id?"修改":"新增",visible:e.visible,width:"45%","before-close":e.handleClose},on:{"update:visible":function(t){e.visible=t}}},[a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"90px"}},[a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],attrs:{label:"主键",prop:"patrol_id"}},[a("el-select",{attrs:{filterable:"",clearable:"",size:"small"},model:{value:e.form.patrol_id,callback:function(t){e.$set(e.form,"patrol_id",t)},expression:"form.patrol_id"}},[a("el-input",{model:{value:e.form.patrol_id,callback:function(t){e.$set(e.form,"patrol_id",t)},expression:"form.patrol_id"}})],1)],1),e._v(" "),a("el-form-item",{staticStyle:{width:"360px"},attrs:{label:"服务点",prop:"site_id"}},[a("el-select",{attrs:{filterable:"",clearable:"",size:"small"},model:{value:e.form.site_id,callback:function(t){e.$set(e.form,"site_id",t)},expression:"form.site_id"}},e._l(e.siteList,function(e){return a("el-option",{key:e.site_no,attrs:{label:e.site_name,value:e.site_no}})}),1)],1),e._v(" "),a("el-form-item",{staticStyle:{width:"360px"},attrs:{label:"巡查类别",prop:"category"}},[a("el-select",{attrs:{filterable:"",clearable:"",size:"small"},model:{value:e.form.category,callback:function(t){e.$set(e.form,"category",t)},expression:"form.category"}},e._l(e.items,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),a("el-form-item",{staticStyle:{width:"360px"},attrs:{label:"巡查人",prop:"account_id"}},[a("el-select",{attrs:{filterable:"",clearable:"",size:"small"},model:{value:e.form.account_id,callback:function(t){e.$set(e.form,"account_id",t)},expression:"form.account_id"}},e._l(e.sysUserList,function(e){return a("el-option",{key:e.account_id,attrs:{label:e.name,value:e.account_id}})}),1)],1),e._v(" "),a("el-form-item",{staticStyle:{width:"360px"},attrs:{label:"巡查时间",prop:"inspect_time"}},[a("el-date-picker",{directives:[{name:"show",rawName:"v-show",value:void 0===e.form.patrol_id,expression:"form.patrol_id === undefined"}],staticStyle:{width:"100%"},attrs:{type:"date","value-format":"yyyy-MM-dd",placeholder:"选择日期"},model:{value:e.form.inspect_time,callback:function(t){e.$set(e.form,"inspect_time",t)},expression:"form.inspect_time"}}),e._v(" "),a("el-date-picker",{directives:[{name:"show",rawName:"v-show",value:void 0!==e.form.patrol_id,expression:"form.patrol_id !== undefined"}],staticStyle:{width:"100%"},attrs:{type:"date","value-format":"yyyy-MM-dd",placeholder:"选择日期","picker-options":e.setFulltime},model:{value:e.form.inspect_time,callback:function(t){e.$set(e.form,"inspect_time",t)},expression:"form.inspect_time"}})],1),e._v(" "),a("el-form-item",{staticStyle:{width:"360px"},attrs:{label:"备注",prop:"patrol_remark"}},[a("el-input",{model:{value:e.form.patrol_remark,callback:function(t){e.$set(e.form,"patrol_remark",t)},expression:"form.patrol_remark"}})],1)],1),e._v(" "),a("div",{staticStyle:{"text-align":"center"},attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:e.handleClose}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.addtPatrol}},[e._v("确 定\n      ")])],1)],1)],1)},staticRenderFns:[]}},function(e,t,a){a(842);var r=a(3)(a(843),a(848),null,null);e.exports=r.exports},function(e,t){},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(120),i=a.n(r),o=a(121),l=a.n(o),s=a(5),n=a.n(s),p=a(10),c=a.n(p),u=a(77),d=(a.n(u),a(122));a.n(d);t.default={components:{baseTable:n.a,basePage:c.a},name:"patrol",data:function(){return{responsible:"",userList:[],projectList:[],fileList:[],role:sessionStorage.getItem("role"),form:{},dialogImageUrl:"",dialogVisible:!1,markSheelList:{},tests:["1分","2分","3分","4分","5分"],items1:[{label:"情况正常"},{label:"情况异常"}],items2:[{label:"高"},{label:"中"},{label:"低"}],setFulltime:this.disabledDate(),tableData:[],showInput:"",oldData:{},siteId:"",mgr_id:"",inspect_time:"",editable:!1}},directives:{focus:{inserted:function(e){"input"==e.tagName.toLocaleLowerCase()?e.focus():e.getElementsByTagName("input")&&e.getElementsByTagName("input")[0].focus(),e.focus()}},focusTextarea:{inserted:function(e){"textarea"==e.tagName.toLocaleLowerCase()?e.focus():e.getElementsByTagName("textarea")&&e.getElementsByTagName("textarea")[0].focus(),e.focus()}}},computed:{bankList:{get:function(){return this.$store.state.bankList},set:function(e){this.$store.state.bankList=e}}},mounted:function(){var e=this;this.editable=this.$route.query.flag,this.inspect_time=this.$route.query.inspect_time,this.$api.getMarkSheel({}).then(function(t){e.markSheelList=t.data.markSheelList,console.log(t)}),this.$api.getPatrolLog({patrol_id:this.$route.query.patrol_id}).then(function(t){e.fileList=[],e.form=t.data.logList,e.siteId=t.data.hisLogList.site_id,e.mgr_id=t.data.hisLogList.mgr_id,e.tableData=t.data.logList.contentList,e.form.patrol_photo&&e.$api.getPhotoList({ids:e.form.patrol_photo}).then(function(t){e.fileList=t.data.photoList,e.form.patrol_photo="",e.fileList.map(function(t){t.response={data:[{id:t.name}]},e.form.patrol_photo+="'"+t.response.data[0].id+"',"}),e.form.patrol_photo=e.form.patrol_photo.substr(0,e.form.patrol_photo.length-1),console.log(e.form.patrol_photo)})}),this.getAccountList(),this.getProjectList()},methods:{getProjectList:function(){var e=this;this.projectList.length>1||(this.$api.getProjectList({}).then(function(t){e.projectList=t.data}),this.project_name="")},getAccountList:function(){var e=this;0==this.userList.length&&this.$api.getAccountList({}).then(function(t){var a=t.data;if(a)for(var r=0;r<a.length;r++)e.userList=a})},disabledDate:function(){var e=this;return{disabledDate:function(t){var a=new Date(e.inspect_time)-864e5,r=a+78624e5;return t.getTime()<a||t.getTime()>r}}},beforeAvatarUpload:function(e){return"image/png"===e.type||"image/jpg"===e.type||"image/jpeg"===e.type||(this.$message.error("不支持png、jpg、jpeg以外格式的图片"),!1)},starAdd:function(e){if(0!==e.columnIndex&&1!==e.columnIndex&&8!==e.columnIndex)return"star"},uploadReturn:function(e,t,a){var r=this;console.log(t),this.form.patrol_photo="",a.map(function(e){r.form.patrol_photo+="'"+e.response.data[0].id+"',"}),this.form.patrol_photo=this.form.patrol_photo.substr(0,this.form.patrol_photo.length-1),console.log(this.form.patrol_photo)},handleRemove:function(e,t){var a=this;this.form.patrol_photo="",t.map(function(e){a.form.patrol_photo+="'"+e.response.data[0].id+"',"}),this.form.patrol_photo=this.form.patrol_photo.substr(0,this.form.patrol_photo.length-1),console.log(this.form.patrol_photo)},handlePictureCardPreview:function(e){this.dialogImageUrl=e.url,this.dialogVisible=!0},blurInput:function(e,t,a){var r=this;return l()(i.a.mark(function e(){var o;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:o={},r.tableData[t]!=a&&(o[t]=a),r.showInput="";case 3:case"end":return e.stop()}},e,r)}))()},tableDbEdit:function(e,t){e.source||(this.showInput=t.property+e.id,this.oldData[t.property]=e[t.property])},addItem:function(){this.tableData.push({id:this.tableData.length+1,content_text:"",risk_level:"",end_date:"",requirement:"",site_no:this.siteId,responsible:this.mgr_id,project_name:"定期巡检"})},deleteRow:function(e,t){t.splice(e,1)},addOrEditPatLog:function(){var e=this;if(this.form.patrol_id=this.$route.query.patrol_id,this.form.source=1,delete this.form.site_id,delete this.form.mgr_id,void 0===this.form[80101]||null===this.form[80101]||0===this.form[80101].length)return void this.$message.error("请选择巡查结果");for(var t=0;t<this.tableData.length;t++){if(void 0!==this.tableData[t].id&&null!==this.tableData[t].id||(this.tableData[t].id=t+1),void 0===this.tableData[t].content_text||null===this.tableData[t].content_text||0===this.tableData[t].content_text.length)return void this.$message.error("项目名称、问题描述、风险等级、整改时间、整改要求、整改人不可为空");if(void 0===this.tableData[t].project_name||null===this.tableData[t].project_name||0===this.tableData[t].project_name.length)return void this.$message.error("项目名称、问题描述、风险等级、整改时间、整改要求、整改人不可为空");for(var a=this.tableData[t].project_name,r=this.projectList,i=0;i<r.length;i++)r[i].project_name===a&&(this.tableData[t].pj_classify=r[i].pj_classify);if(void 0===this.tableData[t].risk_level||null===this.tableData[t].risk_level||0===this.tableData[t].risk_level.length)return void this.$message.error("项目名称、问题描述、风险等级、整改时间、整改要求、整改人不可为空");if(void 0===this.tableData[t].end_date||null==this.tableData[t].end_date||0===this.tableData[t].end_date.length)return void this.$message.error("项目名称、问题描述、风险等级、整改时间、整改要求、整改人不可为空");if(void 0===this.tableData[t].requirement||null===this.tableData[t].requirement||0===this.tableData[t].requirement.length)return void this.$message.error("项目名称、问题描述、风险等级、整改时间、整改要求、整改人不可为空");if(void 0===this.tableData[t].responsible||null===this.tableData[t].responsible||0===this.tableData[t].responsible.length)return void this.$message.error("项目名称、问题描述、风险等级、整改时间、整改要求、整改人不可为空");if(!this.checkDate(this.tableData[t].end_date))return void this.$message.error("整改时间不能超过巡查时间的90天")}this.$api.addOrEditPatrolLog(this.form).then(function(t){e.$api.getPatrolLog({patrol_id:e.$route.query.patrol_id}).then(function(t){e.$message.success("保存成功"),e.$router.push({path:"/patrol",name:"巡查管理",query:{}})})})},reSetValue:function(){this.form={patrol_id:this.$route.query.patrol_id}},checkDate:function(e){return!((new Date(e).getTime()-new Date(this.inspect_time).getTime())/24/60/60/1e3>90&&(this.$message.error("整改时间不能超过巡查时间的90天"),1))}}}},,,function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={name:"project",data:function(){return{visible:!1,dialogVisible:!1,project_name:"",tableData:[],defaultProps:{children:"children",label:"project_name"},dfks:[]}},methods:{addOrDeleteProjec:function(e,t){var a=this,r={};r.project_name=this.project_name,"number"==typeof e&&(r.pj_classify=e,r.project_name=t),this.$api.addOrDeleteProjec(r).then(function(){a.tableData={},a.getProjectList()})},getProjectList:function(){var e=this;if(this.tableData.length>1)return void(this.dialogVisible=!0);this.$api.getProjectList({}).then(function(t){e.tableData=t.data,e.dialogVisible=!0}),this.project_name=""}}}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{"margin-left":"1px"}},[a("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){return e.getProjectList()}}},[e._v("巡查项目管理")]),e._v(" "),a("el-dialog",{attrs:{title:"巡查项目管理",visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("div",[a("el-button",[e._v("项目名称")]),e._v(" "),a("el-col",{attrs:{span:"230"}},[a("el-input",{staticStyle:{width:"100%"},attrs:{id:"input",placeholder:"请输入项目名称",maxlength:"15"},model:{value:e.project_name,callback:function(t){e.project_name=t},expression:"project_name"}})],1),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.addOrDeleteProjec}},[e._v("新增")])],1),e._v(" "),a("el-table",{attrs:{data:e.tableData,"element-loading-text":"Loading",border:"",fit:"","highlight-current-row":""}},[e._t("begin"),e._v(" "),e._t("head",function(){return[a("el-table-column",{attrs:{fixed:"",align:"center",type:"index",prop:"index",label:"序号",width:"50"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"项目名称",prop:"project_name"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",fixed:"right",label:"操作",width:"60"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",size:"small"},nativeOn:{click:function(a){return a.preventDefault(),e.addOrDeleteProjec(t.row.pj_classify,t.row.project_name)}}},[e._v("\n              删除\n            ")])]}}])})]})],2)],1)],1)},staticRenderFns:[]}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("h1",{attrs:{align:"center"}},[e._v("广东南粤银行普惠金融支付服务点合规检查标准")]),e._v(" "),a("el-form",{staticStyle:{"margin-top":"15px"},attrs:{inline:!0,model:e.form,disabled:e.editable}},[a("el-tabs",e._l(e.markSheelList,function(t,r){return a("el-tab-pane",{key:r,attrs:{label:t.content}},e._l(t.list,function(t){return a("div",[a("h3",[e._v(e._s(t.content))]),e._v(" "),e._l(t.list,function(t){return a("div",[a("el-form-item",{attrs:{label:t.content,required:!0}},[801==t.parent_id?a("div",[a("el-select",{attrs:{clearable:"",placeholder:"请选择"},model:{value:e.form[t.mark_sheel_id],callback:function(a){e.$set(e.form,t.mark_sheel_id,a)},expression:"form[point.mark_sheel_id]"}},e._l(e.items1,function(e){return a("el-option",{key:e.label,attrs:{label:e.label,value:e.label}})}),1),e._v(" "),a("h4",[e._v("\n                            服务点发生民间融资、高利贷、非法集资、非法吸收公众存款及其他非法金融业务形式或苗头的，\n                    收单机构发现后，应立即向其上级行报告，并于1 个工作日内向当地人民银行报告。"),a("br"),e._v("\n                            对存在欺诈、套现、卡片侧录、利用受理终端不正当牟利、故意使用假币等行为的服务点，\n                    银行应中止协议，收回受理终端和标识牌，并及时向当地中国人民银行分支机构报告。涉嫌犯罪的要\n                    移送司法部门处理。\n                  ")])],1):e._e(),e._v(" "),901==t.parent_id?[a("i",{staticStyle:{color:"red"}},[e._v("点击单元格即可编辑内容")]),e._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{"header-cell-class-name":e.starAdd,border:"",data:e.tableData,"max-height":"250"},on:{"cell-click":e.tableDbEdit},model:{value:e.form[t.mark_sheel_id],callback:function(a){e.$set(e.form,t.mark_sheel_id,a)},expression:"form[point.mark_sheel_id]"}},[a("el-table-column",{attrs:{fixed:"",align:"center",type:"index",prop:"index",label:"序号",width:"50"}}),e._v(" "),a("el-table-column",{attrs:{disabled:"true",align:"center",prop:"site_no",label:"机构或站点编号",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.showInput=="site_no"+t.row.id?a("el-input",{attrs:{type:"textarea",size:"small",disabled:"true"},model:{value:t.row.site_no,callback:function(a){e.$set(t.row,"site_no",a)},expression:"scope.row.site_no"}}):a("span",[e._v(e._s(t.row.site_no))])]}}],null,!0)}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"project_name",label:"项目名称",width:"110"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.showInput=="project_name"+t.row.id?a("el-select",{attrs:{filterable:"",size:"small"},on:{change:function(a){return e.blurInput(t.row.id,"pj_classify",t.row.project_name)}},model:{value:t.row.project_name,callback:function(a){e.$set(t.row,"project_name",a)},expression:"scope.row.project_name"}},e._l(e.projectList,function(e){return a("el-option",{key:e.pj_classify,attrs:{label:e.project_name,value:e.project_name,disabled:"系统自动排查"===e.project_name}})}),1):a("span",[e._v(e._s(t.row.project_name))])]}}],null,!0)}),e._v(" "),a("el-table-column",{attrs:{resizable:"",align:"center",prop:"content_text",label:"问题描述",width:"210"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.showInput=="content_text"+t.row.id?a("el-input",{directives:[{name:"focusTextarea",rawName:"v-focusTextarea"}],attrs:{type:"textarea",size:"small"},on:{blur:function(a){return e.blurInput(t.row.id,"content_text",t.row.content_text)}},model:{value:t.row.content_text,callback:function(a){e.$set(t.row,"content_text",a)},expression:"scope.row.content_text"}}):a("span",[e._v(e._s(t.row.content_text))])]}}],null,!0)}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"risk_level",label:"风险等级",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.showInput=="risk_level"+t.row.id?a("el-select",{directives:[{name:"focus",rawName:"v-focus"}],attrs:{size:"small"},on:{change:function(a){return e.blurInput(t.row.id,"riskLevel",t.row.risk_level)}},model:{value:t.row.risk_level,callback:function(a){e.$set(t.row,"risk_level",a)},expression:"scope.row.risk_level"}},e._l(e.items2,function(e){return a("el-option",{key:e.label,attrs:{label:e.label,value:e.label}})}),1):a("span",[e._v(e._s(t.row.risk_level))])]}}],null,!0)}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"end_date",label:"整改时间",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.showInput=="end_date"+t.row.id?a("el-date-picker",{directives:[{name:"focus",rawName:"v-focus"}],attrs:{size:"small","value-format":"yyyy-MM-dd","picker-options":e.setFulltime},on:{blur:function(a){return e.blurInput(t.row.id,"end_date",t.row.end_date)},change:function(a){return e.checkDate(t.row.end_date)}},model:{value:t.row.end_date,callback:function(a){e.$set(t.row,"end_date",a)},expression:"scope.row.end_date"}}):a("span",[e._v(e._s(t.row.end_date))])]}}],null,!0)}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"requirement",label:"整改要求",width:"210"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.showInput=="requirement"+t.row.id?a("el-input",{directives:[{name:"focusTextarea",rawName:"v-focusTextarea"}],attrs:{type:"textarea",size:"small"},on:{blur:function(a){return e.blurInput(t.row.id,"requirement",t.row.requirement)}},model:{value:t.row.requirement,callback:function(a){e.$set(t.row,"requirement",a)},expression:"scope.row.requirement"}}):a("span",[e._v(e._s(t.row.requirement))])]}}],null,!0)}),e._v(" "),a("el-table-column",{attrs:{disabled:"true",align:"center",prop:"responsible",label:"整改人",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.showInput=="responsible"+t.row.id?a("el-select",{attrs:{"value-key":"account_id",size:"small"},on:{change:function(a){return e.blurInput(t.row.id,"responsible",t.row.responsible)}},model:{value:t.row.responsible,callback:function(a){e.$set(t.row,"responsible",a)},expression:"scope.row.responsible"}},e._l(e.userList,function(e){return a("el-option",{key:e.account_id,attrs:{label:e.name,value:e.account_id}})}),1):a("span",[e._v(e._s(t.row.responsible))])]}}],null,!0)}),e._v(" "),a("el-table-column",{attrs:{align:"center",fixed:"right",label:"操作",width:"60"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",size:"small"},nativeOn:{click:function(a){return a.preventDefault(),e.deleteRow(t.$index,e.tableData)}}},[e._v("\n                          移除\n                        ")])]}}],null,!0)})],1),e._v(" "),a("el-button",{attrs:{icon:"el-icon-plus"},on:{click:e.addItem}})]:e._e(),e._v(" "),0!=t.score?a("el-rate",{staticStyle:{"margin-top":"10px"},attrs:{max:parseInt(t.score),"show-score":""},model:{value:e.form[t.mark_sheel_id],callback:function(a){e.$set(e.form,t.mark_sheel_id,a)},expression:"form[point.mark_sheel_id]"}}):e._e()],2),e._v(" "),0!=t.score?a("b",{staticStyle:{color:"#bf0000"}},[e._v(e._s(t.score+"分"))]):e._e()],1)})],2)}),0)}),1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.addOrEditPatLog}},[e._v("\n          保存\n        ")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.reSetValue}},[e._v("\n          重置\n        ")])],1)],1)],1)},staticRenderFns:[]}},function(e,t,a){a(850);var r=a(3)(a(851),a(852),null,null);e.exports=r.exports},function(e,t){},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(120),i=a.n(r),o=a(121),l=a.n(o),s=a(5),n=a.n(s),p=a(10),c=a.n(p),u=a(77),d=(a.n(u),a(122)),m=a.n(d);t.default={components:{project:m.a,baseTable:n.a,basePage:c.a},data:function(){return{responsible:"",userList:[],projectList:[],fileList:[],role:sessionStorage.getItem("role"),form:{},dialogImageUrl:"",dialogVisible:!1,markSheelList:{},items1:[{label:"情况正常"},{label:"情况异常"}],items2:[{label:"高"},{label:"中"},{label:"低"}],setFulltime:this.disabledDate(),tableData:[],showInput:"",oldData:{},siteId:"",mgr_id:"",inspect_time:"",noneBtnImg:!0}},directives:{focus:{inserted:function(e){"input"==e.tagName.toLocaleLowerCase()?e.focus():e.getElementsByTagName("input")&&e.getElementsByTagName("input")[0].focus(),e.focus()}},focusTextarea:{inserted:function(e){"textarea"==e.tagName.toLocaleLowerCase()?e.focus():e.getElementsByTagName("textarea")&&e.getElementsByTagName("textarea")[0].focus(),e.focus()}}},computed:{bankList:{get:function(){return this.$store.state.bankList},set:function(e){this.$store.state.bankList=e}}},mounted:function(){var e=this;this.inspect_time=this.$route.query.inspect_time,this.$api.getNmarkSheel({}).then(function(t){e.markSheelList=t.data.markSheelList,console.log(t)}),this.getPatrolLog(),this.getAccountList(),this.getProjectList()},methods:{getPatrolLog:function(){var e=this;this.$api.getPatrolLog({patrol_id:this.$route.query.patrol_id}).then(function(t){e.fileList=[],e.form=t.data.logList,e.tableData=t.data.logList.contentList,e.form.patrol_photo&&e.$api.getPhotoList({ids:e.form.patrol_photo}).then(function(t){e.fileList=t.data.photoList,e.form.patrol_photo="",e.fileList.map(function(t){t.response={data:[{id:t.name}]},e.form.patrol_photo+="'"+t.response.data[0].id+"',"}),e.form.patrol_photo=e.form.patrol_photo.substr(0,e.form.patrol_photo.length-1),console.log(e.form.patrol_photo)})})},getProjectList:function(){var e=this;this.projectList.length>1||(this.$api.getProjectList({}).then(function(t){e.projectList=t.data}),this.project_name="")},getAccountList:function(){var e=this;0==this.userList.length&&this.$api.getAccountList({}).then(function(t){var a=t.data;if(a)for(var r=0;r<a.length;r++)e.userList=a})},disabledDate:function(){var e=this;return{disabledDate:function(t){var a=new Date(e.inspect_time)-864e5,r=a+78624e5;return t.getTime()<a||t.getTime()>r}}},beforeAvatarUpload:function(e){return"image/png"===e.type||"image/jpg"===e.type||"image/jpeg"===e.type||(this.$message.error("不支持png、jpg、jpeg以外格式的图片"),!1)},starAdd:function(e){if(0!==e.columnIndex&&1!==e.columnIndex&&8!==e.columnIndex)return"star"},uploadReturn:function(e,t,a){var r=this;console.log(t),this.form.patrol_photo="",a.map(function(e){r.form.patrol_photo+="'"+e.response.data[0].id+"',"}),this.form.patrol_photo=this.form.patrol_photo.substr(0,this.form.patrol_photo.length-1),console.log(this.form.patrol_photo)},handleRemove:function(e,t){var a=this;this.form.patrol_photo="",t.map(function(e){a.form.patrol_photo+="'"+e.response.data[0].id+"',"}),this.form.patrol_photo=this.form.patrol_photo.substr(0,this.form.patrol_photo.length-1),console.log(this.form.patrol_photo)},handlePictureCardPreview:function(e){this.dialogImageUrl=e.url,this.dialogVisible=!0},blurInput:function(e,t,a){var r=this;return l()(i.a.mark(function e(){var o;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:o={},r.tableData[t]!=a&&(o[t]=a),r.showInput="";case 3:case"end":return e.stop()}},e,r)}))()},tableDbEdit:function(e,t){1!==e.status&&2!==e.status&&3!==e.status&&(this.showInput=t.property+e.id,this.oldData[t.property]=e[t.property])},addItem:function(){this.tableData.push({id:0===this.tableData.length?1:this.tableData[this.tableData.length-1].id+1,content_text:"",risk_level:"",end_date:"",requirement:"",site_no:this.form.site_id,responsible:this.form.mgr_id,project_name:"定期巡检"}),console.log(this.tableData)},deleteRow:function(e,t){t.splice(e,1)},addOrEditPatLog:function(){var e=this;this.form.patrol_id=this.$route.query.patrol_id,this.form.source=1;for(var t=0;t<this.markSheelList.length;t++){var a=this.markSheelList[t];if("8"!==a.mark_sheel_id&&"9"!==a.mark_sheel_id)for(var r=0;r<a.list.length;r++)if(null===this.form[a.list[r].mark_sheel_id]||void 0===this.form[a.list[r].mark_sheel_id]||""===this.form[a.list[r].mark_sheel_id])return void this.$message.error("请选择"+a.list[r].content)}if(void 0===this.form[80101]||null===this.form[80101]||0===this.form[80101].length)return void this.$message.error("请选择巡查结果");for(var i=0;i<this.tableData.length;i++){if(void 0!==this.tableData[i].id&&null!==this.tableData[i].id||(this.tableData[i].id=i+1),void 0===this.tableData[i].content_text||null===this.tableData[i].content_text||0===this.tableData[i].content_text.length)return void this.$message.error("项目名称、问题描述、风险等级、整改时间、整改要求、整改人不可为空");if(void 0===this.tableData[i].project_name||null===this.tableData[i].project_name||0===this.tableData[i].project_name.length)return void this.$message.error("项目名称、问题描述、风险等级、整改时间、整改要求、整改人不可为空");for(var o=this.tableData[i].project_name,l=this.projectList,s=0;s<l.length;s++)l[s].project_name===o&&(this.tableData[i].pj_classify=l[s].pj_classify);if(void 0===this.tableData[i].risk_level||null===this.tableData[i].risk_level||0===this.tableData[i].risk_level.length)return void this.$message.error("项目名称、问题描述、风险等级、整改时间、整改要求、整改人不可为空");if(void 0===this.tableData[i].end_date||null==this.tableData[i].end_date||0===this.tableData[i].end_date.length)return void this.$message.error("项目名称、问题描述、风险等级、整改时间、整改要求、整改人不可为空");if(void 0===this.tableData[i].requirement||null===this.tableData[i].requirement||0===this.tableData[i].requirement.length)return void this.$message.error("项目名称、问题描述、风险等级、整改时间、整改要求、整改人不可为空");if(void 0===this.tableData[i].responsible||null===this.tableData[i].responsible||0===this.tableData[i].responsible.length)return void this.$message.error("项目名称、问题描述、风险等级、整改时间、整改要求、整改人不可为空");if(!this.checkDate(this.tableData[i].end_date))return void this.$message.error("整改时间不能超过巡查时间的90天")}delete this.form.site_id,delete this.form.mgr_id,this.$api.addOrEditPatrolLog(this.form).then(function(t){e.$api.getPatrolLog({patrol_id:e.$route.query.patrol_id}).then(function(t){e.$message.success("保存成功"),e.$router.push({path:"/patrol",name:"巡查管理",query:{}})})})},reSetValue:function(){this.getPatrolLog()},checkDate:function(e){return!((new Date(e).getTime()-new Date(this.inspect_time).getTime())/24/60/60/1e3>90&&(this.$message.error("整改时间不能超过巡查时间的90天"),1))},exportPatrolLog:function(){var e=this;this.$api.exportPatrolLog({patrol_id:this.$route.query.patrol_id}).then(function(t){var a=t.data.fileName,r=t.data.filePath;if(null==a||null==r)return e.$message({message:"导出失败，系统异常",type:"error"}),!1;var i=document.createElement("form");document.body.appendChild(i),i.method="post",i.action="/hnm/txCtrl?txcode=mediaFile",i.enctype="multipart/form-data";var o=document.createElement("input"),l=document.createElement("input"),s=document.createElement("input"),n=document.createElement("input");o.setAttribute("name","filePath"),o.setAttribute("type","hidden"),o.setAttribute("value",r),l.setAttribute("name","fileName"),l.setAttribute("type","hidden"),l.setAttribute("value",a),s.setAttribute("name","isDownload"),s.setAttribute("type","hidden"),s.setAttribute("value","1"),n.setAttribute("name","isDelete"),n.setAttribute("type","hidden"),n.setAttribute("value","1"),i.appendChild(o),i.appendChild(l),i.appendChild(s),i.appendChild(n),i.submit(),e.$message({message:"导出成功",type:"success"})})}}}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-button",{attrs:{type:"warning"},on:{click:e.exportPatrolLog}},[e._v("打印巡查表")]),e._v(" "),a("h1",{attrs:{align:"center"}},[e._v("广东南粤银行普惠金融支付服务点合规检查标准")]),e._v(" "),a("el-form",{staticStyle:{"margin-top":"15px"},attrs:{inline:!0,model:e.form}},[a("el-tabs",e._l(e.markSheelList,function(t,r){return a("el-tab-pane",{key:r,attrs:{label:t.content}},e._l(t.list,function(r){return a("div",[a("el-form-item",{attrs:{label:r.content}},["8"!==t.mark_sheel_id&&"9"!==t.mark_sheel_id?a("el-radio-group",{model:{value:e.form[r.mark_sheel_id],callback:function(t){e.$set(e.form,r.mark_sheel_id,t)},expression:"form[cont.mark_sheel_id]"}},[a("el-radio",{attrs:{label:"0"}},[e._v("是")]),e._v(" "),a("el-radio",{attrs:{label:"1"}},[e._v("否")]),e._v(" "),a("el-radio",{attrs:{label:"2"}},[e._v("未检查")])],1):e._e(),e._v(" "),"8"===t.mark_sheel_id?a("div",[a("el-select",{attrs:{clearable:"",placeholder:"请选择"},model:{value:e.form[r.mark_sheel_id],callback:function(t){e.$set(e.form,r.mark_sheel_id,t)},expression:"form[cont.mark_sheel_id]"}},e._l(e.items1,function(e){return a("el-option",{key:e.label,attrs:{label:e.label,value:e.label}})}),1),e._v(" "),a("div",[a("el-form-item",{staticStyle:{width:"100px"},attrs:{label:"签名照片",prop:"patrol_photo"}},[a("el-upload",{ref:"upload",refInFor:!0,class:{disUoloadSty:e.noneBtnImg},attrs:{action:"/hnm/txCtrl?txcode=upload001","list-type":"picture-card","before-upload":e.beforeAvatarUpload,"file-list":e.fileList,data:{business:"patrol",name:"123"},headers:{Accept:"application/json"},"on-success":e.uploadReturn,"on-preview":e.handlePictureCardPreview,"on-remove":e.handleRemove}},[a("i",{staticClass:"el-icon-plus"})]),e._v(" "),a("el-dialog",{attrs:{visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("img",{attrs:{width:"100%",src:e.dialogImageUrl,alt:""}})])],1)],1),e._v(" "),a("h4",[e._v("\n                        服务点发生民间融资、高利贷、非法集资、非法吸收公众存款及其他非法金融业务形式或苗头的，\n                收单机构发现后，应立即向其上级行报告，并于1 个工作日内向当地人民银行报告。"),a("br"),e._v("\n                        对存在欺诈、套现、卡片侧录、利用受理终端不正当牟利、故意使用假币等行为的服务点，\n                银行应中止协议，收回受理终端和标识牌，并及时向当地中国人民银行分支机构报告。涉嫌犯罪的要\n                移送司法部门处理。\n              ")])],1):e._e(),e._v(" "),"9"===t.mark_sheel_id?a("div",[a("el-form-item",[[a("i",{staticStyle:{color:"red"}},[e._v("点击单元格即可编辑内容")]),e._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{"header-cell-class-name":e.starAdd,border:"",data:e.tableData,"max-height":"250"},on:{"cell-click":e.tableDbEdit},model:{value:e.form[r.mark_sheel_id],callback:function(t){e.$set(e.form,r.mark_sheel_id,t)},expression:"form[cont.mark_sheel_id]"}},[a("el-table-column",{attrs:{fixed:"",align:"center",type:"index",prop:"index",label:"序号",width:"50"}}),e._v(" "),a("el-table-column",{attrs:{disabled:"true",align:"center",prop:"ids",label:"工单流水号",width:"80"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"project_name",label:"项目名称",width:"110"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.showInput=="project_name"+t.row.id?a("el-select",{attrs:{filterable:"",size:"small"},on:{change:function(a){return e.blurInput(t.row.id,"pj_classify",t.row.project_name)}},model:{value:t.row.project_name,callback:function(a){e.$set(t.row,"project_name",a)},expression:"scope.row.project_name"}},e._l(e.projectList,function(e){return a("el-option",{key:e.pj_classify,attrs:{label:e.project_name,value:e.project_name,disabled:"系统自动排查"===e.project_name}})}),1):a("span",[e._v(e._s(t.row.project_name))])]}}],null,!0)}),e._v(" "),a("el-table-column",{attrs:{resizable:"","show-overflow-tooltip":"",align:"center",prop:"content_text",label:"问题描述",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.showInput=="content_text"+t.row.id?a("el-input",{directives:[{name:"focusTextarea",rawName:"v-focusTextarea"}],attrs:{type:"textarea",size:"small"},on:{blur:function(a){return e.blurInput(t.row.id,"content_text",t.row.content_text)}},model:{value:t.row.content_text,callback:function(a){e.$set(t.row,"content_text",a)},expression:"scope.row.content_text"}}):a("span",[e._v(e._s(t.row.content_text))])]}}],null,!0)}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"risk_level",label:"风险等级",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.showInput=="risk_level"+t.row.id?a("el-select",{directives:[{name:"focus",rawName:"v-focus"}],attrs:{size:"small"},on:{change:function(a){return e.blurInput(t.row.id,"riskLevel",t.row.risk_level)}},model:{value:t.row.risk_level,callback:function(a){e.$set(t.row,"risk_level",a)},expression:"scope.row.risk_level"}},e._l(e.items2,function(e){return a("el-option",{key:e.label,attrs:{label:e.label,value:e.label}})}),1):a("span",[e._v(e._s(t.row.risk_level))])]}}],null,!0)}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"end_date",label:"整改完成时间",width:"110"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.showInput=="end_date"+t.row.id?a("el-date-picker",{directives:[{name:"focus",rawName:"v-focus"}],attrs:{size:"small","value-format":"yyyy-MM-dd","picker-options":e.setFulltime},on:{blur:function(a){return e.blurInput(t.row.id,"end_date",t.row.end_date)},change:function(a){return e.checkDate(t.row.end_date)}},model:{value:t.row.end_date,callback:function(a){e.$set(t.row,"end_date",a)},expression:"scope.row.end_date"}}):a("span",[e._v(e._s(t.row.end_date))])]}}],null,!0)}),e._v(" "),a("el-table-column",{attrs:{align:"center","show-tooltip-when-overflow":"",resizable:"",prop:"requirement",label:"整改要求",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.showInput=="requirement"+t.row.id?a("el-input",{directives:[{name:"focusTextarea",rawName:"v-focusTextarea"}],attrs:{type:"textarea",size:"small"},on:{blur:function(a){return e.blurInput(t.row.id,"requirement",t.row.requirement)}},model:{value:t.row.requirement,callback:function(a){e.$set(t.row,"requirement",a)},expression:"scope.row.requirement"}}):a("span",[e._v(e._s(t.row.requirement))])]}}],null,!0)}),e._v(" "),a("el-table-column",{attrs:{disabled:"true",align:"center",prop:"responsible",label:"整改人",width:"130"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.showInput=="responsible"+t.row.id?a("el-select",{attrs:{filterable:"","value-key":"account_id",size:"small"},on:{change:function(a){return e.blurInput(t.row.id,"responsible",t.row.responsible)}},model:{value:t.row.responsible,callback:function(a){e.$set(t.row,"responsible",a)},expression:"scope.row.responsible"}},e._l(e.userList,function(t){return a("el-option",{key:t.account_id,attrs:{label:t.name,value:t.account_id}},[a("span",[e._v(e._s(t.name)+"("+e._s(t.account_id)+")")])])}),1):a("span",[e._v(e._s(t.row.responsible))])]}}],null,!0)}),e._v(" "),a("el-table-column",{attrs:{align:"center",fixed:"right",label:"操作",width:"60"},scopedSlots:e._u([{key:"default",fn:function(t){return[1!==t.row.status&&2!==t.row.status&&3!==t.row.status?a("el-button",{attrs:{type:"text",size:"small"},nativeOn:{click:function(a){return a.preventDefault(),e.deleteRow(t.$index,e.tableData)}}},[e._v("\n                          移除\n                        ")]):e._e()]}}],null,!0)})],1),e._v(" "),a("el-button",{attrs:{icon:"el-icon-plus"},on:{click:e.addItem}})]],2)],1):e._e()],1)],1)}),0)}),1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.addOrEditPatLog}},[e._v("\n        保存\n      ")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.reSetValue}},[e._v("\n        重置\n      ")])],1)],1)],1)},staticRenderFns:[]}},function(e,t,a){a(854);var r=a(3)(a(855),a(856),null,null);e.exports=r.exports},function(e,t){},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(120),i=a.n(r),o=a(121),l=a.n(o),s=a(5),n=a.n(s),p=a(10),c=a.n(p),u=a(122),d=a.n(u);t.default={components:{project:d.a,baseTable:n.a,basePage:c.a},data:function(){return{responsible:"",userList:[],projectList:[],fileList:[],role:sessionStorage.getItem("role"),form:{},dialogImageUrl:"",dialogVisible:!1,markSheelList:{},items1:[{label:"情况正常"},{label:"情况异常"}],items2:[{label:"高"},{label:"中"},{label:"低"}],photosNmb:!1,setFulltime:this.disabledDate(),tableData:[],showInput:"",oldData:{},siteId:"",mgr_id:"",inspect_time:"",noneBtnImg:!0}},directives:{focus:{inserted:function(e){"input"==e.tagName.toLocaleLowerCase()?e.focus():e.getElementsByTagName("input")&&e.getElementsByTagName("input")[0].focus(),e.focus()}},focusTextarea:{inserted:function(e){"textarea"==e.tagName.toLocaleLowerCase()?e.focus():e.getElementsByTagName("textarea")&&e.getElementsByTagName("textarea")[0].focus(),e.focus()}}},computed:{bankList:{get:function(){return this.$store.state.bankList},set:function(e){this.$store.state.bankList=e}}},mounted:function(){var e=this;this.inspect_time=this.$route.query.inspect_time,this.$api.getQuitMarkSheel({}).then(function(t){e.markSheelList=t.data.markSheelList,console.log(t)}),this.getPatrolLog(),this.getAccountList(),this.getProjectList()},methods:{checkResul:function(){if("情况正常"===this.form[80101])for(var e=0;e<this.markSheelList.length;e++){var t=this.markSheelList[e];if("8"!==t.mark_sheel_id&&"9"!==t.mark_sheel_id)for(var a=0;a<t.list.length;a++)if(null===this.form[t.list[a].mark_sheel_id]||void 0===this.form[t.list[a].mark_sheel_id]||"1"===this.form[t.list[a].mark_sheel_id])return this.$message.error("巡检条款至少有一项未勾选或存在风险隐患，请将巡查结果修改为”情况异常“并提交巡查问题！"),!1}return!0},getPatrolLog:function(){var e=this;this.$api.getPatrolLog({patrol_id:this.$route.query.patrol_id}).then(function(t){e.fileList=[],e.form=t.data.logList,e.tableData=t.data.logList.contentList,e.form.patrol_photo&&e.$api.getPhotoList({ids:e.form.patrol_photo}).then(function(t){e.fileList=t.data.photoList,e.form.patrol_photo="",e.fileList.map(function(t){t.response={data:[{id:t.name}]},e.form.patrol_photo+="'"+t.response.data[0].id+"',"}),e.form.patrol_photo=e.form.patrol_photo.substr(0,e.form.patrol_photo.length-1),console.log(e.form.patrol_photo)})})},getProjectList:function(){var e=this;this.projectList.length>1||(this.$api.getProjectList({}).then(function(t){e.projectList=t.data}),this.project_name="")},getAccountList:function(){var e=this;0==this.userList.length&&this.$api.getAccountList({}).then(function(t){var a=t.data;if(a)for(var r=0;r<a.length;r++)e.userList=a})},disabledDate:function(){var e=this;return{disabledDate:function(t){var a=new Date(e.inspect_time)-864e5,r=a+78624e5;return t.getTime()<a||t.getTime()>r}}},beforeAvatarUpload:function(e){return"image/png"===e.type||"image/jpg"===e.type||"image/jpeg"===e.type||(this.$message.error("不支持png、jpg、jpeg以外格式的图片"),!1)},starAdd:function(e){if(0!==e.columnIndex&&1!==e.columnIndex&&8!==e.columnIndex)return"star"},checkPhotos:function(e,t){this.$message.error("最多只能上传6张照片")},uploadReturn:function(e,t,a){var r=this;console.log(t),this.form.patrol_photo="",a.map(function(e){r.form.patrol_photo+="'"+e.response.data[0].id+"',"}),this.form.patrol_photo=this.form.patrol_photo.substr(0,this.form.patrol_photo.length-1),this.photosNmb=a.length<4},handleRemove:function(e,t){var a=this;this.form.patrol_photo="",t.map(function(e){a.form.patrol_photo+="'"+e.response.data[0].id+"',"}),this.form.patrol_photo=this.form.patrol_photo.substr(0,this.form.patrol_photo.length-1),this.photosNmb=t.length<4,console.log(this.form.patrol_photo)},handlePictureCardPreview:function(e){this.dialogImageUrl=e.url,this.dialogVisible=!0},blurInput:function(e,t,a){var r=this;return l()(i.a.mark(function e(){var o;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:o={},r.tableData[t]!=a&&(o[t]=a),r.showInput="";case 3:case"end":return e.stop()}},e,r)}))()},tableDbEdit:function(e,t){1!==e.status&&2!==e.status&&3!==e.status&&(this.showInput=t.property+e.id,this.oldData[t.property]=e[t.property])},addItem:function(){this.tableData.push({id:0===this.tableData.length?1:this.tableData[this.tableData.length-1].id+1,content_text:"",risk_level:"",end_date:"",requirement:"",site_no:this.form.site_id,responsible:this.form.mgr_id,project_name:"退出开业巡查"}),console.log(this.tableData)},deleteRow:function(e,t){t.splice(e,1)},addOrEditPatLog:function(){var e=this;if(this.form.patrol_id=this.$route.query.patrol_id,this.form.source=1,void 0===this.form[80101]||null===this.form[80101]||0===this.form[80101].length)return void this.$message.error("请选择巡查结果");if(this.checkResul()){if(void 0===this.form.patrol_photo||null===this.patrol_photo||""===this.form.patrol_photo)return void this.$message.error("请上传巡查照片");if(this.photosNmb)return void this.$message.error("请上传服务点门头、内部环境、业务办理区、村民访谈合影的四张现场照片（照片内显示日期、地点）");console.log(this.photosNmb);for(var t=0;t<this.tableData.length;t++){if(void 0!==this.tableData[t].id&&null!==this.tableData[t].id||(this.tableData[t].id=t+1),void 0===this.tableData[t].content_text||null===this.tableData[t].content_text||0===this.tableData[t].content_text.length)return void this.$message.error("项目名称、问题描述、风险等级、整改时间、整改要求、整改人不可为空");if(void 0===this.tableData[t].project_name||null===this.tableData[t].project_name||0===this.tableData[t].project_name.length)return void this.$message.error("项目名称、问题描述、风险等级、整改时间、整改要求、整改人不可为空");for(var a=this.tableData[t].project_name,r=this.projectList,i=0;i<r.length;i++)r[i].project_name===a&&(this.tableData[t].pj_classify=r[i].pj_classify);if(void 0===this.tableData[t].risk_level||null===this.tableData[t].risk_level||0===this.tableData[t].risk_level.length)return void this.$message.error("项目名称、问题描述、风险等级、整改时间、整改要求、整改人不可为空");if(void 0===this.tableData[t].end_date||null==this.tableData[t].end_date||0===this.tableData[t].end_date.length)return void this.$message.error("项目名称、问题描述、风险等级、整改时间、整改要求、整改人不可为空");if(void 0===this.tableData[t].requirement||null===this.tableData[t].requirement||0===this.tableData[t].requirement.length)return void this.$message.error("项目名称、问题描述、风险等级、整改时间、整改要求、整改人不可为空");if(void 0===this.tableData[t].responsible||null===this.tableData[t].responsible||0===this.tableData[t].responsible.length)return void this.$message.error("项目名称、问题描述、风险等级、整改时间、整改要求、整改人不可为空");if(!this.checkDate(this.tableData[t].end_date))return void this.$message.error("整改时间不能超过巡查时间的90天")}delete this.form.site_id,delete this.form.mgr_id,this.$api.addOrEditPatrolLog(this.form).then(function(t){e.$api.getPatrolLog({patrol_id:e.$route.query.patrol_id}).then(function(t){e.$message.success("保存成功"),e.$router.push({path:"/patrol",name:"巡查管理",query:{}})})})}},reSetValue:function(){this.getPatrolLog()},checkDate:function(e){return!((new Date(e).getTime()-new Date(this.inspect_time).getTime())/24/60/60/1e3>90&&(this.$message.error("整改时间不能超过巡查时间的90天"),1))},exportPatrolLog:function(){var e=this;this.$api.exportPatrolLog({patrol_id:this.$route.query.patrol_id}).then(function(t){var a=t.data.fileName,r=t.data.filePath;if(null==a||null==r)return e.$message({message:"导出失败，系统异常",type:"error"}),!1;var i=document.createElement("form");document.body.appendChild(i),i.method="post",i.action="/hnm/txCtrl?txcode=mediaFile",i.enctype="multipart/form-data";var o=document.createElement("input"),l=document.createElement("input"),s=document.createElement("input"),n=document.createElement("input");o.setAttribute("name","filePath"),o.setAttribute("type","hidden"),o.setAttribute("value",r),l.setAttribute("name","fileName"),l.setAttribute("type","hidden"),l.setAttribute("value",a),s.setAttribute("name","isDownload"),s.setAttribute("type","hidden"),s.setAttribute("value","1"),n.setAttribute("name","isDelete"),n.setAttribute("type","hidden"),n.setAttribute("value","1"),i.appendChild(o),i.appendChild(l),i.appendChild(s),i.appendChild(n),i.submit(),e.$message({message:"导出成功",type:"success"})})}}}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("h1",{attrs:{align:"center"}},[e._v("广东南粤银行普惠金融支付服务点合规检查标准")]),e._v(" "),a("el-form",{staticStyle:{"margin-top":"15px"},attrs:{inline:!0,model:e.form}},[a("el-tabs",e._l(e.markSheelList,function(t,r){return a("el-tab-pane",{key:r,attrs:{label:t.content}},e._l(t.list,function(r){return a("div",[a("el-form-item",{attrs:{label:r.content}},["8"!==t.mark_sheel_id&&"9"!==t.mark_sheel_id?a("el-radio-group",{model:{value:e.form[r.mark_sheel_id],callback:function(t){e.$set(e.form,r.mark_sheel_id,t)},expression:"form[cont.mark_sheel_id]"}},["10101"!==r.mark_sheel_id&&"10106"!==r.mark_sheel_id?a("el-radio",{attrs:{label:"0"}},[e._v("是\n                ")]):e._e(),e._v(" "),"10101"!==r.mark_sheel_id&&"10106"!==r.mark_sheel_id?a("el-radio",{attrs:{label:"1"}},[e._v("否\n                ")]):e._e()],1):e._e(),e._v(" "),"8"!==t.mark_sheel_id&&"9"!==t.mark_sheel_id?a("el-radio-group",{model:{value:e.form[r.mark_sheel_id],callback:function(t){e.$set(e.form,r.mark_sheel_id,t)},expression:"form[cont.mark_sheel_id]"}},["10101"===r.mark_sheel_id||"10106"===r.mark_sheel_id?a("el-radio",{attrs:{label:"0"}},[e._v("否\n                ")]):e._e(),e._v(" "),"10101"===r.mark_sheel_id||"10106"===r.mark_sheel_id?a("el-radio",{attrs:{label:"1"}},[e._v("是\n                ")]):e._e()],1):e._e(),e._v(" "),"8"===t.mark_sheel_id?a("div",[a("el-select",{attrs:{clearable:"",placeholder:"请选择"},on:{change:e.checkResul},model:{value:e.form[r.mark_sheel_id],callback:function(t){e.$set(e.form,r.mark_sheel_id,t)},expression:"form[cont.mark_sheel_id]"}},e._l(e.items1,function(e){return a("el-option",{key:e.label,attrs:{label:e.label,value:e.label}})}),1),e._v(" "),a("p",{staticStyle:{color:"red"}},[e._v("请上传服务点门头、内部环境、业务办理区、村民访谈合影的四张现场照片（照片内显示日期、地点）。")]),e._v(" "),a("div",{staticStyle:{flex:"auto"}},[a("el-form-item",{staticStyle:{width:"1000px"},attrs:{label:"巡查照片",prop:"patrol_photo"}},[a("el-upload",{ref:"upload",refInFor:!0,attrs:{action:"/hnm/txCtrl?txcode=upload001","list-type":"picture-card","before-upload":e.beforeAvatarUpload,"file-list":e.fileList,data:{business:"patrol",name:"123"},headers:{Accept:"application/json"},"on-success":e.uploadReturn,"on-preview":e.handlePictureCardPreview,"on-remove":e.handleRemove,limit:6,"on-exceed":e.checkPhotos}},[a("i",{staticClass:"el-icon-plus"})]),e._v(" "),a("el-dialog",{attrs:{visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("img",{attrs:{width:"100%",src:e.dialogImageUrl,alt:""}})])],1)],1)],1):e._e(),e._v(" "),"9"===t.mark_sheel_id?a("div",[a("el-form-item",[[a("i",{staticStyle:{color:"red"}},[e._v("点击单元格即可编辑内容")]),e._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{"header-cell-class-name":e.starAdd,border:"",data:e.tableData,"max-height":"250"},on:{"cell-click":e.tableDbEdit},model:{value:e.form[r.mark_sheel_id],callback:function(t){e.$set(e.form,r.mark_sheel_id,t)},expression:"form[cont.mark_sheel_id]"}},[a("el-table-column",{attrs:{fixed:"",align:"center",type:"index",prop:"index",label:"序号",width:"50"}}),e._v(" "),a("el-table-column",{attrs:{disabled:"true",align:"center",prop:"ids",label:"工单流水号",width:"80"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"project_name",label:"项目名称",width:"110"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.showInput==="project_name"+t.row.id?a("el-select",{attrs:{filterable:"",size:"small"},on:{change:function(a){return e.blurInput(t.row.id,"pj_classify",t.row.project_name)}},model:{value:t.row.project_name,callback:function(a){e.$set(t.row,"project_name",a)},expression:"scope.row.project_name"}},e._l(e.projectList,function(e){return a("el-option",{key:e.pj_classify,attrs:{label:e.project_name,value:e.project_name,disabled:"系统自动排查"===e.project_name}})}),1):a("span",[e._v(e._s(t.row.project_name))])]}}],null,!0)}),e._v(" "),a("el-table-column",{attrs:{resizable:"","show-overflow-tooltip":"",align:"center",prop:"content_text",label:"问题描述",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.showInput=="content_text"+t.row.id?a("el-input",{directives:[{name:"focusTextarea",rawName:"v-focusTextarea"}],attrs:{type:"textarea",size:"small"},on:{blur:function(a){return e.blurInput(t.row.id,"content_text",t.row.content_text)}},model:{value:t.row.content_text,callback:function(a){e.$set(t.row,"content_text",a)},expression:"scope.row.content_text"}}):a("span",[e._v(e._s(t.row.content_text))])]}}],null,!0)}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"risk_level",label:"风险等级",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.showInput=="risk_level"+t.row.id?a("el-select",{directives:[{name:"focus",rawName:"v-focus"}],attrs:{size:"small"},on:{change:function(a){return e.blurInput(t.row.id,"riskLevel",t.row.risk_level)}},model:{value:t.row.risk_level,callback:function(a){e.$set(t.row,"risk_level",a)},expression:"scope.row.risk_level"}},e._l(e.items2,function(e){return a("el-option",{key:e.label,attrs:{label:e.label,value:e.label}})}),1):a("span",[e._v(e._s(t.row.risk_level))])]}}],null,!0)}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"end_date",label:"整改完成时间",width:"110"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.showInput=="end_date"+t.row.id?a("el-date-picker",{directives:[{name:"focus",rawName:"v-focus"}],attrs:{size:"small","value-format":"yyyy-MM-dd","picker-options":e.setFulltime},on:{blur:function(a){return e.blurInput(t.row.id,"end_date",t.row.end_date)},change:function(a){return e.checkDate(t.row.end_date)}},model:{value:t.row.end_date,callback:function(a){e.$set(t.row,"end_date",a)},expression:"scope.row.end_date"}}):a("span",[e._v(e._s(t.row.end_date))])]}}],null,!0)}),e._v(" "),a("el-table-column",{attrs:{align:"center","show-tooltip-when-overflow":"",resizable:"",prop:"requirement",label:"整改要求",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.showInput=="requirement"+t.row.id?a("el-input",{directives:[{name:"focusTextarea",rawName:"v-focusTextarea"}],attrs:{type:"textarea",size:"small"},on:{blur:function(a){return e.blurInput(t.row.id,"requirement",t.row.requirement)}},model:{value:t.row.requirement,callback:function(a){e.$set(t.row,"requirement",a)},expression:"scope.row.requirement"}}):a("span",[e._v(e._s(t.row.requirement))])]}}],null,!0)}),e._v(" "),a("el-table-column",{attrs:{disabled:"true",align:"center",prop:"responsible",label:"整改人",width:"130"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.showInput=="responsible"+t.row.id?a("el-select",{attrs:{filterable:"","value-key":"account_id",size:"small"},on:{change:function(a){return e.blurInput(t.row.id,"responsible",t.row.responsible)}},model:{value:t.row.responsible,callback:function(a){e.$set(t.row,"responsible",a)},expression:"scope.row.responsible"}},e._l(e.userList,function(t){return a("el-option",{key:t.account_id,attrs:{label:t.name,value:t.account_id}},[a("span",[e._v(e._s(t.name)+"("+e._s(t.account_id)+")")])])}),1):a("span",[e._v(e._s(t.row.responsible))])]}}],null,!0)}),e._v(" "),a("el-table-column",{attrs:{align:"center",fixed:"right",label:"操作",width:"60"},scopedSlots:e._u([{key:"default",fn:function(t){return[1!==t.row.status&&2!==t.row.status&&3!==t.row.status?a("el-button",{attrs:{type:"text",size:"small"},nativeOn:{click:function(a){return a.preventDefault(),e.deleteRow(t.$index,e.tableData)}}},[e._v("\n                            移除\n                          ")]):e._e()]}}],null,!0)})],1),e._v(" "),a("el-button",{attrs:{icon:"el-icon-plus"},on:{click:e.addItem}})]],2)],1):e._e()],1)],1)}),0)}),1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.addOrEditPatLog}},[e._v("\n          保存\n        ")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.reSetValue}},[e._v("\n          重置\n        ")])],1)],1)],1)},staticRenderFns:[]}},function(e,t,a){var r=a(3)(a(858),a(859),null,null);e.exports=r.exports},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(6),i=a.n(r),o=a(5),l=a.n(o),s=a(10),n=a.n(s),p=a(22),c=a.n(p),u=a(117),d=a.n(u);t.default={components:{baseTable:l.a,basePage:n.a,BranchTreePicker:c.a,BranchTreePickerAll:d.a},name:"voucher",data:function(){return{activeName:"voucher1",form:{},bankid:"",bankname:"",orgid:"",orgname:"",siteList:[],sysUserList:[],dataList:[{label:"落地支行",prop:"branch_name"},{label:"服务点编号",prop:"site_no",sort:!0},{label:"服务点名称",prop:"site_name"},{label:"交易日期",prop:"tsdt",sort:!0}],dataList2:[{label:"落地支行",prop:"branch_name"},{label:"服务点编号",prop:"site_no",sort:!0},{label:"服务点名称",prop:"site_name"},{label:"交易日期",prop:"tsdt",sort:!0},{label:"处理人",prop:"creator_name"},{label:"检查结果",prop:"gd_result"}],voucherList:[],pageNum:1,pageSize:10,total:0,visible:!1}},computed:{bankList:{get:function(){return this.$store.state.bankList},set:function(e){this.$store.state.bankList=e}}},mounted:function(){this.getAccountList(),this.getSiteSelectList()},watch:{visible:function(e){e||(this.form={})}},methods:{handleClick:function(e,t){console.log(e,t),this.form={},this.voucherList=[],this.pageNum=1,this.pageSize=10,this.total=0,this.visible=!1,this.getVoucherList()},nodeselectForSerchOrg:function(e){console.log(e),this.orgname=e.branch_name,this.orgid=e.branch_id},nodeselectForSerchBank:function(e){console.log(e),this.bankname=e.branch_name,this.bankid=e.branch_id},getAccountList:function(){var e=this;0==this.sysUserList.length&&this.$api.getAccountList({}).then(function(t){e.sysUserList=t.data})},getSiteSelectList:function(){var e=this;this.$api.getSiteSelectList({all_flag:"1"}).then(function(t){e.siteList=t.data.siteList})},getVoucherList:function(){var e=this;"voucher1"==this.activeName?this.$api.getVoucherList(i()({page:this.pageNum-1,number:this.pageSize,orgid:this.orgid,bankid:this.bankid},this.form)).then(function(t){e.voucherList=t.data.voucherList,e.total=t.data.total}):this.$api.getVoucher2List(i()({page:this.pageNum-1,number:this.pageSize,orgid:this.orgid,bankid:this.bankid},this.form)).then(function(t){t.data.voucherList.map(function(e){return e.gd_result="0"===e.gd_result?"账实相符":"账实不符"}),e.voucherList=t.data.voucherList,e.total=t.data.total})},showVoucher:function(e,t,a,r,i){this.$router.push({path:"/voucherDetail",name:"助农交易详情",query:{tsdt:e,site_no:t,site_name:i,mgr_id:a,mgr_name:r,activeName:this.activeName},params:{searchKey:this.form}})},changeSize:function(e){this.pageSize=e,this.getVoucherList()},changePage:function(e){this.pageNum=e,this.getVoucherList()}},beforeRouteEnter:function(e,t,a){a(function(t){e.params.searchKey&&(t.form=e.params.searchKey),t.getVoucherList()})}}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-tabs",{on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"未处理助农交易",name:"voucher1"}},[a("div",[a("el-form",{staticStyle:{"margin-top":"15px"},attrs:{inline:!0,model:e.form}},[a("el-form-item",{attrs:{label:"交易日期",prop:"start_date"}},[a("el-date-picker",{staticStyle:{width:"200px"},attrs:{type:"date","value-format":"yyyy-MM-dd",clearable:"",placeholder:"选择日期"},model:{value:e.form.start_date,callback:function(t){e.$set(e.form,"start_date",t)},expression:"form.start_date"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"——",prop:"end_date"}},[a("el-date-picker",{staticStyle:{width:"200px"},attrs:{type:"date","value-format":"yyyy-MM-dd",clearable:"",placeholder:"选择日期"},model:{value:e.form.end_date,callback:function(t){e.$set(e.form,"end_date",t)},expression:"form.end_date"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"所属机构",prop:"orgid"}},[a("div",{staticStyle:{display:"flex"}},[a("el-input",{attrs:{size:"small",clearable:""},model:{value:e.orgname,callback:function(t){e.orgname=t},expression:"orgname"}}),e._v(" "),a("BranchTreePicker",{on:{nodeselect:e.nodeselectForSerchOrg}})],1)]),e._v(" "),a("el-form-item",{attrs:{label:"落地支行",prop:"bankid"}},[a("div",{staticStyle:{display:"flex"}},[a("el-input",{attrs:{size:"small",clearable:""},model:{value:e.bankname,callback:function(t){e.bankname=t},expression:"bankname"}}),e._v(" "),a("BranchTreePickerAll",{on:{nodeselect:e.nodeselectForSerchBank}})],1)]),e._v(" "),a("el-form-item",{attrs:{label:"服务点",prop:"site_no"}},[a("el-select",{attrs:{filterable:"",clearable:"",size:"small"},model:{value:e.form.site_no,callback:function(t){e.$set(e.form,"site_no",t)},expression:"form.site_no"}},e._l(e.siteList,function(e){return a("el-option",{key:e.site_no,attrs:{label:e.site_name,value:e.site_no}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"管辖客户经理",prop:"account_id"}},[a("el-select",{attrs:{filterable:"",clearable:"",size:"small"},model:{value:e.form.account_id,callback:function(t){e.$set(e.form,"account_id",t)},expression:"form.account_id"}},e._l(e.sysUserList,function(e){return a("el-option",{key:e.account_id,attrs:{label:e.name,value:e.account_id}})}),1)],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-search"},on:{click:e.getVoucherList}},[e._v("搜索\n                    ")])],1)],1),e._v(" "),a("base-table",{attrs:{list:e.dataList,data:e.voucherList}},[a("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",icon:"el-icon-edit-outline"},on:{click:function(a){return e.showVoucher(t.row.tsdt,t.row.site_no,t.row.mgr_id,t.row.mgr_name,t.row.site_name)}}},[e._v("操作\n                        ")])]}}])})],1),e._v(" "),a("base-page",{attrs:{page:e.pageNum,size:e.pageSize,total:e.total},on:{size:e.changeSize,page:e.changePage}})],1)]),e._v(" "),a("el-tab-pane",{attrs:{label:"已处理助农交易",name:"voucher2"}},[a("div",[a("el-form",{staticStyle:{"margin-top":"15px"},attrs:{inline:!0,model:e.form}},[a("el-form-item",{attrs:{label:"交易日期",prop:"start_date"}},[a("el-date-picker",{staticStyle:{width:"200px"},attrs:{type:"date","value-format":"yyyy-MM-dd",clearable:"",placeholder:"选择日期"},model:{value:e.form.start_date,callback:function(t){e.$set(e.form,"start_date",t)},expression:"form.start_date"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"——",prop:"end_date"}},[a("el-date-picker",{staticStyle:{width:"200px"},attrs:{type:"date","value-format":"yyyy-MM-dd",clearable:"",placeholder:"选择日期"},model:{value:e.form.end_date,callback:function(t){e.$set(e.form,"end_date",t)},expression:"form.end_date"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"所属机构",prop:"orgid"}},[a("div",{staticStyle:{display:"flex"}},[a("el-input",{attrs:{readonly:"",size:"small"},model:{value:e.orgname,callback:function(t){e.orgname=t},expression:"orgname"}}),e._v(" "),a("BranchTreePicker",{on:{nodeselect:e.nodeselectForSerchOrg}})],1)]),e._v(" "),a("el-form-item",{attrs:{label:"落地支行",prop:"bankid"}},[a("div",{staticStyle:{display:"flex"}},[a("el-input",{attrs:{readonly:"",size:"small"},model:{value:e.bankname,callback:function(t){e.bankname=t},expression:"bankname"}}),e._v(" "),a("BranchTreePickerAll",{on:{nodeselect:e.nodeselectForSerchBank}})],1)]),e._v(" "),a("el-form-item",{attrs:{label:"服务点",prop:"site_no"}},[a("el-select",{attrs:{filterable:"",clearable:"",size:"small"},model:{value:e.form.site_no,callback:function(t){e.$set(e.form,"site_no",t)},expression:"form.site_no"}},e._l(e.siteList,function(e){return a("el-option",{key:e.site_no,attrs:{label:e.site_name,value:e.site_no}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"管辖客户经理",prop:"account_id"}},[a("el-select",{attrs:{filterable:"",clearable:"",size:"small"},model:{value:e.form.account_id,callback:function(t){e.$set(e.form,"account_id",t)},expression:"form.account_id"}},e._l(e.sysUserList,function(e){return a("el-option",{key:e.account_id,attrs:{label:e.name,value:e.account_id}})}),1)],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-search"},on:{click:e.getVoucherList}},[e._v("搜索\n                    ")])],1)],1),e._v(" "),a("base-table",{attrs:{list:e.dataList2,data:e.voucherList}},[a("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",icon:"el-icon-edit-outline"},on:{click:function(a){return e.showVoucher(t.row.tsdt,t.row.site_no,t.row.mgr_id,t.row.mgr_name,t.row.site_name)}}},[e._v("详情\n                        ")])]}}])})],1),e._v(" "),a("base-page",{attrs:{page:e.pageNum,size:e.pageSize,total:e.total},on:{size:e.changeSize,page:e.changePage}})],1)])],1)},staticRenderFns:[]}},function(e,t,a){a(861);var r=a(3)(a(862),a(865),"data-v-aecc21de",null);e.exports=r.exports},function(e,t){},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(6),i=a.n(r),o=a(5),l=a.n(o),s=a(10),n=a.n(s),p=a(304),c=a.n(p);t.default={components:{baseTable:l.a,basePage:n.a,measure:c.a},name:"risk_customer",data:function(){return{siteList:[],items:[],items1:[{label:"公安",value:"200501"},{label:"核心系统",value:"999999"},{label:"惠农系统",value:"100001"}],items2:[{label:"高",value:"0"},{label:"中",value:"1"},{label:"低",value:"2"}],item3:[{label:"手动添加",value:"0"},{label:"电信诈骗（黑名单）",value:"1"},{label:"电信诈骗（灰名单）",value:"2"},{label:"7、8类账户",value:"3"},{label:"反洗钱黑名单",value:"6"}],disabled:!1,form:{},showData:[],cust_name:"",cert_no:"",acct_no:"",pageNum:1,pageSize:10,total:0,defaultDate:"2999-12-31"}},methods:{getSiteSelectList:function(){var e=this;this.$api.getSiteSelectList().then(function(t){if(e.siteList=t.data.siteList,null!=e.siteList&&e.siteList.length>0){var a={};a.site_name="全部";var r="";e.siteList.map(function(e){r+="'"+e.site_no+"',"}),r=r.substr(0,r.length-1),a.site_no=r,e.siteList.push(a)}})},computedCertType:function(e){e||(e="000000");var t=this.items.findIndex(function(t){return t.dict_value===e});return this.items[t].dict_name},computedSrc:function(e){var t=this.items1.findIndex(function(t){return t.value===e});return this.items1[t].label},computedRisklevel:function(e){return this.items2[e].label},getRiskCustomer:function(e){var t=this;e&&(this.pageNum=1),this.$api.getRiskCustomer(i()({page:this.pageNum-1,number:this.pageSize},this.form)).then(function(e){t.showData=e.data.returnList,t.total=e.data.total,t.items=e.data.certtype})},changeSize:function(e){this.pageNum=1,this.pageSize=e,this.getRiskCustomer()},changePage:function(e){this.pageNum=e,this.getRiskCustomer()}},mounted:function(){this.getRiskCustomer(),this.getSiteSelectList()}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={name:"measure",data:function(){return{items:[{label:"高",value:"hRishLevel"},{label:"中",value:"mRishLevel"},{label:"低",value:"lRishLevel"}],dialogVisible:!1,tableData:[]}},methods:{addOrEditMeasure:function(){var e=this,t={};t.tableData=this.tableData,this.$api.addOrEditMeasure(t).then(function(){e.$message.success("修改成功"),e.handleClose()})},handleClose:function(){this.dialogVisible=!1},getMeasures:function(){var e=this;this.dialogVisible=!0,this.$api.getMeasures({}).then(function(t){e.tableData=t.data})}}}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{"margin-left":"1px"}},[a("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){return e.getMeasures()}}},[e._v("管控措施")]),e._v(" "),a("el-dialog",{attrs:{title:"风险客户管控",visible:e.dialogVisible,width:"65%"},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-table",{attrs:{border:"",fit:"",stripe:"",data:e.tableData,"element-loading-text":"Loading","header-cell-style":{"text-align":"center"}}},[e._t("head",function(){return[a("el-table-column",{attrs:{align:"center",label:"序号",prop:"id",width:"50"}}),e._v(" "),a("el-table-column",{attrs:{align:"left",label:"管控措施",prop:"measures"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"风险客户管控",width:"220"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-checkbox-button",{attrs:{label:"高","true-label":"0","false-label":"1"},model:{value:t.row.h_risk_level,callback:function(a){e.$set(t.row,"h_risk_level",a)},expression:"scope.row.h_risk_level"}}),e._v(" "),a("el-checkbox-button",{attrs:{label:"中","true-label":"0","false-label":"1"},model:{value:t.row.m_risk_level,callback:function(a){e.$set(t.row,"m_risk_level",a)},expression:"scope.row.m_risk_level"}}),e._v(" "),a("el-checkbox-button",{attrs:{label:"低","true-label":"0","false-label":"1"},model:{value:t.row.l_risk_level,callback:function(a){e.$set(t.row,"l_risk_level",a)},expression:"scope.row.l_risk_level"}})]}}])})]})],2),e._v(" "),a("div",{staticStyle:{"text-align":"center"},attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:e.handleClose}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.addOrEditMeasure}},[e._v("确 定\n      ")])],1)],1)],1)},staticRenderFns:[]}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-form",{staticStyle:{"margin-top":"15px"},attrs:{model:e.form,inline:!0,"label-position":"left"}},[a("el-form-item",{staticStyle:{width:"300px"},attrs:{prop:"risk_level",label:"风险等级",clearable:""}},[a("el-select",{attrs:{clearable:"",size:"small"},model:{value:e.form.risk_level,callback:function(t){e.$set(e.form,"risk_level",t)},expression:"form.risk_level"}},e._l(e.items2,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),a("el-form-item",{staticStyle:{width:"300px"},attrs:{label:"客户姓名",clearable:""}},[a("el-input",{attrs:{size:"small",clearable:""},model:{value:e.form.cust_name,callback:function(t){e.$set(e.form,"cust_name",t)},expression:"form.cust_name"}})],1),e._v(" "),a("el-form-item",{staticStyle:{width:"300px"},attrs:{label:"证件号码"}},[a("el-input",{attrs:{size:"small",clearable:""},model:{value:e.form.cert_num,callback:function(t){e.$set(e.form,"cert_num",t)},expression:"form.cert_num"}})],1),e._v(" "),a("el-form-item",{staticStyle:{width:"300px"},attrs:{label:"证件类型"}},[a("el-select",{attrs:{size:"small",clearable:""},model:{value:e.form.cert_type_cd,callback:function(t){e.$set(e.form,"cert_type_cd",t)},expression:"form.cert_type_cd"}},e._l(e.items,function(e){return a("el-option",{key:e.dict_value,attrs:{label:e.dict_name,value:e.dict_value}})}),1)],1),e._v(" "),a("el-form-item",{staticStyle:{width:"300px"},attrs:{label:"备注",clearable:""}},[a("el-select",{attrs:{clearable:"",size:"small"},model:{value:e.form.type_cd,callback:function(t){e.$set(e.form,"type_cd",t)},expression:"form.type_cd"}},e._l(e.item3,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),a("el-form-item",{staticStyle:{width:"300px"},attrs:{label:"账号",clearable:""}},[a("el-input",{attrs:{size:"small",clearable:""},model:{value:e.form.acct_id,callback:function(t){e.$set(e.form,"acct_id",t)},expression:"form.acct_id"}})],1),e._v(" "),a("el-form-item",{staticStyle:{width:"300px"},attrs:{label:"入库时间"}},[a("el-date-picker",{attrs:{size:"small","value-format":"yyyy-MM-dd",clearable:""},model:{value:e.form.create_time,callback:function(t){e.$set(e.form,"create_time",t)},expression:"form.create_time"}})],1),e._v(" "),a("el-form-item",{staticStyle:{width:"300px"},attrs:{label:"所属服务点"}},[a("el-select",{attrs:{clearable:"",filterable:"",size:"small"},model:{value:e.form.site_no,callback:function(t){e.$set(e.form,"site_no",t)},expression:"form.site_no"}},e._l(e.siteList,function(e){return a("el-option",{key:e.site_no,attrs:{label:e.site_name,value:e.site_no}})}),1)],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-search"},on:{click:function(t){return e.getRiskCustomer(!0)}}},[e._v("搜索\n      ")])],1)],1),e._v(" "),a("el-table",{attrs:{data:e.showData,border:""}},[a("el-table-column",{attrs:{label:"客户姓名",prop:"cust_name",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{label:"所属服务点",prop:"site_name",align:"center",sortable:""}}),e._v(" "),a("el-table-column",{attrs:{label:"证件号码",prop:"cert_num",align:"center",sortable:""}}),e._v(" "),a("el-table-column",{attrs:{label:"账号",prop:"acct_id",align:"center",sortable:""}}),e._v(" "),a("el-table-column",{attrs:{label:"风险等级",prop:"risk_level",align:"center",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return e.items2?[a("span",[e._v("\n          "+e._s(e.computedRisklevel(t.row.risk_level))+"\n        ")])]:void 0}}],null,!0)}),e._v(" "),a("el-table-column",{attrs:{label:"来源",prop:"src",align:"center",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return e.items1?[a("span",[e._v("\n          "+e._s(e.computedSrc(t.row.src))+"\n        ")])]:void 0}}],null,!0)}),e._v(" "),a("el-table-column",{attrs:{label:"入库时间",prop:"create_time",align:"center",sortable:""}}),e._v(" "),a("el-table-column",{attrs:{label:"控制开始日期",prop:"set_ctrl_dt",align:"center",sortable:""}}),e._v(" "),a("el-table-column",{attrs:{label:"控制截至日期",prop:"closing_dt",align:"center",sortable:""}}),e._v(" "),a("el-table-column",{attrs:{label:"备注",prop:"blklisttype",align:"center",sortable:""}})],1),e._v(" "),a("base-page",{attrs:{page:e.pageNum,size:e.pageSize,total:e.total},on:{size:e.changeSize,page:e.changePage}})],1)},staticRenderFns:[]}},function(e,t,a){var r=a(3)(a(867),a(868),null,null);e.exports=r.exports},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(6),i=a.n(r),o=a(33),l=a.n(o),s=a(5),n=a.n(s),p=a(10),c=a.n(p),u=a(304),d=a.n(u);t.default={components:{baseTable:n.a,basePage:c.a,measure:d.a},name:"risk_customer",data:function(){var e=this;return{rules:{cust_name:[{pattern:/^[\u4E00-\u9FA5A-Za-z•]{2,12}$/,required:!0,message:"客户姓名非法",trigger:"blur"}],cert_type_cd:[{message:"请选择证件类型",trigger:"change"}],cert_num:[{pattern:/^[A-Za-z0-9]{6,20}$/,message:"证件号码非法",trigger:"blur"},{validator:function(t,a,r){e.form.acct_id?r():a?r():r(new Error)},message:"证件号码和账号不能同时为空",trigger:"blur"}],acct_id:[{pattern:/^\d+$/,message:"账号非法",trigger:"blur"},{validator:function(t,a,r){e.form.cert_num?r():a?r():r(new Error)},message:"证件号码和账号不能同时为空",trigger:"blur"}],risk_level:[{required:!0,message:"请选择风险等级",trigger:"change"}],set_ctrl_dt:[{required:!0,message:"请选择控制开始日期",trigger:"blur"}],closing_dt:[{required:!0,message:"请选择控制截至日期",trigger:"blur"}]},siteList:[],items:[],items1:[{label:"公安",value:"200501"},{label:"核心系统",value:"999999"},{label:"惠农系统",value:"100001"}],items2:[{label:"高",value:"0"},{label:"中",value:"1"},{label:"低",value:"2"}],item3:[{label:"手动添加",value:"0"},{label:"电信诈骗（黑名单）",value:"1"},{label:"电信诈骗（灰名单）",value:"2"},{label:"7、8类账户",value:"3"},{label:"反洗钱黑名单",value:"6"}],disabled:!1,form:{},info:{},showData:[],cust_name:"",cert_no:"",acct_no:"",pageNum:1,pageSize:10,total:0,defaultDate:"2999-12-31"}},methods:{getSiteSelectList:function(){var e=this;this.$api.getSiteSelectList().then(function(t){if(e.siteList=t.data.siteList,null!=e.siteList&&e.siteList.length>0){var a={};a.site_name="全部";var r="";e.siteList.map(function(e){r+="'"+e.site_no+"',"}),r=r.substr(0,r.length-1),a.site_no=r,e.siteList.push(a)}})},computedCertType:function(e){e||(e="000000");var t=this.items.findIndex(function(t){return t.dict_value===e});return this.items[t].dict_name},computedSrc:function(e){e||(e="999999");var t=this.items1.findIndex(function(t){return t.value===e});return this.items1[t].label},computedRisklevel:function(e){return this.items2[e].label},deleteRiskCustomer:function(e){var t=this;this.$confirm("确定删除选中的数据吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!0}).then(function(){t.$api.deleteRiskCustomer({id:e}).then(function(){t.getRiskCustomer()})})},addOrEditRiskCustomer:function(){var e=this;this.$refs.form.validate(function(t){if(t){if(e.form.cert_num&&!e.form.cert_type_cd)return void e.$message.error("请选择证件类型");e.form.id?e.$api.editRiskCustomer(e.form).then(function(){e.form={},e.getRiskCustomer(),e.handleClose()}):e.$api.addRiskCustomer(e.form).then(function(){e.form={},e.getRiskCustomer(),e.handleClose()})}})},editRiskCustomer:function(e){this.disabled=!0,this.form=JSON.parse(l()(e))},addRiskCustomer:function(){this.disabled=!0,this.form={}},handleClose:function(){this.disabled=!1,this.form={}},getRiskCustomer:function(e){var t=this;e&&(this.pageNum=1),this.$api.getRiskCustomer(i()({page:this.pageNum-1,number:this.pageSize},this.info)).then(function(e){t.total=e.data.total,t.items=e.data.certtype,t.showData=e.data.returnList})},downModal:function(){var e=document.createElement("a");e.download="风险客户导入模版.xls",e.href=this.baseURL+"download/risk_customer_import.xls",e.click()},uploadFile:function(){var e=document.getElementById("file");e.value="",e.click()},chooseFile:function(){var e=this,t=document.getElementById("file"),a=t.files[0];t.value="",this.$api.uploadRiskCustomer({file:a}).then(function(t){if(0===t.fail_count)e.$notify.success("成功导入"+t.success_count+"条数据");else{var a="";a=a.substring(0,a.length-2),e.$notify.info({message:"共导入"+t.total_count+"条数据，"+t.success_count+"条成功，\n              "+t.fail_count+"条失败。"})}e.getRiskCustomer()})},changeSize:function(e){this.pageNum=1,this.pageSize=e,this.getRiskCustomer()},changePage:function(e){this.pageNum=e,this.getRiskCustomer()},exportRiskCustomerInfos:function(){var e=this;delete this.form.page,delete this.form.number,this.$api.exportRiskCustomerInfos(this.form).then(function(t){var a=t.data.fileName,r=t.data.filePath;if(null==a||null==r)return e.$message({message:"导出失败，系统异常",type:"error"}),!1;var i=document.createElement("form");document.body.appendChild(i),i.method="post",i.action="/hnm/txCtrl?txcode=mediaFile",i.enctype="multipart/form-data";var o=document.createElement("input"),l=document.createElement("input"),s=document.createElement("input"),n=document.createElement("input");o.setAttribute("name","filePath"),o.setAttribute("type","hidden"),o.setAttribute("value",r),l.setAttribute("name","fileName"),l.setAttribute("type","hidden"),l.setAttribute("value",a),s.setAttribute("name","isDownload"),s.setAttribute("type","hidden"),s.setAttribute("value","1"),n.setAttribute("name","isDelete"),n.setAttribute("type","hidden"),n.setAttribute("value","1"),i.appendChild(o),i.appendChild(l),i.appendChild(s),i.appendChild(n),i.submit(),e.$message({message:"导出成功",type:"success"})})}},mounted:function(){this.getSiteSelectList(),this.getRiskCustomer()}}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.addRiskCustomer}},[e._v("新增风险客户")]),e._v(" "),a("el-button-group",[a("measure")],1),e._v(" "),a("el-form",{staticStyle:{"margin-top":"15px"},attrs:{model:e.info,inline:!0,"label-position":"left"}},[a("el-form-item",{staticStyle:{width:"300px"},attrs:{label:"风险等级",clearable:""}},[a("el-select",{attrs:{clearable:"",size:"small"},model:{value:e.info.risk_level,callback:function(t){e.$set(e.info,"risk_level",t)},expression:"info.risk_level"}},e._l(e.items2,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),a("el-form-item",{staticStyle:{width:"300px"},attrs:{label:"客户姓名"}},[a("el-input",{attrs:{size:"small",clearable:""},model:{value:e.info.cust_name,callback:function(t){e.$set(e.info,"cust_name",t)},expression:"info.cust_name"}})],1),e._v(" "),a("el-form-item",{staticStyle:{width:"300px"},attrs:{label:"证件类型"}},[a("el-select",{attrs:{size:"small",clearable:""},model:{value:e.info.cert_type_cd,callback:function(t){e.$set(e.info,"cert_type_cd",t)},expression:"info.cert_type_cd"}},e._l(e.items,function(e){return a("el-option",{key:e.dict_value,attrs:{label:e.dict_name,value:e.dict_value}})}),1)],1),e._v(" "),a("el-form-item",{staticStyle:{width:"300px"},attrs:{label:"备注",clearable:""}},[a("el-select",{attrs:{clearable:"",size:"small"},model:{value:e.info.type_cd,callback:function(t){e.$set(e.info,"type_cd",t)},expression:"info.type_cd"}},e._l(e.item3,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),a("el-form-item",{staticStyle:{width:"300px"},attrs:{label:"证件号码"}},[a("el-input",{attrs:{size:"small",clearable:""},model:{value:e.info.cert_num,callback:function(t){e.$set(e.info,"cert_num",t)},expression:"info.cert_num"}})],1),e._v(" "),a("el-form-item",{staticStyle:{width:"300px"},attrs:{label:"账号"}},[a("el-input",{attrs:{size:"small",clearable:""},model:{value:e.info.acct_id,callback:function(t){e.$set(e.info,"acct_id",t)},expression:"info.acct_id"}})],1),e._v(" "),a("el-form-item",{staticStyle:{width:"300px"},attrs:{label:"入库时间"}},[a("el-date-picker",{attrs:{size:"small","value-format":"yyyy-MM-dd",clearable:""},model:{value:e.info.create_time,callback:function(t){e.$set(e.info,"create_time",t)},expression:"info.create_time"}})],1),e._v(" "),a("el-form-item",{staticStyle:{width:"300px"},attrs:{label:"所属服务点"}},[a("el-select",{attrs:{clearable:"",filterable:"",size:"small"},model:{value:e.info.site_no,callback:function(t){e.$set(e.info,"site_no",t)},expression:"info.site_no"}},e._l(e.siteList,function(e){return a("el-option",{key:e.site_no,attrs:{label:e.site_name,value:e.site_no}})}),1)],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-search"},on:{click:function(t){return e.getRiskCustomer(!0)}}},[e._v("搜索\n        ")])],1)],1),e._v(" "),a("el-table",{attrs:{data:e.showData,border:""}},[a("el-table-column",{attrs:{label:"客户姓名",prop:"cust_name",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{label:"所属服务点",prop:"site_name",align:"center",sortable:""}}),e._v(" "),a("el-table-column",{attrs:{label:"证件号码",prop:"cert_num",align:"center",sortable:""}}),e._v(" "),a("el-table-column",{attrs:{label:"账号",prop:"acct_id",align:"center",sortable:""}}),e._v(" "),a("el-table-column",{attrs:{label:"风险等级",prop:"risk_level",align:"center",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return e.items2?[a("span",[e._v("\n            "+e._s(e.computedRisklevel(t.row.risk_level))+"\n          ")])]:void 0}}],null,!0)}),e._v(" "),a("el-table-column",{attrs:{label:"来源",prop:"src",align:"center",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return e.items1?[a("span",[e._v("\n            "+e._s(e.computedSrc(t.row.src))+"\n          ")])]:void 0}}],null,!0)}),e._v(" "),a("el-table-column",{attrs:{label:"入库时间",prop:"create_time",align:"center",sortable:""}}),e._v(" "),a("el-table-column",{attrs:{label:"控制开始日期",prop:"set_ctrl_dt",align:"center",sortable:""}}),e._v(" "),a("el-table-column",{attrs:{label:"控制截至日期",prop:"closing_dt",align:"center",sortable:""}}),e._v(" "),a("el-table-column",{attrs:{label:"备注",prop:"blklisttype",align:"center",sortable:""}}),e._v(" "),a("el-table-column",{staticStyle:{width:"180px"},attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",icon:"el-icon-edit-outline"},on:{click:function(a){return e.editRiskCustomer(t.row)}}},[e._v("编辑\n          ")]),e._v(" "),a("el-button",{staticStyle:{color:"red"},attrs:{type:"text",icon:"el-icon-delete"},on:{click:function(a){return e.deleteRiskCustomer(t.row.id)}}},[e._v("删除\n          ")])]}}])})],1),e._v(" "),a("base-page",{attrs:{page:e.pageNum,size:e.pageSize,total:e.total},on:{size:e.changeSize,page:e.changePage}}),e._v(" "),a("el-dialog",{attrs:{title:e.form.id?"修改":"新增",visible:e.disabled,width:"45%","before-close":e.handleClose,"close-on-click-modal":!1},on:{"update:visible":function(t){e.disabled=t}}},[a("el-form",{ref:"form",attrs:{model:e.form,"label-width":"100px","label-position":"right",rules:e.rules}},[a("el-form-item",{staticStyle:{width:"360px"},attrs:{prop:"cust_name",label:"客户姓名"}},[a("el-input",{attrs:{type:"text",size:"small"},model:{value:e.form.cust_name,callback:function(t){e.$set(e.form,"cust_name",t)},expression:"form.cust_name"}})],1),e._v(" "),a("el-form-item",{staticStyle:{width:"360px"},attrs:{prop:"cert_type_cd",label:"证件类型"}},[a("el-select",{attrs:{clearable:""},model:{value:e.form.cert_type_cd,callback:function(t){e.$set(e.form,"cert_type_cd",t)},expression:"form.cert_type_cd"}},e._l(e.items,function(e){return a("el-option",{key:e.dict_value,attrs:{label:e.dict_name,value:e.dict_value}})}),1)],1),e._v(" "),a("el-form-item",{staticStyle:{width:"360px"},attrs:{prop:"cert_num",label:"证件号码"}},[a("el-input",{attrs:{type:"text",size:"small"},model:{value:e.form.cert_num,callback:function(t){e.$set(e.form,"cert_num",t)},expression:"form.cert_num"}})],1),e._v(" "),a("el-form-item",{staticStyle:{width:"360px"},attrs:{prop:"acct_id",label:"账号"}},[a("el-input",{attrs:{type:"text",size:"small"},model:{value:e.form.acct_id,callback:function(t){e.$set(e.form,"acct_id",t)},expression:"form.acct_id"}})],1),e._v(" "),a("el-form-item",{staticStyle:{width:"360px"},attrs:{prop:"risk_level",label:"风险等级"}},[a("el-select",{attrs:{clearable:""},model:{value:e.form.risk_level,callback:function(t){e.$set(e.form,"risk_level",t)},expression:"form.risk_level"}},e._l(e.items2,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),a("el-form-item",{staticStyle:{width:"500px"},attrs:{prop:"set_ctrl_dt",label:"控制开始日期"}},[a("el-date-picker",{attrs:{size:"small","value-format":"yyyy-MM-dd",type:"date",placeholder:"选择日期"},model:{value:e.form.set_ctrl_dt,callback:function(t){e.$set(e.form,"set_ctrl_dt",t)},expression:"form.set_ctrl_dt"}})],1),e._v(" "),a("el-form-item",{staticStyle:{width:"400px"},attrs:{prop:"closing_dt",label:"控制截至日期"}},[a("el-date-picker",{attrs:{size:"small","value-format":"yyyy-MM-dd",type:"date",placeholder:"选择日期"},model:{value:e.form.closing_dt,callback:function(t){e.$set(e.form,"closing_dt",t)},expression:"form.closing_dt"}})],1)],1),e._v(" "),a("div",{staticStyle:{"text-align":"center"},attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:e.handleClose}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.addOrEditRiskCustomer}},[e._v("确 定\n        ")])],1)],1)],1)},staticRenderFns:[]}},function(e,t,a){a(870),a(871);var r=a(3)(a(872),a(873),"data-v-d33d903c",null);e.exports=r.exports},function(e,t){},function(e,t){},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(6),i=a.n(r),o=a(120),l=a.n(o),s=a(121),n=a.n(s),p=a(5),c=a.n(p);t.default={components:{baseTable:c.a},name:"voucherDetail",data:function(){return{form:{},rules:{gd_result:[{required:!0,message:"检查结果",trigger:"change"}],remarks:[{required:!0,message:"情况说明",trigger:"blur"}]},activeNames:["tranflow","register","gd_result"],tsdt:this.$route.query.tsdt,site_no:this.$route.query.site_no,site_name:this.$route.query.site_name,mgr_id:this.$route.query.mgr_id,mgr_name:this.$route.query.mgr_name,activeName:this.$route.query.activeName,tranflowList:[],dataList:[{label:"凭证号",prop:"f011",sort:!0},{label:"交易时间",prop:"mask_from_v2"},{label:"交易类型",prop:"prid_name"},{label:"卡号",prop:"f002"},{label:"金额",prop:"f004"}],showDelete:!1,showList:{},fileList:[{business:"voucher",code:"voucher01",name:"助农取款登记簿",file_type:0,file_url:""}],voucher_result_list:[],isload:!1,check:!1,visible:!1,showque:!0,questionList:[],showInput:"",items2:[{label:"高"},{label:"中"},{label:"低"}],setFulltime:this.disabledDate(),userList:[],oldData:{}}},directives:{focus:{inserted:function(e){"input"==e.tagName.toLocaleLowerCase()?e.focus():e.getElementsByTagName("input")&&e.getElementsByTagName("input")[0].focus(),e.focus()}},focusTextarea:{inserted:function(e){"textarea"==e.tagName.toLocaleLowerCase()?e.focus():e.getElementsByTagName("textarea")&&e.getElementsByTagName("textarea")[0].focus(),e.focus()}}},mounted:function(){this.getTranflowList(this.tsdt,this.site_no),this.showVoucherDetail(this.tsdt,this.site_no),this.getAccountList()},watch:{visible:function(e){}},methods:{starAdd:function(e){if(0!==e.columnIndex&&1!==e.columnIndex&&7!==e.columnIndex)return"star"},tableDbEdit:function(e,t){1!==e.status&&2!==e.status&&3!==e.status&&(this.showInput=t.property+e.id,this.oldData[t.property]=e[t.property])},blurInput:function(e,t,a){var r=this;return n()(l.a.mark(function e(){var i;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:i={},r.questionList[t]!=a&&(i[t]=a),r.showInput="";case 3:case"end":return e.stop()}},e,r)}))()},disabledDate:function(){return{disabledDate:function(e){var t=new Date-864e5,a=t+78624e5;return e.getTime()<t||e.getTime()>a}}},checkDate:function(e){return!((new Date(e).getTime()-(new Date).getTime())/24/60/60/1e3>90&&(this.$message.error("整改日期不能超过当前日期的90天"),1))},getAccountList:function(){var e=this;0==this.userList.length&&this.$api.getAccountList({}).then(function(t){var a=t.data;if(a)for(var r=0;r<a.length;r++)e.userList=a})},addItem:function(){this.questionList.push({id:0===this.questionList.length?1:this.questionList[this.questionList.length-1].id+1,content_text:"",risk_level:"",end_date:"",requirement:"",site_no:this.site_no,responsible:this.mgr_id,responsible_name:this.mgr_name,pj_classify:"1",pj_classify_name:"定期巡检"})},fun_date:function(e){var t=new Date;return t.setDate(t.getDate()+e),this.addZero(t.getFullYear())+"-"+this.addZero(t.getMonth()+1)+"-"+this.addZero(t.getDate())},addZero:function(e){return parseInt(e)<10&&(e="0"+e),e},showquestion:function(){"voucher1"===this.activeName&&(this.questionList=[],"1"===this.form.gd_result&&this.makequestion())},makequestion:function(){for(var e=this,t=[],a=[],r=0;r<this.fileList.length;r++)void 0!==this.fileList[r].file_id&&null!==this.fileList[r].file_id&&a.push(this.fileList[r].code);this.fileList.forEach(function(e){var r=!1;a.forEach(function(t){t===e.code&&(r=!0)}),r||t.push(e.name)}),null!=t&&t.length>0&&t.forEach(function(t){var a={id:e.questionList.length+1,site_no:e.site_no,pj_classify:"1",pj_classify_name:"定期巡检",content_text:e.site_name+"，"+e.tsdt+"的"+t+"未规范登记",risk_level:"中",end_date:e.fun_date(7),requirement:"请根据《广东南粤银行农村普惠金融支付服务点管理办法》要求开展整改",responsible:e.mgr_id,responsible_name:e.mgr_name};e.questionList.push(a)}),null!=this.tranflowList&&this.tranflowList.length>0&&(null==this.voucher_result_list||0===this.voucher_result_list.length?this.tranflowList.forEach(function(t){var a={id:e.questionList.length+1,site_no:e.site_no,pj_classify:"1",pj_classify_name:"定期巡检",content_text:e.site_name+"，"+e.tsdt+"的"+t.prid_name+"交易(凭证号"+t.f011+")，未规范登记",risk_level:"中",end_date:e.fun_date(7),requirement:"请根据《广东南粤银行农村普惠金融支付服务点管理办法》要求开展整改",responsible:e.mgr_id,responsible_name:e.mgr_name};e.questionList.push(a)}):this.tranflowList.forEach(function(t){var a=!1;if(e.voucher_result_list.forEach(function(e){t.site_no===e.site_no&&t.tsdt===e.tsdt&&t.f011===e.f011&&t.prid===e.prid&&(a=!0)}),!a){var r={id:e.questionList.length+1,site_no:e.site_no,pj_classify:"1",pj_classify_name:"定期巡检",content_text:e.site_name+"，"+e.tsdt+"的"+t.prid_name+"交易(凭证号"+t.f011+")，未规范登记",risk_level:"中",end_date:e.fun_date(7),requirement:"请根据《广东南粤银行农村普惠金融支付服务点管理办法》要求开展整改",responsible:e.mgr_id,responsible_name:e.mgr_name};e.questionList.push(r)}}),this.voucher_result_list.forEach(function(t){if(void 0===t.voucher_result||null==t.voucher_result||"1"===t.voucher_result){var a="";"56"===t.prid?a="小额取款":"57"===t.prid?a="现金汇款":"58"===t.prid&&(a="转账汇款");var r={id:e.questionList.length+1,site_no:e.site_no,pj_classify:"1",pj_classify_name:"定期巡检",content_text:e.site_name+"，"+e.tsdt+"的"+a+"交易(凭证号"+t.f011+")，未规范登记",risk_level:"中",end_date:e.fun_date(7),requirement:"请根据《广东南粤银行农村普惠金融支付服务点管理办法》要求开展整改",responsible:e.mgr_id,responsible_name:e.mgr_name};e.questionList.push(r)}}))},removequestion:function(e,t,a){this.$confirm("确定删除该问题吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!0}).then(function(){a.splice(t,1)}).catch(function(){})},getTranflowList:function(e,t){var a=this;this.$api.getTranflowList({tsdt:e,site_no:t}).then(function(e){a.tranflowList=e.data})},showVoucherDetail:function(e,t){var a=this;this.isload=!0,this.$api.getVoucherDetail({tsdt:e,site_no:t}).then(function(e){if(null!=e.data.voucherDetail&&(a.form=e.data.voucherDetail),null!=e.data.fileList&&e.data.fileList.length>0){a.fileList=a.fileList.concat(e.data.fileList);for(var t=0;t<a.fileList.length;t++)a.fileList[t].id&&(a.fileList[t].file_id=a.fileList[t].id,a.fileList[t].filelastname=a.fileList[t].local_file_path.substring(a.fileList[t].local_file_path.lastIndexOf(".")+1)),"voucher01"===a.fileList[t].code&&(a.fileList[t].name="助农取款登记簿")}null!=e.data.voucher_result_list&&e.data.voucher_result_list.length>0&&(a.voucher_result_list=e.data.voucher_result_list),null!=e.data.questionList&&e.data.questionList.length>0&&(a.questionList=e.data.questionList),a.handleShowList(),a.isload=!1}).catch(function(){a.isload=!1})},handleShowList:function(){var e=this;this.fileList.forEach(function(t){t.url=t.file_url,e.showList[t.code]?t.url&&e.showList[t.code].fileList.push(t):e.$set(e.showList,t.code,{name:t.name,code:t.code,file_type:t.file_type,business:t.business,fileList:t.url?[t]:[]})})},handleRemove:function(e,t,a){var r=void 0;r=e.file_id?e.file_id:e.response.data[0].id,t.splice(a,1),this.fileList=this.fileList.filter(function(e){return e.file_id!==r}),this.showquestion()},beforeAvatarUpload:function(e){console.log(e)},fileUploaded:function(e,t,a){var r=e.data[0];this.fileList[this.fileList.length]={code:e.data[0].code,file_url:e.data[0].file_url,file_id:e.data[0].id,filelastname:e.data[0].local_file_path.substring(e.data[0].local_file_path.lastIndexOf(".")+1)},r.file_url&&this.showList[r.code].fileList.push({code:e.data[0].code,file_url:e.data[0].file_url,file_id:e.data[0].id,filelastname:e.data[0].local_file_path.substring(e.data[0].local_file_path.lastIndexOf(".")+1)}),this.showquestion()},fileUploadedError:function(e,t,a){console.log(JSON.parse(e.message)),this.$message.error(JSON.parse(e.message).tips.message)},addVoucherDetail:function(e,t,a,r,i){var o={tsdt:e,site_no:t,f011:a,prid:r,voucher_result:i},l=[];this.voucher_result_list.forEach(function(e){e.tsdt===o.tsdt&&e.site_no===o.site_no&&e.f011===o.f011&&e.prid===o.prid||l.push(e)}),l.push(o),this.voucher_result_list=l,this.showquestion()},onSubmit:function(){var e=this;if(this.check)return void this.$router.back(-1);this.$refs.form.validate(function(t){if(t){e.form.fileIdList=[],e.form.file_ids=null;for(var a="",r=[],o=0;o<e.fileList.length;o++)void 0!==e.fileList[o].file_id&&null!==e.fileList[o].file_id&&(r.push(e.fileList[o].code),e.form.fileIdList.push(e.fileList[o].file_id));e.fileList.forEach(function(e){var t=!1;r.forEach(function(a){a===e.code&&(t=!0)}),t||(a+=e.name+",")});var l=!0;if("0"===e.form.gd_result){if(a.length>0)return void e.$message.error("请上传助农取款登记簿");if(null!=e.tranflowList&&e.tranflowList.length>0){if(null==e.voucher_result_list||0===e.voucher_result_list.length||e.voucher_result_list.length!==e.tranflowList.length)return void e.$message.error("流水未规范登记，请核查");e.voucher_result_list.forEach(function(t){if(void 0===t.voucher_result||null==t.voucher_result||"1"===t.voucher_result)return e.$message.error("服务点:"+t.site_name+";凭证号:"+t.f011+"未规范登记，请核查"),l=!1,!1})}}else if(null!=e.tranflowList&&e.tranflowList.length>0){if(null==e.voucher_result_list||0===e.voucher_result_list.length||e.voucher_result_list.length!==e.tranflowList.length)return void e.$message.error("流水未规范登记，请核查");e.voucher_result_list.forEach(function(t){if(void 0===t.voucher_result||null==t.voucher_result)return e.$message.error("服务点:"+t.site_name+";凭证号:"+t.f011+"未规范登记，请核查"),l=!1,!1})}if(!l)return;for(var s=0;s<e.questionList.length;s++){if(void 0!==e.questionList[s].id&&null!==e.questionList[s].id||(e.questionList[s].id=s+1),void 0===e.questionList[s].content_text||null===e.questionList[s].content_text||0===e.questionList[s].content_text.length)return void e.$message.error("问题描述、风险等级、整改完成时间、整改要求、整改人不可为空");if(void 0===e.questionList[s].risk_level||null===e.questionList[s].risk_level||0===e.questionList[s].risk_level.length)return void e.$message.error("问题描述、风险等级、整改完成时间、整改要求、整改人不可为空");if(void 0===e.questionList[s].end_date||null==e.questionList[s].end_date||0===e.questionList[s].end_date.length)return void e.$message.error("问题描述、风险等级、整改完成时间、整改要求、整改人不可为空");if(void 0===e.questionList[s].requirement||null===e.questionList[s].requirement||0===e.questionList[s].requirement.length)return void e.$message.error("问题描述、风险等级、整改完成时间、整改要求、整改人不可为空");if(void 0===e.questionList[s].responsible||null===e.questionList[s].responsible||0===e.questionList[s].responsible.length)return void e.$message.error("问题描述、风险等级、整改完成时间、整改要求、整改人不可为空");if(!e.checkDate(e.questionList[s].end_date))return void e.$message.error("整改完成时间不能超过当前时间后的90天")}e.form.fileIdList.length>0&&(e.form.file_ids=e.form.fileIdList.join(",")),e.$api.addVoucher(i()({tsdt:e.tsdt,site_no:e.site_no,voucher_result_list:e.voucher_result_list,questionList:e.questionList},e.form)).then(function(t){e.handleClose(),e.$message.success("操作成功"),e.$router.back(-1)})}})},handleChange:function(e){console.log(e)},handleClose:function(){this.visible=!1,this.form={}}}}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-collapse",{on:{change:e.handleChange},model:{value:e.activeNames,callback:function(t){e.activeNames=t},expression:"activeNames"}},[a("el-collapse-item",{attrs:{title:"交易流水",name:"tranflow"}},[a("base-table",{attrs:{list:e.dataList,data:e.tranflowList}},[a("el-table-column",{attrs:{fixed:"right",label:"操作",align:"center",width:"240"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-radio-group",{model:{value:t.row.voucher_result,callback:function(a){e.$set(t.row,"voucher_result",a)},expression:"scope.row.voucher_result"}},[a("el-radio-button",{attrs:{label:"0"},nativeOn:{click:function(a){return e.addVoucherDetail(t.row.tsdt,t.row.site_no,t.row.f011,t.row.prid,"0")}}},[e._v("登记正确")]),e._v(" "),a("el-radio-button",{attrs:{label:"1"},nativeOn:{click:function(a){return e.addVoucherDetail(t.row.tsdt,t.row.site_no,t.row.f011,t.row.prid,"1")}}},[e._v("登记不正确")])],1)]}}])})],1)],1),e._v(" "),a("el-form",{ref:"form",attrs:{"status-icon":"",rules:e.rules,model:e.form,"label-width":"150px"}},[a("el-collapse-item",{attrs:{title:"助农取款登记簿",name:"register"}},[a("span",{staticStyle:{color:"red"}},[e._v("请拍照并上传交易登记情况")]),e._v(" "),e._l(e.showList,function(t,r){return a("el-form-item",{key:r},[a("div",{staticClass:"uploaditem",staticStyle:{width:"100%",overflow:"auto"}},[e._l(t.fileList,function(r,i){return a("div",{key:i,staticStyle:{position:"relative"},on:{mouseenter:function(t){e.showDelete=!0},mouseleave:function(t){e.showDelete=!1}}},[e.showDelete?a("div",{staticClass:"delete-logo",on:{click:function(a){return e.handleRemove(r,t.fileList,i)}}},[a("i",{staticClass:"el-icon-delete",attrs:{size:"24"}})]):e._e(),e._v(" "),"pdf"!==r.filelastname&&"doc"!==r.filelastname&&"docx"!==r.filelastname&&"xls"!==r.filelastname&&"xlsx"!==r.filelastname&&"txt"!==r.filelastname?a("el-image",{staticClass:"fileimg",attrs:{src:r.file_url,"preview-src-list":[r.file_url]}},[a("div",{staticClass:"imgtigger",attrs:{slot:"error"},slot:"error"},[e._v("没有图片")])]):e._e(),e._v(" "),"doc"===r.filelastname||"docx"===r.filelastname?a("a",{attrs:{target:"_blank",href:r.file_url}},[a("i",{staticClass:"fa fa-file-word-o",attrs:{"aria-hidden":"true"}})]):e._e(),e._v(" "),"xls"===r.filelastname||"xlsx"===r.filelastname?a("a",{attrs:{target:"_blank",href:r.file_url}},[a("i",{staticClass:"fa fa-file-excel-o",attrs:{"aria-hidden":"true"}})]):e._e(),e._v(" "),"pdf"===r.filelastname?a("a",{attrs:{target:"_blank",href:r.file_url}},[a("i",{staticClass:"fa fa-file-pdf-o",attrs:{"aria-hidden":"true"}})]):e._e(),e._v(" "),"txt"===r.filelastname?a("a",{attrs:{target:"_blank",href:r.file_url}},[a("i",{staticClass:"fa fa-file-o",attrs:{"aria-hidden":"true"}})]):e._e()],1)}),e._v(" "),a("el-upload",{ref:"upload",refInFor:!0,staticClass:"upload-demo",attrs:{name:t.code,action:"/hnm/txCtrl?txcode=upload001","show-file-list":!1,"list-type":"picture-card","file-list":t.fileList,"before-upload":e.beforeAvatarUpload,data:{name:t.name,code:t.code,file_type:t.file_type,business:t.business},"on-success":e.fileUploaded,"on-error":e.fileUploadedError,headers:{Accept:"application/json"},disabled:!1}},[a("i",{directives:[{name:"show",rawName:"v-show",value:!0,expression:"true"}],staticClass:"el-icon-plus",attrs:{slot:"default"},slot:"default"})])],2)])})],2),e._v(" "),a("el-collapse-item",{attrs:{title:"检查结果",name:"gd_result"}},[a("el-form-item",{attrs:{label:"检查结果",prop:"gd_result"}},[a("el-select",{attrs:{clearable:"",disabled:!1},on:{change:e.showquestion},model:{value:e.form.gd_result,callback:function(t){e.$set(e.form,"gd_result",t)},expression:"form.gd_result"}},[a("el-option",{key:"0",attrs:{label:"账实相符",value:"0"}}),e._v(" "),a("el-option",{key:"1",attrs:{label:"账实不符",value:"1"}})],1)],1),e._v(" "),a("el-form-item",{staticStyle:{width:"720px"},attrs:{label:"情况说明",prop:"remarks"}},[a("el-input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:4},placeholder:"请输入内容",maxlength:"300","show-word-limit":""},model:{value:e.form.remarks,callback:function(t){e.$set(e.form,"remarks",t)},expression:"form.remarks"}})],1),e._v(" "),e.showque?a("div",[a("el-form-item",[[a("i",{staticStyle:{color:"red"}},[e._v("点击单元格即可编辑内容")]),e._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{"header-cell-class-name":e.starAdd,border:"",data:e.questionList,"max-height":"250"},on:{"cell-click":e.tableDbEdit}},[a("el-table-column",{attrs:{fixed:"",align:"center",type:"index",prop:"index",label:"序号",width:"50"}}),e._v(" "),a("el-table-column",{attrs:{resizable:"","show-overflow-tooltip":"",align:"center",prop:"gd_id",label:"工单流水号",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.gd_id))])]}}],null,!1,3232660663)}),e._v(" "),a("el-table-column",{attrs:{resizable:"","show-overflow-tooltip":"",align:"center",prop:"content_text",label:"问题描述","min-width":"250"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.showInput=="content_text"+t.row.id?a("el-input",{directives:[{name:"focusTextarea",rawName:"v-focusTextarea"}],attrs:{type:"textarea",size:"small"},on:{blur:function(a){return e.blurInput(t.row.id,"content_text",t.row.content_text)}},model:{value:t.row.content_text,callback:function(a){e.$set(t.row,"content_text",a)},expression:"scope.row.content_text"}}):a("span",[e._v(e._s(t.row.content_text))])]}}],null,!1,1932399521)}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"risk_level",label:"风险等级",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.showInput=="risk_level"+t.row.id?a("el-select",{directives:[{name:"focus",rawName:"v-focus"}],attrs:{size:"small"},on:{change:function(a){return e.blurInput(t.row.id,"riskLevel",t.row.risk_level)}},model:{value:t.row.risk_level,callback:function(a){e.$set(t.row,"risk_level",a)},expression:"scope.row.risk_level"}},e._l(e.items2,function(e){return a("el-option",{key:e.label,attrs:{label:e.label,value:e.label}})}),1):a("span",[e._v(e._s(t.row.risk_level))])]}}],null,!1,2110307707)}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"end_date",label:"整改完成时间",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.showInput=="end_date"+t.row.id?a("el-date-picker",{directives:[{name:"focus",rawName:"v-focus"}],attrs:{size:"small","value-format":"yyyy-MM-dd","picker-options":e.setFulltime},on:{blur:function(a){return e.blurInput(t.row.id,"end_date",t.row.end_date)},change:function(a){return e.checkDate(t.row.end_date)}},model:{value:t.row.end_date,callback:function(a){e.$set(t.row,"end_date",a)},expression:"scope.row.end_date"}}):a("span",[e._v(e._s(t.row.end_date))])]}}],null,!1,1336402137)}),e._v(" "),a("el-table-column",{attrs:{align:"center","show-tooltip-when-overflow":"",resizable:"",prop:"requirement",label:"整改要求","min-width":"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.showInput=="requirement"+t.row.id?a("el-input",{directives:[{name:"focusTextarea",rawName:"v-focusTextarea"}],attrs:{type:"textarea",size:"small"},on:{blur:function(a){return e.blurInput(t.row.id,"requirement",t.row.requirement)}},model:{value:t.row.requirement,callback:function(a){e.$set(t.row,"requirement",a)},expression:"scope.row.requirement"}}):a("span",[e._v(e._s(t.row.requirement))])]}}],null,!1,2437399893)}),e._v(" "),a("el-table-column",{attrs:{disabled:"true",align:"center",prop:"responsible",label:"整改人",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.showInput=="responsible"+t.row.id?a("el-select",{attrs:{filterable:"","value-key":"account_id",size:"small"},on:{change:function(a){return e.blurInput(t.row.id,"responsible",t.row.responsible)}},model:{value:t.row.responsible,callback:function(a){e.$set(t.row,"responsible",a)},expression:"scope.row.responsible"}},e._l(e.userList,function(t){return a("el-option",{key:t.account_id,attrs:{label:t.name,value:t.account_id}},[a("span",[e._v(e._s(t.name)+"("+e._s(t.account_id)+")")])])}),1):a("span",[e._v(e._s(t.row.responsible))])]}}],null,!1,833580194)}),e._v(" "),a("el-table-column",{attrs:{align:"center",fixed:"right",label:"操作",width:"60"},scopedSlots:e._u([{key:"default",fn:function(t){return[1!==t.row.status&&2!==t.row.status&&3!==t.row.status?a("el-button",{attrs:{type:"text",size:"small"},nativeOn:{click:function(a){return a.preventDefault(),e.removequestion(t.row.status,t.$index,e.questionList)}}},[e._v("\n                                                移除\n                                            ")]):e._e()]}}],null,!1,3851787808)})],1),e._v(" "),a("el-button",{attrs:{icon:"el-icon-plus"},on:{click:e.addItem}})]],2)],1):e._e()],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{id:"editButton",type:"primary",size:"medium"},on:{click:e.onSubmit}},[e._v("\n                    "+e._s("提交")+"\n                ")])],1)],1)],1)],1)},staticRenderFns:[]}},function(e,t,a){a(875);var r=a(3)(a(876),a(877),"data-v-063a27b9",null);e.exports=r.exports},function(e,t){},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(33),i=a.n(r),o=a(5),l=a.n(o),s=a(10),n=a.n(s),p=a(22),c=a.n(p),u=a(122),d=a.n(u),m=a(77),f=(a.n(m),a(305));a.n(f);t.default={components:{baseTable:l.a,basePage:n.a,BranchTreePicker:c.a,project:d.a},name:"m_error",data:function(){return{dateRange:[],pickerOptions:{shortcuts:[{text:"最近一周",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-6048e5),e.$emit("pick",[a,t])}},{text:"最近一个月",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-2592e6),e.$emit("pick",[a,t])}},{text:"最近三个月",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-7776e6),e.$emit("pick",[a,t])}},{text:"未来一周",onClick:function(e){var t=new Date,a=new Date;t.setTime(t.getTime()+6048e5),e.$emit("pick",[a,t])}},{text:"未来一个月",onClick:function(e){var t=new Date,a=new Date;t.setTime(t.getTime()+2592e6),e.$emit("pick",[a,t])}},{text:"未来三个月",onClick:function(e){var t=new Date,a=new Date;t.setTime(t.getTime()+7776e6),e.$emit("pick",[a,t])}}]},rules:{pj_classify:[{required:!0,message:"请选择巡查项目",trigger:"blur"}],site_no:[{required:!0,message:"请选择机构或服务点",trigger:"blur"}],content_text:[{required:!0,message:"问题描述不可为空",trigger:"blur"}],risk_level:[{required:!0,message:"请选择风险等级",trigger:"blur"}],requirement:[{required:!0,message:"整改要求不能为空",trigger:"blur"}],end_date:[{required:!0,message:"请选择整改时间",trigger:"blur"}],responsible:[{required:!0,message:"请选择整改人员",trigger:"blur"}]},visible:!1,role_id:sessionStorage.getItem("role_id"),role:sessionStorage.getItem("role"),form:{},dataList:[{label:"工单流水号",prop:"id"},{label:"机构或站点名称",prop:"site_name"},{label:"问题描述",prop:"content_text"},{label:"风险等级",prop:"risk_level"},{label:"整改时间",prop:"end_date"},{label:"整改要求",prop:"requirement"},{label:"整改人",prop:"name"}],items:[{label:"未整改",value:0},{label:"已整改",value:1},{label:"无需整改",value:2},{label:"无法整改",value:3}],projectList:[],showData:[],disabled:!1,items2:[{label:"高"},{label:"中"},{label:"低"}],options:[{label:"机构",value:"1",children:[]},{label:"服务点",value:"2",children:[]}],check:!1,delList:[],pageNum:1,pageSize:10,total:0,userList:[],super_manager:this.$loacalData.code_GetEnums(this.$loacalData.listRole,"super_manager").value,bankname:"",bankid:"",status:[]}},computed:{bankList:{get:function(){return this.$store.state.bankList},set:function(e){this.$store.state.bankList=e}},computedStatus:function(){return function(e){return this.items[e].label}}},mounted:function(){var e=this;this.getMerror(),this.geBankList(),this.getSiteSelectList(),this.getAccountList(),this.$api.getProjectList({}).then(function(t){e.projectList=t.data})},methods:{edit:function(e){return!(0===e)},getAccountList:function(){var e=this;0==this.userList.length&&this.$api.getAccountList({}).then(function(t){e.userList=t.data})},handleChange:function(e){this.form.site_no=e[e.length-1]},getSiteSelectList:function(){var e=this;this.$api.getSiteSelectList().then(function(t){var a=t.data.siteList;if(null!=a)for(var r=0;r<a.length;r++){var i={};i.label=a[r].site_name,i.value=a[r].site_no,e.options[1].children.push(i)}})},geBankList:function(){var e=this;this.$api.getBranch({}).then(function(t){var a=t.data;if(a)for(var r=0;r<a.length;r++){var i={};i.label=a[r].branch_name,i.value=a[r].branch_id,e.options[0].children.push(i)}})},getMerror:function(e){var t=this;e&&(this.pageNum=1),null!==this.dateRange&&this.dateRange.length>0?(this.form.start_time=this.dateRange[0],this.form.end_time=this.dateRange[1]):(delete this.form.start_time,delete this.form.end_time),this.form.page=this.pageNum-1,this.form.number=this.pageSize,this.bankid&&(this.form.site_no=this.bankid),null!==this.status&&this.status.length>0&&(this.form.status=this.status),this.$api.getMerror(this.form).then(function(e){t.showData=e.data.resultList,t.total=e.data.total})},handleClose:function(){this.visible=!1,this.form={}},addOrEditMerror:function(){var e=this;this.$refs.form.validate(function(t){e.check?e.handleClose():t&&(e.form.id&&(delete e.form.rn,delete e.form.name),e.$api.addMerror(e.form).then(function(){e.$message.success("提交成功"),e.handleClose(),e.getMerror()}))})},nodeselectForSerch:function(e){console.log(e),this.bankname=e.branch_name,this.bankid=e.branch_id},addView:function(){this.disabled=!1,this.visible=!0,this.form={}},editMerror:function(e,t){e&&(this.disabled=!0),t&&(this.check=t),this.form=JSON.parse(i()(e)),console.log(this.form),this.visible=!0},changeSize:function(e){this.pageNum=1,this.pageSize=e,this.getMerror()},changePage:function(e){this.pageNum=e,this.getMerror()},delOne:function(e){this.delList=[],this.delList.push(e),this.deleteUser()},chooseData:function(e){this.delList=e.map(function(e){return e.id})},deleteUser:function(){var e=this;console.log(this.delList),this.$confirm("确定删除选中的数据吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!0}).then(function(){e.$api.deleteMerror({ids:e.delList}).then(function(t){console.log(t),e.pageNum=1,e.getMerror(),e.$message.success("删除成功"),e.delList=[]})}).catch(function(){e.delList=[]})},uploadFile:function(){var e=document.getElementById("file");e.value="",e.click()},chooseFile:function(){var e=this,t=document.getElementById("file"),a=t.files[0];t.value="",this.$api.uploadMerror({file:a}).then(function(t){if(0==t.fail_count)e.$notify.success("成功导入"+t.success_count+"条数据");else{var a="";a=a.substring(0,a.length-2),e.$notify.info({message:"共导入"+t.total_count+"条数据，"+t.success_count+"条成功，\n              "+t.fail_count+"条失败。"})}e.getMerror()})},downModal:function(){var e=document.createElement("a");e.download="风险信息导入模版.xls",e.href=this.baseURL+"download/error_import.xls",e.click()},exportErrorInfos:function(){var e=this;delete this.form.page,delete this.form.number,null!==this.dateRange&&this.dateRange.length>0?(this.form.start_time=this.dateRange[0],this.form.end_time=this.dateRange[1]):(delete this.form.start_time,delete this.form.end_time),this.$api.exportErrorInfos(this.form).then(function(t){var a=t.data.fileName,r=t.data.filePath;if(null==a||null==r)return e.$message({message:"导出失败，系统异常",type:"error"}),!1;var i=document.createElement("form");document.body.appendChild(i),i.method="post",i.action="/hnm/txCtrl?txcode=mediaFile",i.enctype="multipart/form-data";var o=document.createElement("input"),l=document.createElement("input"),s=document.createElement("input"),n=document.createElement("input");o.setAttribute("name","filePath"),o.setAttribute("type","hidden"),o.setAttribute("value",r),l.setAttribute("name","fileName"),l.setAttribute("type","hidden"),l.setAttribute("value",a),s.setAttribute("name","isDownload"),s.setAttribute("type","hidden"),s.setAttribute("value","1"),n.setAttribute("name","isDelete"),n.setAttribute("type","hidden"),n.setAttribute("value","1"),i.appendChild(o),i.appendChild(l),i.appendChild(s),i.appendChild(n),i.submit(),e.$message({message:"导出成功",type:"success"})})}}}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.addView()}}},[e._v("新增风险信息")]),e._v(" "),a("el-button",{attrs:{type:"danger",size:"small",disabled:0==e.delList.length},on:{click:e.deleteUser}},[e._v("批量删除\n    ")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-folder-add"},on:{click:e.uploadFile}},[e._v("批量导入\n    ")]),e._v(" "),a("el-button",{attrs:{type:"warning",size:"small"},on:{click:e.downModal}},[e._v("下载风险管理导入模版\n    ")]),e._v(" "),a("el-button-group",[a("project")],1),e._v(" "),a("el-button",{attrs:{type:"warning",size:"small"},on:{click:e.exportErrorInfos}},[e._v("导出数据")]),e._v(" "),a("input",{staticStyle:{display:"none"},attrs:{type:"file",id:"file"},on:{change:e.chooseFile}}),e._v(" "),a("el-form",{attrs:{inline:!0,model:e.form}},[a("el-form-item",{staticStyle:{width:"300px"},attrs:{label:"整改人姓名"}},[a("el-select",{attrs:{clearable:"",filterable:"",placeholder:"请输入姓名",size:"small"},model:{value:e.form.responsible,callback:function(t){e.$set(e.form,"responsible",t)},expression:"form.responsible"}},e._l(e.userList,function(t){return a("el-option",{key:t.account_id,attrs:{value:t.account_id,label:t.name}},[a("span",[e._v(e._s(t.name)+"("+e._s(t.account_id)+")")])])}),1)],1),e._v(" "),a("el-form-item",{staticStyle:{width:"300px"},attrs:{label:"工单流水号"}},[a("el-input",{attrs:{clearable:"",size:"small"},model:{value:e.form.id,callback:function(t){e.$set(e.form,"id",t)},expression:"form.id"}})],1),e._v(" "),a("el-form-item",{staticStyle:{width:"300px"},attrs:{prop:"pj_classify",label:"巡查项目"}},[a("el-select",{attrs:{clearable:"",size:"small"},model:{value:e.form.pj_classify,callback:function(t){e.$set(e.form,"pj_classify",t)},expression:"form.pj_classify"}},e._l(e.projectList,function(e){return a("el-option",{key:e.pj_classify,attrs:{label:e.project_name,value:e.pj_classify}})}),1)],1),e._v(" "),a("el-form-item",{staticStyle:{width:"300px"},attrs:{label:"问题描述"}},[a("el-input",{attrs:{filterable:"",clearable:"",size:"small"},model:{value:e.form.content_text,callback:function(t){e.$set(e.form,"content_text",t)},expression:"form.content_text"}})],1),e._v(" "),a("el-form-item",{staticStyle:{width:"300px"},attrs:{label:"整改要求",prop:"requirement"}},[a("el-input",{attrs:{filterable:"",clearable:"",size:"small"},model:{value:e.form.requirement,callback:function(t){e.$set(e.form,"requirement",t)},expression:"form.requirement"}})],1),e._v(" "),a("el-form-item",{staticStyle:{width:"300px"},attrs:{prop:"risk_level",label:"风险等级",size:"small"}},[a("el-select",{attrs:{clearable:""},model:{value:e.form.risk_level,callback:function(t){e.$set(e.form,"risk_level",t)},expression:"form.risk_level"}},e._l(e.items2,function(e){return a("el-option",{key:e.label,attrs:{label:e.label,value:e.label}})}),1)],1),e._v(" "),a("el-form-item",{staticStyle:{width:"340px"},attrs:{label:"机构或站点名称",prop:"site_no"}},[a("el-cascader",{attrs:{options:e.options,filterable:"",clearable:"","show-all-levels":!1,size:"small"},on:{change:e.handleChange},model:{value:e.form.site_no,callback:function(t){e.$set(e.form,"site_no",t)},expression:"form.site_no"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"整改状态",prop:"status"}},[a("el-select",{attrs:{readonly:"",size:"small",clearable:"",multiple:""},model:{value:e.status,callback:function(t){e.status=t},expression:"status"}},e._l(e.items,function(e){return a("el-option",{key:e.value,attrs:{value:e.value,label:e.label}})}),1)],1),e._v(" "),a("el-form-item",{staticStyle:{width:"480px"},attrs:{label:"整改预计完成日期",prop:"rangeDate"}},[a("el-date-picker",{attrs:{clearable:"",type:"daterange",size:"small","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","unlink-panels":"","picker-options":e.pickerOptions,"value-format":"yyyy-MM-dd"},model:{value:e.dateRange,callback:function(t){e.dateRange=t},expression:"dateRange"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-search"},on:{click:function(t){return e.getMerror(!0)}}},[e._v("搜索\n        ")])],1)],1),e._v(" "),a("el-table",{staticStyle:{"table-layout":"fixed"},attrs:{data:e.showData,border:"","row-style":{height:"80px"},"cell-style":{padding:"0"}},on:{"selection-change":e.chooseData}},[a("el-table-column",{attrs:{type:"selection",width:"40"}}),e._v(" "),a("el-table-column",{attrs:{label:"序号",prop:"index",align:"center",type:"index",width:"50"}}),e._v(" "),a("el-table-column",{attrs:{label:"工单流水号",prop:"id",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{label:"机构或站点名称",prop:"site_name",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{label:"问题描述",prop:"content_text",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tooltip",{attrs:{content:t.row.content_text,placement:"top"}},[a("div",{staticClass:"showPart",staticStyle:{height:"70px"}},[e._v(e._s(t.row.content_text))])])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"风险等级",prop:"risk_level",align:"center",width:"60"}}),e._v(" "),a("el-table-column",{attrs:{label:"整改预计完成日期",prop:"end_date",align:"center",width:"100",sortable:""}}),e._v(" "),a("el-table-column",{attrs:{label:"整改要求",prop:"requirement",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tooltip",{attrs:{content:t.row.requirement,placement:"top"}},[a("div",{staticClass:"showPart",staticStyle:{height:"70px"}},[e._v(e._s(t.row.requirement))])])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"整改人",prop:"name",align:"center",width:"80"}}),e._v(" "),a("el-table-column",{attrs:{label:"整改状态",prop:"status",align:"center",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v("\n            "+e._s(e.computedStatus(t.row.status))+"\n          ")])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",align:"center",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[[a("el-button",{attrs:{disabled:e.edit(t.row.status),type:"text",icon:"el-icon-edit-outline"},on:{click:function(a){return e.editMerror(t.row)}}},[e._v("编辑\n            ")]),e._v(" "),a("el-button",{staticStyle:{color:"red"},attrs:{disabled:e.edit(t.row.status),type:"text",icon:"el-icon-delete"},on:{click:function(a){return e.delOne(t.row.id)}}},[e._v("删除\n            ")])]]}}])})],1),e._v(" "),a("base-page",{attrs:{page:e.pageNum,size:e.pageSize,total:e.total},on:{size:e.changeSize,page:e.changePage}}),e._v(" "),a("el-dialog",{attrs:{title:e.form.id?"修改":"新增",visible:e.visible,width:"45%","before-close":e.handleClose},on:{"update:visible":function(t){e.visible=t}}},[a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"90px",disabled:e.check}},[a("el-form-item",{staticStyle:{width:"360px"},attrs:{prop:"pj_classify",label:"巡查项目"}},[a("el-select",{attrs:{filterable:""},model:{value:e.form.pj_classify,callback:function(t){e.$set(e.form,"pj_classify",t)},expression:"form.pj_classify"}},e._l(e.projectList,function(e){return a("el-option",{key:e.pj_classify,attrs:{label:e.project_name,value:e.pj_classify,disabled:"系统自动排查"===e.project_name}})}),1)],1),e._v(" "),a("el-form-item",{staticStyle:{width:"360px"},attrs:{prop:"site_no",label:"机构或站点名称"}},[a("el-cascader",{attrs:{options:e.options,filterable:"","show-all-levels":!1,disabled:e.disabled},on:{change:e.handleChange,"update:disabled":function(t){e.disabled=t}},model:{value:e.form.site_no,callback:function(t){e.$set(e.form,"site_no",t)},expression:"form.site_no"}})],1),e._v(" "),a("el-form-item",{staticStyle:{width:"360px"},attrs:{prop:"content_text",label:"问题描述"}},[a("el-input",{attrs:{type:"textarea",size:"small"},model:{value:e.form.content_text,callback:function(t){e.$set(e.form,"content_text",t)},expression:"form.content_text"}})],1),e._v(" "),a("el-form-item",{staticStyle:{width:"360px"},attrs:{prop:"risk_level",label:"风险等级"}},[a("el-select",{model:{value:e.form.risk_level,callback:function(t){e.$set(e.form,"risk_level",t)},expression:"form.risk_level"}},e._l(e.items2,function(e){return a("el-option",{key:e.label,attrs:{label:e.label,value:e.label}})}),1)],1),e._v(" "),a("el-form-item",{staticStyle:{width:"360px"},attrs:{prop:"end_date",label:"整改时间"}},[a("el-date-picker",{attrs:{size:"small","value-format":"yyyy-MM-dd",type:"date",placeholder:"选择日期"},model:{value:e.form.end_date,callback:function(t){e.$set(e.form,"end_date",t)},expression:"form.end_date"}})],1),e._v(" "),a("el-form-item",{staticStyle:{width:"360px"},attrs:{prop:"requirement",label:"整改要求"}},[a("el-input",{attrs:{type:"textarea",size:"small"},model:{value:e.form.requirement,callback:function(t){e.$set(e.form,"requirement",t)},expression:"form.requirement"}})],1),e._v(" "),a("el-form-item",{staticStyle:{width:"360px"},attrs:{prop:"responsible",label:"整改人"}},[a("el-select",{attrs:{filterable:"",clearable:"",size:"small"},model:{value:e.form.responsible,callback:function(t){e.$set(e.form,"responsible",t)},expression:"form.responsible"}},e._l(e.userList,function(t){return a("el-option",{key:t.account_id,attrs:{label:t.name,value:t.account_id}},[a("span",[e._v(e._s(t.name)+"("+e._s(t.account_id)+")")])])}),1)],1)],1),e._v(" "),a("div",{staticStyle:{"text-align":"center"},attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:e.handleClose}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.addOrEditMerror}},[e._v("确 定\n        ")])],1)],1)],1)},staticRenderFns:[]}},function(e,t,a){a(879);var r=a(3)(a(880),a(881),"data-v-06c71d5c",null);e.exports=r.exports},function(e,t){},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(33),i=a.n(r),o=a(5),l=a.n(o),s=a(10),n=a.n(s),p=a(22),c=a.n(p),u=a(118),d=a.n(u);t.default={components:{baseTable:l.a,basePage:n.a,BranchTreePicker:c.a,approvalHis:d.a},name:"risk",data:function(){return{user:JSON.parse(sessionStorage.getItem("user")),rules:{schedule:[{required:!0,message:"整改进度不能为空",trigger:"blur"}],status:[{required:!0,message:"请选择整改状态",trigger:"blur"}],written:[{required:!0,message:"请选择反馈人姓名",trigger:"blur"}],approval_user:[{required:!0,message:"请选择审批人",trigger:"blur"}]},dateRange:[],pickerOptions:{shortcuts:[{text:"最近一周",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-6048e5),e.$emit("pick",[a,t])}},{text:"最近一个月",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-2592e6),e.$emit("pick",[a,t])}},{text:"最近三个月",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-7776e6),e.$emit("pick",[a,t])}},{text:"未来一周",onClick:function(e){var t=new Date,a=new Date;t.setTime(t.getTime()+6048e5),e.$emit("pick",[a,t])}},{text:"未来一个月",onClick:function(e){var t=new Date,a=new Date;t.setTime(t.getTime()+2592e6),e.$emit("pick",[a,t])}},{text:"未来三个月",onClick:function(e){var t=new Date,a=new Date;t.setTime(t.getTime()+7776e6),e.$emit("pick",[a,t])}}]},status:[0],required:!1,dialogImageUrl:"",dialogVisible:!1,visible:!1,risk:{},fileList:[],showData:[],form:{},flag:!1,disabled:!1,items:[{label:"未整改",value:0},{label:"已整改",value:1},{label:"无需整改",value:2},{label:"无法整改",value:3}],options:[{label:"机构",value:"1",children:[]},{label:"服务点",value:"2",children:[]}],items2:[{label:"高"},{label:"中"},{label:"低"}],use_up:"",delList:[],pageNum:1,pageSize:10,total:0,userList:[],accountList:[],bankname:"",bankid:"",projectList:[],approvalApply:{id:"",approval_status_name:"",approval_user:""}}},computed:{bankList:{get:function(){return this.$store.state.bankList},set:function(e){this.$store.state.bankList=e}},computedStatus:function(){return function(e){return this.items[e].label}}},mounted:function(){var e=this;this.getRisk(),this.geBankList(),this.getSiteSelectList(),this.getAccountList(!0),this.getApprovalQY(),this.$api.getProjectList({}).then(function(t){e.projectList=t.data})},methods:{getApprovalUser:function(){var e=this;(null===this.accountList||this.accountList.length<=0)&&this.$api.getApprovalUser({approval_type:"023",risk_level:this.risk.risk_level}).then(function(t){e.accountList=t.data})},getApprovalQY:function(){var e=this;this.$api.getApprovalQY({approval_type:"023"}).then(function(t){e.use_up=t.data.use_up})},changeRequired:function(e){this.required=1===e},handleRemove:function(e,t){var a=this;this.form.risk_photo="",t.map(function(e){a.form.risk_photo+="'"+e.response.data[0].id+"',"}),this.form.risk_photo=this.form.risk_photo.substr(0,this.form.risk_photo.length-1),console.log(this.form.risk_photo)},handlePictureCardPreview:function(e){this.dialogImageUrl=e.url,this.dialogVisible=!0},uploadReturn:function(e,t,a){var r=this;console.log(t),this.risk.risk_photo="",a.map(function(e){r.risk.risk_photo+="'"+e.response.data[0].id+"',"}),this.risk.risk_photo=this.risk.risk_photo.substr(0,this.risk.risk_photo.length-1),console.log(this.risk.risk_photo)},beforeAvatarUpload:function(e){return"image/png"===e.type||"image/jpg"===e.type||"image/jpeg"===e.type||(this.$message.error("不支持png、jpg、jpeg以外格式的图片"),!1)},tableRowClassName:function(e){return 1===e.row.status?"success-row":""},getAccountList:function(e){var t=this;e?this.$api.getAccountList({deleted:0}).then(function(e){t.userList=e.data}):this.$api.getAccountList({all:""}).then(function(e){t.userList=e.data})},getSiteSelectList:function(){var e=this;this.$api.getSiteSelectList().then(function(t){var a=t.data.siteList;if(null!=a)for(var r=0;r<a.length;r++){var i={};i.label=a[r].site_name,i.value=a[r].site_no,e.options[1].children.push(i)}})},handleChange:function(e){this.form.site_no=e[e.length-1]},geBankList:function(){var e=this;this.$api.getBranch({}).then(function(t){var a=t.data;if(a)for(var r=0;r<a.length;r++){var i={};i.label=a[r].branch_name,i.value=a[r].branch_id,e.options[0].children.push(i)}})},getRisk:function(e){var t=this;e&&(this.pageNum=1),console.log(sessionStorage.getItem("role")),null!==this.dateRange&&this.dateRange.length>0?(this.form.start_time=this.dateRange[0],this.form.end_time=this.dateRange[1]):(delete this.form.start_time,delete this.form.end_time),this.form.page=this.pageNum-1,this.form.number=this.pageSize,this.bankid&&(this.form.site_no=this.bankid),this.form.status=this.status,this.$api.getRisk(this.form).then(function(e){t.showData=e.data.resultList,t.total=e.data.total})},handleClose:function(){this.visible=!1,this.approvalApply={},this.risk={},this.fileList=[],this.flag=!1},addOrEditRisk:function(){var e=this;this.$refs.form.validate(function(t){if(e.flag)e.handleClose();else if(t){var a={};if(a.risk_level=e.risk.risk_level,a.status=e.risk.status,a.id=e.risk.id,a.schedule=e.risk.schedule,a.use_up=e.use_up,a.approval_user=e.risk.approval_user,a.approval_type="023",a.relation_id=e.risk.relation_id,a.written=e.risk.written,1===e.risk.status&&(null===e.risk.risk_photo||void 0===e.risk.risk_photo||e.risk.risk_photo.length<=0))return void e.$message.error("整改图片必需上传");e.risk.risk_photo&&(a.risk_photo=e.risk.risk_photo),e.$api.addOrEditRisk(a).then(function(){e.$message.success("提交整改任务成功"),e.handleClose(),e.getRisk(),e.risk={}})}})},nodeselectForSerch:function(e){console.log(e),this.bankname=e.branch_name,this.bankid=e.branch_id},editRisk:function(e,t){var a=this;this.risk={},t&&(this.flag=!0),e&&(this.risk={},this.disabled=!0,this.visible=!0,this.fileList=[],this.risk=JSON.parse(i()(e)),null!==this.risk.written&&void 0!==this.risk.written||(this.risk.written=this.user.account_id),this.risk.risk_photo&&this.$api.getPhotoList({ids:this.risk.risk_photo}).then(function(e){a.fileList=e.data.photoList,a.risk.risk_photo="",a.fileList.map(function(e){e.response={data:[{id:e.name}]},a.risk.risk_photo+="'"+e.response.data[0].id+"',"}),a.risk.risk_photo=a.risk.risk_photo.substr(0,a.risk.risk_photo.length-1)}),this.risk.relation_id&&this.getApprovalApplyList(this.risk.relation_id),this.getAccountList())},getApprovalApplyList:function(e){var t=this,a=[];this.$api.getApprovalApplyList({page:this.pageNum-1,number:this.pageSize,relation_id:e}).then(function(e){null!==(a=e.data.approvalApplyList)&&a.length>0&&(t.approvalApply=a[0])})},changeSize:function(e){this.pageNum=1,this.pageSize=e,this.getRisk()},changePage:function(e){this.pageNum=e,this.getRisk()},exportExpandRiskInfos:function(){var e=this;delete this.form.page,delete this.form.number,null!=this.form.status&&0!==this.form.status.length||delete this.form.status,null!==this.dateRange&&this.dateRange.length>0?(this.form.start_time=this.dateRange[0],this.form.end_time=this.dateRange[1]):(delete this.form.start_time,delete this.form.end_time),this.$api.exportExpandRiskInfos(this.form).then(function(t){var a=t.data.fileName,r=t.data.filePath;if(null==a||null==r)return e.$message({message:"导出失败，系统异常",type:"error"}),!1;var i=document.createElement("form");document.body.appendChild(i),i.method="post",i.action="/hnm/txCtrl?txcode=mediaFile",i.enctype="multipart/form-data";var o=document.createElement("input"),l=document.createElement("input"),s=document.createElement("input"),n=document.createElement("input");o.setAttribute("name","filePath"),o.setAttribute("type","hidden"),o.setAttribute("value",r),l.setAttribute("name","fileName"),l.setAttribute("type","hidden"),l.setAttribute("value",a),s.setAttribute("name","isDownload"),s.setAttribute("type","hidden"),s.setAttribute("value","1"),n.setAttribute("name","isDelete"),n.setAttribute("type","hidden"),n.setAttribute("value","1"),i.appendChild(o),i.appendChild(l),i.appendChild(s),i.appendChild(n),i.submit(),e.$message({message:"导出成功",type:"success"})})}}}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-button",{attrs:{type:"warning",size:"small"},on:{click:e.exportExpandRiskInfos}},[e._v("导出数据")]),e._v(" "),a("el-form",{staticStyle:{"margin-top":"15px"},attrs:{inline:!0,model:e.form}},[a("el-form-item",{attrs:{label:"整改人姓名"}},[a("el-select",{attrs:{clearable:"",placeholder:"请输入姓名",size:"small",filterable:""},model:{value:e.form.responsible,callback:function(t){e.$set(e.form,"responsible",t)},expression:"form.responsible"}},e._l(e.userList,function(t){return a("el-option",{key:t.account_id,attrs:{value:t.account_id,label:t.name}},[a("span",[e._v(e._s(t.name)+"("+e._s(t.account_id)+")")])])}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"工单流水号"}},[a("el-input",{attrs:{clearable:"",size:"small"},model:{value:e.form.id,callback:function(t){e.$set(e.form,"id",t)},expression:"form.id"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"机构或站点名称"}},[a("el-cascader",{attrs:{options:e.options,filterable:"",clearable:"","show-all-levels":!1,size:"small"},on:{change:e.handleChange},model:{value:e.form.site_no,callback:function(t){e.$set(e.form,"site_no",t)},expression:"form.site_no"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"整改状态",prop:"status"}},[a("el-select",{attrs:{readonly:"",size:"small",clearable:"",multiple:""},model:{value:e.status,callback:function(t){e.status=t},expression:"status"}},e._l(e.items,function(e){return a("el-option",{key:e.value,attrs:{value:e.value,label:e.label}})}),1)],1),e._v(" "),a("el-form-item",{staticStyle:{width:"360px"},attrs:{prop:"pj_classify",label:"巡查项目",size:"small"}},[a("el-select",{attrs:{clearable:""},model:{value:e.form.pj_classify,callback:function(t){e.$set(e.form,"pj_classify",t)},expression:"form.pj_classify"}},e._l(e.projectList,function(e){return a("el-option",{key:e.pj_classify,attrs:{label:e.project_name,value:e.pj_classify}})}),1)],1),e._v(" "),a("el-form-item",{staticStyle:{width:"300px"},attrs:{label:"问题描述"}},[a("el-input",{attrs:{filterable:"",clearable:"",size:"small"},model:{value:e.form.content_text,callback:function(t){e.$set(e.form,"content_text",t)},expression:"form.content_text"}})],1),e._v(" "),a("el-form-item",{staticStyle:{width:"300px"},attrs:{label:"整改要求",prop:"requirement"}},[a("el-input",{attrs:{filterable:"",clearable:"",size:"small"},model:{value:e.form.requirement,callback:function(t){e.$set(e.form,"requirement",t)},expression:"form.requirement"}})],1),e._v(" "),a("el-form-item",{staticStyle:{width:"300px"},attrs:{prop:"risk_level",label:"风险等级"}},[a("el-select",{attrs:{size:"small"},model:{value:e.form.risk_level,callback:function(t){e.$set(e.form,"risk_level",t)},expression:"form.risk_level"}},e._l(e.items2,function(e){return a("el-option",{key:e.label,attrs:{label:e.label,value:e.label}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"整改预计完成日期",prop:"rangeDate"}},[a("el-date-picker",{attrs:{clearable:"",type:"daterange",size:"small","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","unlink-panels":"","picker-options":e.pickerOptions,"value-format":"yyyy-MM-dd"},model:{value:e.dateRange,callback:function(t){e.dateRange=t},expression:"dateRange"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-search"},on:{click:function(t){return e.getRisk(!0)}}},[e._v("搜索\n      ")])],1)],1),e._v(" "),a("el-table",{staticStyle:{"table-layout":"fixed"},attrs:{data:e.showData,"row-class-name":e.tableRowClassName,border:"","row-style":{height:"80px"},"cell-style":{padding:"0"}}},[a("el-table-column",{attrs:{label:"序号",prop:"index",align:"center",type:"index",width:"50"}}),e._v(" "),a("el-table-column",{attrs:{label:"工单流水号",prop:"id",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{label:"机构或站点名称",prop:"site_no",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{label:"巡查项目",prop:"project_name",align:"center",width:"110"}}),e._v(" "),a("el-table-column",{attrs:{label:"问题描述",prop:"content_text",align:"center",resizable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tooltip",{attrs:{content:t.row.content_text,placement:"top"}},[a("div",{staticClass:"resAndsug",staticStyle:{height:"70px"}},[e._v(e._s(t.row.content_text))])])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"风险等级",prop:"risk_level",align:"center",width:"60"}}),e._v(" "),a("el-table-column",{attrs:{label:"整改预计完成日期",prop:"end_date",align:"center",width:"100",sortable:""}}),e._v(" "),a("el-table-column",{attrs:{label:"整改要求",prop:"requirement",align:"center",resizable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tooltip",{attrs:{content:t.row.requirement,placement:"top"}},[a("div",{staticClass:"resAndsug",staticStyle:{height:"70px"}},[e._v(e._s(t.row.requirement))])])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"整改人",prop:"name",align:"center",width:"80"}}),e._v(" "),a("el-table-column",{attrs:{label:"整改状态",prop:"status",align:"center",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v("\n          "+e._s(e.computedStatus(t.row.status)+"("+t.row.approval_status_name+")")+"\n        ")])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",align:"center",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[[a("el-button",{attrs:{type:"text",icon:"el-icon-edit-outline"},on:{click:function(a){return e.editRisk(t.row)}}},[e._v("整改\n          ")])]]}}])})],1),e._v(" "),a("base-page",{attrs:{page:e.pageNum,size:e.pageSize,total:e.total},on:{size:e.changeSize,page:e.changePage}}),e._v(" "),a("el-dialog",{attrs:{title:"整改进度填写",visible:e.visible,width:"75%","before-close":e.handleClose},on:{"update:visible":function(t){e.visible=t}}},[a("el-descriptions",{attrs:{title:"风险信息"}},[a("el-descriptions-item",{attrs:{label:"工单流水号"}},[e._v(e._s(e.risk.id))]),e._v(" "),a("el-descriptions-item",{attrs:{label:"项目名称"}},[e._v(e._s(e.risk.project_name))]),e._v(" "),a("el-descriptions-item",{attrs:{label:"分行名称"}},[e._v(e._s(e.risk.porgid))]),e._v(" "),a("el-descriptions-item",{attrs:{label:"支行名称"}},[e._v(e._s(e.risk.branch_id))]),e._v(" "),a("el-descriptions-item",{attrs:{label:"整改机构或站点"}},[e._v(e._s(e.risk.site_no))]),e._v(" "),a("el-descriptions-item",{attrs:{label:"整改要求"}},[e._v(e._s(e.risk.requirement))]),e._v(" "),a("el-descriptions-item",{attrs:{label:"问题描述"}},[e._v(e._s(e.risk.content_text))]),e._v(" "),a("el-descriptions-item",{attrs:{label:"风险等级"}},[e._v(e._s(e.risk.risk_level))]),e._v(" "),a("el-descriptions-item",{attrs:{label:"问题发现日期"}},[e._v(e._s(e.risk.created))]),e._v(" "),a("el-descriptions-item",{attrs:{label:"问题发现人"}},[e._v(e._s(e.risk.discoverer))]),e._v(" "),a("el-descriptions-item",{attrs:{label:"整改预计完成日期"}},[e._v(e._s(e.risk.end_date))]),e._v(" "),a("el-descriptions-item",{attrs:{label:"问题整改人"}},[e._v(e._s(e.risk.name))]),e._v(" "),a("el-descriptions-item",{attrs:{label:"审核工单号"}},[e._v(e._s(e.approvalApply.id))]),e._v(" "),a("el-descriptions-item",{attrs:{label:"审核状态"}},[e._v(e._s(e.approvalApply.approval_status_name))]),e._v(" "),a("el-descriptions-item",{attrs:{label:"当前审核人"}},[e._v(e._s(e.approvalApply.name))])],1),e._v(" "),a("el-divider"),e._v(" "),a("el-form",{ref:"form",attrs:{model:e.risk,rules:e.rules,"label-width":"90px",disabled:e.flag}},[a("el-row",[a("el-col",{attrs:{span:7}},[a("el-form-item",{attrs:{prop:"schedule",label:"整改完成情况"}},[a("el-input",{attrs:{type:"textarea",size:"small",label:"整改完成情况"},model:{value:e.risk.schedule,callback:function(t){e.$set(e.risk,"schedule",t)},expression:"risk.schedule"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:8}},[a("el-form-item",{staticStyle:{width:"360px"},attrs:{prop:"written",label:"反馈人姓名",disabled:"true"}},[a("el-select",{staticStyle:{width:"150px"},attrs:{filterable:"",clearable:""},nativeOn:{click:function(t){return e.getAccountList(!0)}},model:{value:e.risk.written,callback:function(t){e.$set(e.risk,"written",t)},expression:"risk.written"}},e._l(e.userList,function(t){return a("el-option",{key:t.account_id,attrs:{label:t.name,value:t.account_id}},[a("span",[e._v(e._s(t.name)+"("+e._s(t.account_id)+")")])])}),1)],1)],1),e._v(" "),a("el-col",{attrs:{span:8}},[a("el-form-item",{staticStyle:{width:"360px"},attrs:{prop:"status",label:"整改状态"}},[a("el-select",{staticStyle:{width:"150px"},on:{change:e.changeRequired},model:{value:e.risk.status,callback:function(t){e.$set(e.risk,"status",t)},expression:"risk.status"}},e._l(e.items,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1)],1)],1),e._v(" "),a("el-row",[a("el-col",[a("el-form-item",{attrs:{label:"整改证明",prop:"risk_photo"}},[a("el-upload",{ref:"upload",class:{disUoloadSty:e.flag},attrs:{action:"/hnm/txCtrl?txcode=upload001","list-type":"picture-card","before-upload":e.beforeAvatarUpload,"file-list":e.fileList,data:{business:"risk",name:"123"},headers:{Accept:"application/json"},"on-success":e.uploadReturn,"on-preview":e.handlePictureCardPreview,"on-remove":e.handleRemove,limit:10}},[a("i",{staticClass:"el-icon-plus"})]),e._v(" "),a("el-dialog",{attrs:{visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("img",{attrs:{width:"100%",src:e.dialogImageUrl,alt:""}})])],1)],1)],1),e._v(" "),a("el-row",[0!==e.risk.status&&"1"===e.use_up&&"低"!==e.risk.risk_level?a("el-form-item",{staticStyle:{width:"360px"},attrs:{label:"审批人",prop:"approval_user"}},[a("el-select",{attrs:{clearable:"",filterable:""},nativeOn:{click:function(t){return e.getApprovalUser.apply(null,arguments)}},model:{value:e.risk.approval_user,callback:function(t){e.$set(e.risk,"approval_user",t)},expression:"risk.approval_user"}},e._l(e.accountList,function(t){return a("el-option",{key:t.account_id,attrs:{label:t.name,value:t.account_id}},[a("span",[e._v(e._s(t.name)+"("+e._s(t.account_id)+")")])])}),1)],1):e._e()],1)],1),e._v(" "),a("div",{staticStyle:{"text-align":"center"},attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:e.handleClose}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.addOrEditRisk}},[e._v("确 定\n      ")])],1)],1)],1)},staticRenderFns:[]}},function(e,t,a){var r=a(3)(a(883),a(884),null,null);e.exports=r.exports},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(6),i=a.n(r),o=a(5),l=a.n(o),s=a(10),n=a.n(s);t.default={components:{baseTable:l.a,basePage:n.a},name:"operate",data:function(){return{form:{},dataList:[{label:"规则编号",prop:"operate_no",sort:!0},{label:"规则名称",prop:"operate_name"},{label:"是否启用",prop:"use_up"}],operateList:[],pageNum:1,pageSize:10,total:0,visible:!1}},computed:{rules:function(){return{operate_name:[{required:!0,message:"请输入规则名称",trigger:"blur"}],operate_time:[{required:!0,message:"请输入触发时间",trigger:"blur"}],operate_rate:[{required:!0,message:"请输入触发频率",trigger:"blur"}],operate_condition:[{required:!0,message:"请输入触发条件",trigger:"blur"}],operate_area:[{required:!0,message:"请选择整改范围",trigger:"change"}],operate_risk:[{required:!0,message:"请选择风险等级",trigger:"change"}],operate_day:[{required:!0,message:"请输入整改时间",trigger:"blur"}],operate_content:[{required:!0,message:"请输入问题描述",trigger:"blur"}],operate_requirement:[{required:!0,message:"请输入整改要求",trigger:"blur"}],operate_operno:[{required:!0,message:"请选择处理人",trigger:"change"}],use_up:[{required:!0,message:"请选择是否启用",trigger:"change"}]}}},mounted:function(){},watch:{visible:function(e){e||(this.form={})}},methods:{addOperate:function(){var e=this;this.$refs.form.validate(function(t){if(t){var a=e.form.operate_no,r=e.form.operate_time,i=e.form.operate_rate,o=e.form.operate_condition,l=e.form.operate_content,s=(e.form.operate_requirement,e.form.operate_day);if("1"===a){if(!/^(试营业生效后(0|[1-9][0-9]*)个月后)$/.test(r))return void e.$message.error("触发时间格式不正确");if(!/^(每月[1-9][0-9]*日检查|每月末检查)$/.test(i))return void e.$message.error("触发频率格式不正确");if(!/^(服务点名下账户零售AUM存款余额低于(0|[1-9][0-9]*)万)$/.test(o))return void e.$message.error("触发条件格式不正确");if(!l.startsWith("【服务点】【月份】"))return void e.$message.error("问题描述格式不正确");if(!/^((0|[1-9][0-9]*)天内|本月末)$/.test(s))return void e.$message.error("整改时间格式不正确")}else if("2"===a){var n=/^(试营业生效后(0|[1-9][0-9]*)个月后)$/;if(!n.test(r))return void e.$message.error("触发时间格式不正确");var p=/^(每月[1-9][0-9]*日检查|每月末检查)$/;if(!p.test(i))return void e.$message.error("触发频率格式不正确");var c=/^(服务点已准入(0|[1-9][0-9]*)个月以上，未开业或退出)$/;if(!c.test(o))return void e.$message.error("触发条件格式不正确");if(!l.startsWith("【服务点】"))return void e.$message.error("问题描述格式不正确");var u=/^((0|[1-9][0-9]*)天内|本月末)$/;if(!u.test(s))return void e.$message.error("整改时间格式不正确")}else if("3"===a){var d=/^(开业生效后(0|[1-9][0-9]*)个月后)$/;if(!d.test(r))return void e.$message.error("触发时间格式不正确");var m=/^(每月[1-9][0-9]*日检查|每月末检查)$/;if(!m.test(i))return void e.$message.error("触发频率格式不正确");var f=/^(服务点名下账户零售AUM存款余额低于(0|[1-9][0-9]*)万)$/;if(!f.test(o))return void e.$message.error("触发条件格式不正确");if(!l.startsWith("【服务点】【月份】"))return void e.$message.error("问题描述格式不正确");var _=/^((0|[1-9][0-9]*)天内|本月末)$/;if(!_.test(s))return void e.$message.error("整改时间格式不正确")}else if("4"===a){var h=/^(开业生效后(0|[1-9][0-9]*)个月后)$/;if(!h.test(r))return void e.$message.error("触发时间格式不正确");var v=/^(每月[1-9][0-9]*日检查|每月末检查)$/;if(!v.test(i))return void e.$message.error("触发频率格式不正确");var b=/^(近(0|[1-9][0-9]*)天未发生(0|[1-9][0-9]*)笔助农取款业务（不含查询）)$/;if(!b.test(o))return void e.$message.error("触发条件格式不正确");if(!l.startsWith("【服务点】"))return void e.$message.error("问题描述格式不正确");var g=/^((0|[1-9][0-9]*)天内|本月末)$/;if(!g.test(s))return void e.$message.error("整改时间格式不正确")}else if("5"===a){var y=/^(开业生效后(0|[1-9][0-9]*)个月后)$/;if(!y.test(r))return void e.$message.error("触发时间格式不正确");var k=/^(每季末检查)$/;if(!k.test(i))return void e.$message.error("触发频率格式不正确");var x=/^(助农取款登记簿，季度出现(0|[1-9][0-9]*)笔以上登记不符合要求)$/;if(!x.test(o))return void e.$message.error("触发条件格式不正确");if(!l.startsWith("【服务点】【季度】"))return void e.$message.error("问题描述格式不正确");var $=/^((0|[1-9][0-9]*)天内|本月末)$/;if(!$.test(s))return void e.$message.error("整改时间格式不正确")}else if("6"===a){var w=/^(开业生效后(0|[1-9][0-9]*)个月后)$/;if(!w.test(r))return void e.$message.error("触发时间格式不正确");var L=/^(每季末检查)$/;if(!L.test(i))return void e.$message.error("触发频率格式不正确");var S=/^(季度出现(0|[1-9][0-9]*)次以上（含）巡检不合格)$/;if(!S.test(o))return void e.$message.error("触发条件格式不正确");if(!l.startsWith("【服务点】【季度】"))return void e.$message.error("问题描述格式不正确");var A=/^((0|[1-9][0-9]*)天内|本月末)$/;if(!A.test(s))return void e.$message.error("整改时间格式不正确")}else if("7"===a){var D=/^(开业生效后(0|[1-9][0-9]*)个月后)$/;if(!D.test(r))return void e.$message.error("触发时间格式不正确");var C=/^(每月[1-9][0-9]*日检查|每月末检查)$/;if(!C.test(i))return void e.$message.error("触发频率格式不正确");var z=/^(T-(0|[1-9][0-9]*)月，助农取款交易没有勾兑)$/;if(!z.test(o))return void e.$message.error("触发条件格式不正确");if(!l.startsWith("【服务点】【月份】"))return void e.$message.error("问题描述格式不正确");var q=/^((0|[1-9][0-9]*)天内|本月末)$/;if(!q.test(s))return void e.$message.error("整改时间格式不正确")}else if("8"===a){var T=/^(开业生效后(0|[1-9][0-9]*)个月后)$/;if(!T.test(r))return void e.$message.error("触发时间格式不正确");var E=/^(每月[1-9][0-9]*日检查|每月末检查)$/;if(!E.test(i))return void e.$message.error("触发频率格式不正确");var j=/^(上月未提交巡检报告)$/;if(!j.test(o))return void e.$message.error("触发条件格式不正确");if(!l.startsWith("【服务点】【月份】"))return void e.$message.error("问题描述格式不正确");var P=/^((0|[1-9][0-9]*)天内|本月末)$/;if(!P.test(s))return void e.$message.error("整改时间格式不正确")}else if("9"===a){var O=/^(开业生效后(0|[1-9][0-9]*)个月后)$/;if(!O.test(r))return void e.$message.error("触发时间格式不正确");var N=/^(每月[1-9][0-9]*日检查|每月末检查)$/;if(!N.test(i))return void e.$message.error("触发频率格式不正确");var R=/^(本月未提交巡检报告)$/;if(!R.test(o))return void e.$message.error("触发条件格式不正确");if(!l.startsWith("【服务点】【月份】"))return void e.$message.error("问题描述格式不正确");var I=/^((0|[1-9][0-9]*)天内|本月末)$/;if(!I.test(s))return void e.$message.error("整改时间格式不正确")}else if("10"===a){var M=/^(开业生效后(0|[1-9][0-9]*)个月后)$/;if(!M.test(r))return void e.$message.error("触发时间格式不正确");var B=/^(每月[1-9][0-9]*日检查|每月末检查)$/;if(!B.test(i))return void e.$message.error("触发频率格式不正确");var F=/^(涉及(0|[1-9][0-9]*)个及以上账户，向同一个账户转账汇款或现金转账，金额(0|[1-9][0-9]*)万及以上)$/;if(!F.test(o))return void e.$message.error("触发条件格式不正确");if(!l.startsWith("【服务点】【月份】【账户】"))return void e.$message.error("问题描述格式不正确");var U=/^((0|[1-9][0-9]*)天内|本月末)$/;if(!U.test(s))return void e.$message.error("整改时间格式不正确")}else if("11"===a){var G=/^(开业生效后(0|[1-9][0-9]*)个月后)$/;if(!G.test(r))return void e.$message.error("触发时间格式不正确");var V=/^(每日检查)$/;if(!V.test(i))return void e.$message.error("触发频率格式不正确");var H=/^(夜间(0|[1-9]|[1][0-9]|[2][0-4])点到次日(0|[1-9]|[1][0-9]|[2][0-4])点内发生(0|[1-9][0-9]*)笔以上资金变动交易)$/;if(!H.test(o))return void e.$message.error("触发条件格式不正确");if(!l.startsWith("【服务点】【日期】"))return void e.$message.error("问题描述格式不正确");var K=/^((0|[1-9][0-9]*)天内|本月末)$/;if(!K.test(s))return void e.$message.error("整改时间格式不正确")}e.form.operate_area=e.form.operate_area.join(","),e.$api.addOperate(e.form).then(function(t){e.handleClose(),e.getOperateList()}).catch(function(){})}})},editOperate:function(e){var t=this;this.form={},this.$api.getOperate({id:e}).then(function(e){console.log(e),t.visible=!0,t.form=e.data.msg[0],e.data.msg[0].operate_area&&(t.form.operate_area=e.data.msg[0].operate_area.split(","))})},getOperateList:function(){var e=this;this.$api.getOperateList(i()({page:this.pageNum-1,number:this.pageSize},this.form)).then(function(t){t.data.operateList.map(function(e){return e.use_up="0"===e.use_up?"否":"是"}),e.operateList=t.data.operateList,e.total=t.data.total})},changeSize:function(e){this.pageSize=e,this.getOperateList()},changePage:function(e){this.pageNum=e,this.getOperateList()},handleClose:function(){this.visible=!1,this.form={}},exportOperateInfos:function(){var e=this;delete this.form.page,delete this.form.number,this.$api.exportOperateInfos(this.form).then(function(t){var a=t.data.fileName,r=t.data.filePath;if(null==a||null==r)return e.$message({message:"导出失败，系统异常",type:"error"}),!1;var i=document.createElement("form");document.body.appendChild(i),i.method="post",i.action="/hnm/txCtrl?txcode=mediaFile",i.enctype="multipart/form-data";var o=document.createElement("input"),l=document.createElement("input"),s=document.createElement("input"),n=document.createElement("input");o.setAttribute("name","filePath"),o.setAttribute("type","hidden"),o.setAttribute("value",r),l.setAttribute("name","fileName"),l.setAttribute("type","hidden"),l.setAttribute("value",a),s.setAttribute("name","isDownload"),s.setAttribute("type","hidden"),s.setAttribute("value","1"),n.setAttribute("name","isDelete"),n.setAttribute("type","hidden"),n.setAttribute("value","1"),i.appendChild(o),i.appendChild(l),i.appendChild(s),i.appendChild(n),i.submit(),e.$message({message:"导出成功",type:"success"})})}},beforeRouteEnter:function(e,t,a){a(function(t){e.params.searchKey&&(t.form=e.params.searchKey),t.getOperateList()})}}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-button",{attrs:{type:"warning",size:"small"},on:{click:e.exportOperateInfos}},[e._v("批量导出\n    ")]),e._v(" "),a("el-form",{staticStyle:{"margin-top":"15px"},attrs:{inline:!0,model:e.form}},[a("el-form-item",{attrs:{label:"规则编号"}},[a("el-input",{attrs:{clearable:"",placeholder:"请输入规则编号",size:"small"},model:{value:e.form.operate_no,callback:function(t){e.$set(e.form,"operate_no",t)},expression:"form.operate_no"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"规则名称"}},[a("el-input",{attrs:{clearable:"",placeholder:"请输入规则名称",size:"small"},model:{value:e.form.operate_name,callback:function(t){e.$set(e.form,"operate_name",t)},expression:"form.operate_name"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-search"},on:{click:e.getOperateList}},[e._v("搜索\n        ")])],1)],1),e._v(" "),a("base-table",{attrs:{list:e.dataList,data:e.operateList}},[a("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",icon:"el-icon-edit-outline"},on:{click:function(a){return e.editOperate(t.row.id)}}},[e._v("编辑\n          ")])]}}])})],1),e._v(" "),a("base-page",{attrs:{page:e.pageNum,size:e.pageSize,total:e.total},on:{size:e.changeSize,page:e.changePage}}),e._v(" "),a("el-dialog",{attrs:{title:"修改规则",visible:e.visible,width:"45%","before-close":e.handleClose},on:{"update:visible":function(t){e.visible=t}}},[a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"90px"}},[a("el-form-item",{attrs:{label:"规则编号",prop:"operate_no"}},[a("el-input",{attrs:{size:"small",disabled:!0},model:{value:e.form.operate_no,callback:function(t){e.$set(e.form,"operate_no",t)},expression:"form.operate_no"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"规则名称",prop:"operate_name"}},[a("el-input",{attrs:{size:"small"},model:{value:e.form.operate_name,callback:function(t){e.$set(e.form,"operate_name",t)},expression:"form.operate_name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"触发时间",prop:"operate_time"}},[a("el-input",{attrs:{size:"small"},model:{value:e.form.operate_time,callback:function(t){e.$set(e.form,"operate_time",t)},expression:"form.operate_time"}}),e._v(" "),"1"==e.form.operate_no||"2"==e.form.operate_no?a("div",{staticStyle:{color:"#cccccc","font-size":"small"}},[e._v('\n            *为可自定义参数："试营业生效后'),a("span",{staticStyle:{color:"red"}},[e._v("*")]),e._v('个月后"\n          ')]):"12"==e.form.operate_no?a("div",{staticStyle:{color:"#cccccc","font-size":"small"}},[e._v('*为可自定义参数："开业转退出或转试营业后'),a("span",{staticStyle:{color:"red"}},[e._v("*")]),e._v('天"\n          ')]):a("div",{staticStyle:{color:"#cccccc","font-size":"small"}},[e._v('*为可自定义参数："开业生效后'),a("span",{staticStyle:{color:"red"}},[e._v("*")]),e._v('个月后"')])],1),e._v(" "),a("el-form-item",{attrs:{label:"触发频率",prop:"operate_rate"}},[a("el-input",{attrs:{size:"small"},model:{value:e.form.operate_rate,callback:function(t){e.$set(e.form,"operate_rate",t)},expression:"form.operate_rate"}}),e._v(" "),"1"==e.form.operate_no||"2"==e.form.operate_no||"3"==e.form.operate_no||"4"==e.form.operate_no||"7"==e.form.operate_no||"8"==e.form.operate_no||"9"==e.form.operate_no||"10"==e.form.operate_no?a("div",{staticStyle:{color:"#cccccc","font-size":"small"}},[e._v('*为可自定义参数："每月末检查 或 每月'),a("span",{staticStyle:{color:"red"}},[e._v("*")]),e._v('日检查"\n          ')]):e._e()],1),e._v(" "),a("el-form-item",{attrs:{label:"触发条件",prop:"operate_condition"}},[a("el-input",{attrs:{size:"small"},model:{value:e.form.operate_condition,callback:function(t){e.$set(e.form,"operate_condition",t)},expression:"form.operate_condition"}}),e._v(" "),"1"==e.form.operate_no?a("div",{staticStyle:{color:"#cccccc","font-size":"small"}},[e._v('*为可自定义参数："服务点名下账户零售AUM存款余额低于'),a("span",{staticStyle:{color:"red"}},[e._v("*")]),e._v('万"\n          ')]):e._e(),e._v(" "),"2"==e.form.operate_no?a("div",{staticStyle:{color:"#cccccc","font-size":"small"}},[e._v('*为可自定义参数："服务点已准入'),a("span",{staticStyle:{color:"red"}},[e._v("*")]),e._v('个月以上，未开业或退出"\n          ')]):e._e(),e._v(" "),"3"==e.form.operate_no?a("div",{staticStyle:{color:"#cccccc","font-size":"small"}},[e._v('*为可自定义参数："服务点名下账户零售AUM存款余额低于'),a("span",{staticStyle:{color:"red"}},[e._v("*")]),e._v('万"\n          ')]):e._e(),e._v(" "),"4"==e.form.operate_no?a("div",{staticStyle:{color:"#cccccc","font-size":"small"}},[e._v('*为可自定义参数："近'),a("span",{staticStyle:{color:"red"}},[e._v("*")]),e._v("天未发生"),a("span",{staticStyle:{color:"red"}},[e._v("*")]),e._v('笔助农取款业务（不含查询）"\n          ')]):e._e(),e._v(" "),"5"==e.form.operate_no?a("div",{staticStyle:{color:"#cccccc","font-size":"small"}},[e._v('*为可自定义参数："助农取款登记簿，季度出现'),a("span",{staticStyle:{color:"red"}},[e._v("*")]),e._v('笔以上登记不符合要求"\n          ')]):e._e(),e._v(" "),"6"==e.form.operate_no?a("div",{staticStyle:{color:"#cccccc","font-size":"small"}},[e._v('*为可自定义参数："季度出现'),a("span",{staticStyle:{color:"red"}},[e._v("*")]),e._v('次以上（含）巡检不合格"\n          ')]):e._e(),e._v(" "),"7"==e.form.operate_no?a("div",{staticStyle:{color:"#cccccc","font-size":"small"}},[e._v('*为可自定义参数："T-'),a("span",{staticStyle:{color:"red"}},[e._v("*")]),e._v('月，助农取款交易没有勾兑"\n          ')]):e._e(),e._v(" "),"10"==e.form.operate_no?a("div",{staticStyle:{color:"#cccccc","font-size":"small"}},[e._v('*为可自定义参数："涉及'),a("span",{staticStyle:{color:"red"}},[e._v("*")]),e._v("个及以上账户，向同一个账户转账汇款或现金转账，金额"),a("span",{staticStyle:{color:"red"}},[e._v("*")]),e._v('万及以上"\n          ')]):e._e(),e._v(" "),"11"==e.form.operate_no?a("div",{staticStyle:{color:"#cccccc","font-size":"small"}},[e._v('*为可自定义参数："夜间'),a("span",{staticStyle:{color:"red"}},[e._v("*")]),e._v("点到次日"),a("span",{staticStyle:{color:"red"}},[e._v("*")]),e._v("点内发生"),a("span",{staticStyle:{color:"red"}},[e._v("*")]),e._v('笔以上资金变动交易"\n          ')]):e._e(),e._v(" "),"13"===e.form.operate_no||"14"===e.form.operate_no||"15"===e.form.operate_no?a("div",{staticStyle:{color:"#cccccc","font-size":"small"}},[e._v('\n            *为可自定义参数："偏离度'),a("span",{staticStyle:{color:"red"}},[e._v("*")]),e._v("%---"),a("span",{staticStyle:{color:"red"}},[e._v("*")]),e._v("%且交易基数大于或等于"),a("span",{staticStyle:{color:"red"}},[e._v("*")]),e._v('笔"\n          ')]):e._e(),e._v(" "),"16"===e.form.operate_no?a("div",{staticStyle:{color:"#cccccc","font-size":"small"}},[e._v('\n            *为可自定义参数："偏离度'),a("span",{staticStyle:{color:"red"}},[e._v("*")]),e._v("%以上且交易基数大于或等于"),a("span",{staticStyle:{color:"red"}},[e._v("*")]),e._v('笔"\n          ')]):e._e()],1),e._v(" "),a("el-form-item",{attrs:{label:"整改范围",prop:"operate_area"}},[a("el-select",{attrs:{multiple:""},model:{value:e.form.operate_area,callback:function(t){e.$set(e.form,"operate_area",t)},expression:"form.operate_area"}},[a("el-option",{key:"0",attrs:{label:"试营业站点",value:"0"}}),e._v(" "),a("el-option",{key:"1",attrs:{label:"试营业(已申请pos)站点",value:"1"}}),e._v(" "),a("el-option",{key:"2",attrs:{label:"开业站点",value:"2"}}),e._v(" "),a("el-option",{key:"3",attrs:{label:"退出站点",value:"3"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"风险等级",prop:"operate_risk"}},[a("el-select",{attrs:{clearable:""},model:{value:e.form.operate_risk,callback:function(t){e.$set(e.form,"operate_risk",t)},expression:"form.operate_risk"}},[a("el-option",{key:"0",attrs:{label:"低",value:"0"}}),e._v(" "),a("el-option",{key:"1",attrs:{label:"中",value:"1"}}),e._v(" "),a("el-option",{key:"2",attrs:{label:"高",value:"2"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"整改时间",prop:"operate_day"}},[a("el-input",{attrs:{size:"small"},model:{value:e.form.operate_day,callback:function(t){e.$set(e.form,"operate_day",t)},expression:"form.operate_day"}}),e._v(" "),a("div",{staticStyle:{color:"#cccccc","font-size":"small"}},[e._v('*为可自定义参数："本月末 或 '),a("span",{staticStyle:{color:"red"}},[e._v("*")]),e._v('天内"')])],1),e._v(" "),a("el-form-item",{attrs:{label:"问题描述",prop:"operate_content"}},[a("el-input",{attrs:{size:"small"},model:{value:e.form.operate_content,callback:function(t){e.$set(e.form,"operate_content",t)},expression:"form.operate_content"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"整改要求",prop:"operate_requirement"}},[a("el-input",{attrs:{size:"small"},model:{value:e.form.operate_requirement,callback:function(t){e.$set(e.form,"operate_requirement",t)},expression:"form.operate_requirement"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"处理人",prop:"operate_operno"}},[a("el-select",{attrs:{clearable:""},model:{value:e.form.operate_operno,callback:function(t){e.$set(e.form,"operate_operno",t)},expression:"form.operate_operno"}},[a("el-option",{key:"0",attrs:{label:"分行管理员",value:"0"}}),e._v(" "),a("el-option",{key:"1",attrs:{label:"站长对口惠农客户经理",value:"1"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"是否启用",prop:"use_up"}},[a("el-radio",{attrs:{label:"0"},model:{value:e.form.use_up,callback:function(t){e.$set(e.form,"use_up",t)},expression:"form.use_up"}},[e._v("否")]),e._v(" "),a("el-radio",{attrs:{label:"1"},model:{value:e.form.use_up,callback:function(t){e.$set(e.form,"use_up",t)},expression:"form.use_up"}},[e._v("是")])],1),e._v(" "),a("el-form-item",{attrs:{label:"备注",prop:"remarks"}},[a("el-input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:4},placeholder:"请输入内容"},model:{value:e.form.remarks,callback:function(t){e.$set(e.form,"remarks",t)},expression:"form.remarks"}})],1)],1),e._v(" "),a("div",{staticStyle:{"text-align":"center"},attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:e.handleClose}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.addOperate}},[e._v("确 定\n        ")])],1)],1)],1)},staticRenderFns:[]}},function(e,t,a){var r=a(3)(a(886),a(887),null,null);e.exports=r.exports},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(6),i=a.n(r),o=a(5),l=a.n(o),s=a(10),n=a.n(s);t.default={components:{baseTable:l.a,basePage:n.a},name:"event",data:function(){return{role:sessionStorage.getItem("role"),form:{site_id:[]},dialogImageUrl:"",dialogVisible:!1,fileList:[],siteList:[],dataList:[{label:"服务点名称",prop:"site_name",sort:!0},{label:"客户经理",prop:"account_name",sort:!0},{label:"活动日期",prop:"event_date",sort:!0},{label:"活动方式",prop:"event_way",sort:!0},{label:"活动效果",prop:"event_effect"},{label:"活动主题",prop:"event_name"}],rules:{site_id:[{required:!0,message:"请选择服务点",trigger:"change"}],account_id:[{required:!0,message:"请选择客户经理",trigger:"change"}],event_way:[{required:!0,message:"请选择活动方式",trigger:"change"}],is_card:[{required:!0,message:"请选择现场是否开卡",trigger:"change"}],event_date:[{required:!0,message:"请选择活动日期",trigger:"blur"}]},eventList:[],sysUserList:[],pageNum:1,pageSize:10,total:0,visible:!1}},computed:{bankList:{get:function(){return this.$store.state.bankList},set:function(e){this.$store.state.bankList=e}}},mounted:function(){this.getAccountList(),this.getSiteSelectList()},watch:{visible:function(e){e||(this.form={})}},methods:{beforeAvatarUpload:function(e){return"image/png"===e.type||"image/jpg"===e.type||"image/jpeg"===e.type||(this.$message.error("不支持png、jpg、jpeg以外格式的图片"),!1)},uploadReturn:function(e,t,a){var r=this;console.log(t),this.form.event_photo="",a.map(function(e){r.form.event_photo+="'"+e.response.data[0].id+"',"}),this.form.event_photo=this.form.event_photo.substr(0,this.form.event_photo.length-1),console.log(this.form.event_photo)},handleRemove:function(e,t){var a=this;this.form.event_photo="",t.map(function(e){a.form.event_photo+="'"+e.response.data[0].id+"',"}),this.form.event_photo=this.form.event_photo.substr(0,this.form.event_photo.length-1),console.log(this.form.event_photo)},handlePictureCardPreview:function(e){this.dialogImageUrl=e.url,this.dialogVisible=!0},getAccountList:function(){var e=this;0==this.sysUserList.length&&this.$api.getAccountList({}).then(function(t){e.sysUserList=t.data})},getSiteSelectList:function(){var e=this;this.$api.getSiteSelectList().then(function(t){e.siteList=t.data.siteList})},getEventList:function(){var e=this;this.$api.getEventList({page:this.pageNum-1,number:this.pageSize,bankid:this.bankid,site_id:this.form.site_id,account_id:this.form.account_id,event_start_date:this.form.event_start_date,event_end_date:this.form.event_end_date}).then(function(t){e.eventList=t.data.eventList,e.total=t.data.total,e.eventList.map(function(e){return"1"==e.is_card?e.is_card="否":"0"==e.is_card&&(e.is_card="是"),"0"==e.event_way?e.event_way="线上活动":"1"==e.event_way?e.event_way="线下活动":"2"==e.event_way?e.event_way="其他":void 0})})},addOrEditView:function(){this.visible=!0,this.form={},this.fileList=[]},addEvent:function(){var e=this;this.$refs.form.validate(function(t){t&&(e.form.event_id?e.$api.updateEvent(e.form).then(function(t){e.handleClose(),e.getEventList()}):e.$api.addEvent(e.form).then(function(t){e.handleClose(),e.getEventList()}))})},editEvent:function(e){var t=this;this.form={},this.fileList=[],this.$api.getEventDetail({event_id:e}).then(function(e){t.visible=!0,console.log(e),t.form=e.data.msg[0],t.form.event_photo&&t.$api.getPhotoList({ids:t.form.event_photo}).then(function(e){t.fileList=e.data.photoList,t.form.event_photo="",t.fileList.map(function(e){e.response={data:[{id:e.name}]},t.form.event_photo+="'"+e.response.data[0].id+"',"}),t.form.event_photo=t.form.event_photo.substr(0,t.form.event_photo.length-1),console.log(t.form.event_photo)})})},deleteEvent:function(e){var t=this;this.$confirm("确定删除吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!0}).then(function(){t.$api.deleteEvent({event_id:e}).then(function(e){console.log(e),t.getEventList()})}).catch(function(){})},exportEventInfos:function(){var e=this;this.$api.exportEventInfos(i()({},this.form)).then(function(t){var a=t.data.fileName,r=t.data.filePath;if(null==a||null==r)return e.$message({message:"导出失败，系统异常",type:"error"}),!1;var i=document.createElement("form");document.body.appendChild(i),i.method="post",i.action="/hnm/txCtrl?txcode=mediaFile",i.enctype="multipart/form-data";var o=document.createElement("input"),l=document.createElement("input"),s=document.createElement("input"),n=document.createElement("input");o.setAttribute("name","filePath"),o.setAttribute("type","hidden"),o.setAttribute("value",r),l.setAttribute("name","fileName"),l.setAttribute("type","hidden"),l.setAttribute("value",a),s.setAttribute("name","isDownload"),s.setAttribute("type","hidden"),s.setAttribute("value","1"),n.setAttribute("name","isDelete"),n.setAttribute("type","hidden"),n.setAttribute("value","1"),i.appendChild(o),i.appendChild(l),i.appendChild(s),i.appendChild(n),i.submit(),e.$message({message:"导出成功",type:"success"})})},changeSize:function(e){this.pageSize=e,this.getEventList()},changePage:function(e){this.pageNum=e,this.getEventList()},handleClose:function(){this.visible=!1,this.form={}}},beforeRouteEnter:function(e,t,a){a(function(t){e.params.searchKey&&(t.form=e.params.searchKey),t.getEventList()})}}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-button",{staticStyle:{"margin-bottom":"10px"},attrs:{type:"primary",size:"small"},on:{click:e.addOrEditView}},[e._v("\n        活动录入\n    ")]),e._v(" "),a("el-button",{attrs:{type:"warning",size:"small"},on:{click:e.exportEventInfos}},[e._v("\n        导出全部查询数据\n    ")]),e._v(" "),a("el-form",{staticStyle:{"margin-top":"15px"},attrs:{inline:!0,model:e.form}},[a("el-form-item",{attrs:{label:"活动日期",prop:"event_start_date"}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date","value-format":"yyyy-MM-dd",placeholder:"选择日期"},model:{value:e.form.event_start_date,callback:function(t){e.$set(e.form,"event_start_date",t)},expression:"form.event_start_date"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"-",prop:"event_end_date"}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date","value-format":"yyyy-MM-dd",placeholder:"选择日期"},model:{value:e.form.event_end_date,callback:function(t){e.$set(e.form,"event_end_date",t)},expression:"form.event_end_date"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"服务点",prop:"site_id"}},[a("el-select",{attrs:{filterable:"",clearable:"",size:"small"},model:{value:e.form.site_id,callback:function(t){e.$set(e.form,"site_id",t)},expression:"form.site_id"}},e._l(e.siteList,function(e){return a("el-option",{key:e.site_no,attrs:{label:e.site_name,value:e.site_no}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"客户经理",prop:"account_id"}},[a("el-select",{attrs:{filterable:"",clearable:"",size:"small"},model:{value:e.form.account_id,callback:function(t){e.$set(e.form,"account_id",t)},expression:"form.account_id"}},e._l(e.sysUserList,function(e){return a("el-option",{key:e.account_id,attrs:{label:e.name,value:e.account_id}})}),1)],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-search"},on:{click:e.getEventList}},[e._v("搜索\n            ")])],1)],1),e._v(" "),a("base-table",{attrs:{list:e.dataList,data:e.eventList}},[a("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",icon:"el-icon-edit-outline"},on:{click:function(a){return e.editEvent(t.row.event_id)}}},[e._v("\n                    编辑\n                ")]),e._v(" "),a("el-button",{staticStyle:{color:"red"},attrs:{type:"text",icon:"el-icon-delete"},on:{click:function(a){return e.deleteEvent(t.row.event_id)}}},[e._v("删除\n                ")])]}}])})],1),e._v(" "),a("base-page",{attrs:{page:e.pageNum,size:e.pageSize,total:e.total},on:{size:e.changeSize,page:e.changePage}}),e._v(" "),a("el-dialog",{attrs:{title:e.form.event_id?"修改":"新增",visible:e.visible,width:"45%","before-close":e.handleClose},on:{"update:visible":function(t){e.visible=t}}},[a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"90px"}},[a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],attrs:{label:"主键",prop:"event_id"}},[a("el-select",{attrs:{filterable:"",clearable:"",size:"small"},model:{value:e.form.event_id,callback:function(t){e.$set(e.form,"event_id",t)},expression:"form.event_id"}},[a("el-input",{model:{value:e.form.event_id,callback:function(t){e.$set(e.form,"event_id",t)},expression:"form.event_id"}})],1)],1),e._v(" "),a("el-form-item",{staticStyle:{width:"360px"},attrs:{label:"服务点",prop:"site_id"}},[a("el-select",{attrs:{filterable:"",clearable:"",size:"small",multiple:!e.form.event_id},model:{value:e.form.site_id,callback:function(t){e.$set(e.form,"site_id",t)},expression:"form.site_id"}},e._l(e.siteList,function(e){return a("el-option",{key:e.site_no,attrs:{label:e.site_name,value:e.site_no}})}),1)],1),e._v(" "),a("el-form-item",{staticStyle:{width:"360px"},attrs:{label:"活动主题",prop:"event_name"}},[a("el-input",{model:{value:e.form.event_name,callback:function(t){e.$set(e.form,"event_name",t)},expression:"form.event_name"}})],1),e._v(" "),a("el-form-item",{staticStyle:{width:"360px"},attrs:{label:"活动日期",prop:"event_date"}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date","value-format":"yyyy-MM-dd",placeholder:"选择日期"},model:{value:e.form.event_date,callback:function(t){e.$set(e.form,"event_date",t)},expression:"form.event_date"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"活动方式",prop:"event_way"}},[a("el-radio-group",{model:{value:e.form.event_way,callback:function(t){e.$set(e.form,"event_way",t)},expression:"form.event_way"}},[a("el-radio",{attrs:{label:"0"}},[e._v("线上活动")]),e._v(" "),a("el-radio",{attrs:{label:"1"}},[e._v("线下活动")]),e._v(" "),a("el-radio",{attrs:{label:"2"}},[e._v("其他")])],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"现场是否开卡",prop:"is_card"}},[a("el-radio-group",{model:{value:e.form.is_card,callback:function(t){e.$set(e.form,"is_card",t)},expression:"form.is_card"}},[a("el-radio",{attrs:{label:"0"}},[e._v("是")]),e._v(" "),a("el-radio",{attrs:{label:"1"}},[e._v("否")])],1)],1),e._v(" "),a("el-form-item",{staticStyle:{width:"360px"},attrs:{label:"活动参与人数",prop:"event_staff"}},[a("el-input",{model:{value:e.form.event_staff,callback:function(t){e.$set(e.form,"event_staff",t)},expression:"form.event_staff"}})],1),e._v(" "),a("el-form-item",{staticStyle:{width:"360px"},attrs:{label:"活动效果",prop:"event_effect"}},[a("el-input",{model:{value:e.form.event_effect,callback:function(t){e.$set(e.form,"event_effect",t)},expression:"form.event_effect"}})],1),e._v(" "),a("el-form-item",{staticStyle:{width:"360px"},attrs:{label:"其他",prop:"event_other"}},[a("el-input",{model:{value:e.form.event_other,callback:function(t){e.$set(e.form,"event_other",t)},expression:"form.event_other"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"活动照片",prop:"event_photo"}},[a("el-upload",{ref:"upload",attrs:{action:"/hnm/txCtrl?txcode=upload001","list-type":"picture-card","before-upload":e.beforeAvatarUpload,"file-list":this.fileList,data:{business:"event",name:"123"},headers:{Accept:"application/json"},"on-success":e.uploadReturn,"on-preview":e.handlePictureCardPreview,"on-remove":e.handleRemove}},[a("i",{staticClass:"el-icon-plus"})]),e._v(" "),a("el-dialog",{attrs:{visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("img",{attrs:{width:"100%",src:e.dialogImageUrl,alt:""}})])],1)],1),e._v(" "),a("div",{staticStyle:{"text-align":"center"},attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:e.handleClose}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.addEvent}},[e._v("确 定\n            ")])],1)],1)],1)},staticRenderFns:[]}},function(e,t,a){a(889);var r=a(3)(a(890),a(895),"data-v-7712cd47",null);e.exports=r.exports},function(e,t){},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(891),i=(a.n(r),a(892)),o=(a.n(i),a(893)),l=(a.n(o),a(894));a.n(l);t.default={data:function(){return{animateJson:{noticeJson:r,achievment:i,messageJson:o,fileJson:l}}},methods:{check:function(){this.$message.info("功能暂未开放，敬请期待")}}}},function(e,t,a){e.exports=a.p+"img/notice.f64ce19.png"},function(e,t,a){e.exports=a.p+"img/achievment.f801462.png"},function(e,t,a){e.exports=a.p+"img/message.6925cd8.png"},function(e,t,a){e.exports=a.p+"img/file.878a82b.png"},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"index"},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("el-card",{attrs:{shadow:"hover"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[e._v("业绩展示")]),e._v(" "),a("el-button",{staticStyle:{float:"right",padding:"3px 0"},attrs:{type:"text"},on:{click:e.check}},[e._v("查看")])],1),e._v(" "),a("div",{staticClass:"img-container"},[a("img",{attrs:{src:e.animateJson.achievment}})])])],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-card",{attrs:{shadow:"hover"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[e._v("消息推送")]),e._v(" "),a("el-button",{staticStyle:{float:"right",padding:"3px 0"},attrs:{type:"text"},on:{click:e.check}},[e._v("查看")])],1),e._v(" "),a("div",{staticClass:"img-container"},[a("img",{attrs:{src:e.animateJson.messageJson}})])])],1)],1),e._v(" "),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("el-card",{attrs:{shadow:"hover"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[e._v("政策文件")]),e._v(" "),a("el-button",{staticStyle:{float:"right",padding:"3px 0"},attrs:{type:"text"},on:{click:e.check}},[e._v("查看")])],1),e._v(" "),a("div",{staticClass:"img-container"},[a("img",{attrs:{src:e.animateJson.fileJson}})])])],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-card",{attrs:{shadow:"hover"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[e._v("重要通知")]),e._v(" "),a("el-button",{staticStyle:{float:"right",padding:"3px 0"},attrs:{type:"text"},on:{click:e.check}},[e._v("查看")])],1),e._v(" "),a("div",{staticClass:"img-container"},[a("img",{attrs:{src:e.animateJson.noticeJson}})])])],1)],1)],1)},staticRenderFns:[]}},function(e,t,a){var r=a(3)(a(897),a(898),null,null);e.exports=r.exports},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(6),i=a.n(r),o=a(33),l=a.n(o),s=a(5),n=a.n(s),p=a(10),c=a.n(p);t.default={components:{baseTable:n.a,basePage:c.a},name:"setting",data:function(){return{form:{},roleList:[],dataList:[{label:"短信任务名称",prop:"sms_pro",width:"30"},{label:"触发条件",prop:"trigger_condition",width:"40"},{label:" 短信内容",prop:"sms_content"},{label:"是否启用",prop:"use_up",width:"20"}],showList:[],pageNum:1,pageSize:10,total:0,visible:!1}},mounted:function(){this.getRoleList()},watch:{visible:function(e){e||(this.form={})}},methods:{computedsendRole:function(e){var t=this.roleList.findIndex(function(t){return t.role_id===e});return this.roleList[t].role_name},addOrEditSetting:function(){var e=this;this.$refs.form.validate(function(t){t&&e.$api.addSetting(e.form).then(function(){e.handleClose(),e.getSettingList()}).catch(function(){})})},getRoleList:function(){var e=this;this.$api.getUsertype().then(function(t){e.roleList=t.data;var a={role_id:"000001",role_name:"问题整改人"},r={role_id:"000002",role_name:"审批人/沟通人"};e.roleList.push(a),e.roleList.push(r)})},addSetting:function(){this.form={},this.visible=!0},editSetting:function(e){this.form={},this.form=JSON.parse(l()(e)),this.form.use_up="否"===this.form.use_up?"0":"1",this.visible=!0},getSettingList:function(e){var t=this;e&&(this.pageNum=1),null!==this.form.sms_pro&&""!==this.form.sms_pro||delete this.form.sms_pro,this.$api.getSettingList(i()({page:this.pageNum-1,number:this.pageSize},this.form)).then(function(e){e.data.returnList.map(function(e){return e.use_up="0"===e.use_up?"否":"是"}),t.showList=e.data.returnList,t.total=e.data.total})},changeSize:function(e){this.pageSize=e,this.getSettingList()},changePage:function(e){this.pageNum=e,this.getSettingList()},handleClose:function(){this.visible=!1,this.form={}}},beforeRouteEnter:function(e,t,a){a(function(t){e.params.searchKey&&(t.form=e.params.searchKey),t.getSettingList()})}}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-form",{staticStyle:{"margin-top":"15px"},attrs:{inline:!0,model:e.form}},[a("el-form-item",{attrs:{label:"短信任务名称"}},[a("el-input",{attrs:{clearable:"",placeholder:"请输入规则名称",size:"small"},model:{value:e.form.sms_pro,callback:function(t){e.$set(e.form,"sms_pro",t)},expression:"form.sms_pro "}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-search"},on:{click:function(t){return e.getSettingList(!0)}}},[e._v("搜索\n      ")])],1)],1),e._v(" "),a("base-table",{attrs:{list:e.dataList,data:e.showList}},[a("el-table-column",{staticStyle:{width:"5px"},attrs:{label:"短信接收人",prop:"send_role",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return e.roleList?[a("span",[e._v("\n          "+e._s(e.computedsendRole(t.row.send_role))+"\n        ")])]:void 0}}],null,!0)}),e._v(" "),a("el-table-column",{attrs:{label:"操作",align:"center",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",icon:"el-icon-edit-outline"},on:{click:function(a){return e.editSetting(t.row)}}},[e._v("编辑\n        ")])]}}])})],1),e._v(" "),a("base-page",{attrs:{page:e.pageNum,size:e.pageSize,total:e.total},on:{size:e.changeSize,page:e.changePage}}),e._v(" "),a("el-dialog",{attrs:{title:e.form.id?"修改":"新增",visible:e.visible,width:"45%","before-close":e.handleClose},on:{"update:visible":function(t){e.visible=t}}},[a("el-form",{ref:"form",attrs:{model:e.form}},[a("el-form-item",{staticStyle:{width:"360px"},attrs:{label:"短信任务名称",prop:"sms_pro"}},[a("el-input",{attrs:{size:"midul"},model:{value:e.form.sms_pro,callback:function(t){e.$set(e.form,"sms_pro",t)},expression:"form.sms_pro "}})],1),e._v(" "),a("el-form-item",{staticStyle:{width:"360px"},attrs:{label:"触发条件",prop:"trigger_condition"}},[a("el-input",{attrs:{size:"small"},model:{value:e.form.trigger_condition,callback:function(t){e.$set(e.form,"trigger_condition",t)},expression:"form.trigger_condition"}})],1),e._v(" "),a("el-form-item",{staticStyle:{width:"360px"},attrs:{label:"短信内容",prop:"sms_content"}},[a("el-input",{attrs:{size:"small",type:"textarea"},model:{value:e.form.sms_content,callback:function(t){e.$set(e.form,"sms_content",t)},expression:"form.sms_content"}})],1),e._v(" "),a("el-form-item",{staticStyle:{width:"360px"},attrs:{label:"短信接收人",prop:"send_role"}},[a("el-select",{attrs:{size:"small",disabled:"00000000002"===e.form.id||"00000000003"===e.form.id},model:{value:e.form.send_role,callback:function(t){e.$set(e.form,"send_role",t)},expression:"form.send_role"}},e._l(e.roleList,function(e){return a("el-option",{key:e.role_id,attrs:{label:e.role_name,value:e.role_id}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"是否启用",prop:"use_up"}},[a("el-radio",{attrs:{label:"0"},model:{value:e.form.use_up,callback:function(t){e.$set(e.form,"use_up",t)},expression:"form.use_up"}},[e._v("否")]),e._v(" "),a("el-radio",{attrs:{label:"1"},model:{value:e.form.use_up,callback:function(t){e.$set(e.form,"use_up",t)},expression:"form.use_up"}},[e._v("是")])],1)],1),e._v(" "),a("div",{staticStyle:{"text-align":"center"},attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:e.handleClose}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.addOrEditSetting}},[e._v("确 定\n      ")])],1)],1)],1)},staticRenderFns:[]}},function(e,t,a){"use strict";var r=a(190),i={login:function(e){return Object(r.a)("login","login",e)},getCode:function(){return Object(r.a)("code","code001")},getPhoneCode:function(e){return Object(r.a)("txCtrl","msg001",e)},addUser:function(e){return Object(r.a)("txCtrl","user001",e)},updateUser:function(e){return Object(r.a)("txCtrl","user002",e)},getBranch:function(e){return Object(r.a)("txCtrl","user003",e)},getUsertype:function(e){return Object(r.a)("txCtrl","user004",e)},deleteUser:function(e){return Object(r.a)("txCtrl","user005",e)},resetPassword:function(e){return Object(r.a)("txCtrl","user006",e)},getUserList:function(e){return Object(r.a)("txCtrl","user007",e)},getUserInfo:function(e){return Object(r.a)("txCtrl","user008",e)},uploadUser:function(e){return Object(r.b)("upload","user009",e)},updatePwd:function(e){return Object(r.a)("txCtrl","user010",e)},clearPwd:function(e){return Object(r.a)("txCtrl","user011",e)},getAccountList:function(e){return Object(r.a)("txCtrl","user012",e)},getAllAccountList:function(e){return Object(r.a)("txCtrl","user013",e)},createMenu:function(e){return Object(r.a)("txCtrl","menu001",e)},deleteMenu:function(e){return Object(r.a)("txCtrl","menu002",e)},editMenu:function(e){return Object(r.a)("txCtrl","menu003",e)},getMenu:function(e){return Object(r.a)("txCtrl","menu004",e)},addRole:function(e){return Object(r.a)("txCtrl","role001",e)},deleteRole:function(e){return Object(r.a)("txCtrl","role002",e)},getRoleList:function(e){return Object(r.a)("txCtrl","role003",e)},updateRole:function(e){return Object(r.a)("txCtrl","role004",e)},getRoleInfo:function(e){return Object(r.a)("txCtrl","role006",e)},getStaffRoleList:function(e){return Object(r.a)("txCtrl","role007",e)},getBranchList:function(e){return Object(r.a)("txCtrl","branch001",e)},getBranchDetail:function(e){return Object(r.a)("txCtrl","branch002",e)},addtBranch:function(e){return Object(r.a)("txCtrl","branch003",e)},updatetBranch:function(e){return Object(r.a)("txCtrl","branch004",e)},deleteBranch:function(e){return Object(r.a)("txCtrl","branch005",e)},getBranchByLevel:function(e){return Object(r.a)("txCtrl","branch006",e)},getApprovalTypeList:function(e){return Object(r.a)("txCtrl","flow001",e)},addApprovalType:function(e){return Object(r.a)("txCtrl","flow002",e)},updateApprovalType:function(e){return Object(r.a)("txCtrl","flow003",e)},getApprovalType:function(e){return Object(r.a)("txCtrl","flow004",e)},deleteApprovalType:function(e){return Object(r.a)("txCtrl","flow005",e)},checkApprovalType:function(e){return Object(r.a)("txCtrl","flow006",e)},getApprovalTypeForProcessList:function(e){return Object(r.a)("txCtrl","flow007",e)},getApprovalProcessList:function(e){return Object(r.a)("txCtrl","flow008",e)},getApprovalRoleList:function(e){return Object(r.a)("txCtrl","flow009",e)},getApprovalProcess:function(e){return Object(r.a)("txCtrl","flow010",e)},addApprovalProcess:function(e){return Object(r.a)("txCtrl","flow011",e)},updateApprovalProcess:function(e){return Object(r.a)("txCtrl","flow012",e)},deleteApprovalProcess:function(e){return Object(r.a)("txCtrl","flow013",e)},getApprovalAccountList:function(e){return Object(r.a)("txCtrl","flow014",e)},getStaffList:function(e){return Object(r.a)("txCtrl","staff001",e)},addStaff:function(e){return Object(r.a)("txCtrl","staff002",e)},getStaffDetail:function(e){return Object(r.a)("txCtrl","staff003",e)},exportStaffInfos:function(e){return Object(r.a)("txCtrl","staff004",e)},checkStaffDetail:function(e){return Object(r.a)("txCtrl","staff005",e)},getTeamLeaderList:function(e){return Object(r.a)("txCtrl","staff006",e)},geManagerList:function(e){return Object(r.a)("txCtrl","staff007",e)},getApprovalTypeByEnum:function(e){return Object(r.a)("txCtrl","flow018",e)},getApprovalStatusByEnum:function(e){return Object(r.a)("txCtrl","flow019",e)},getApprovalApplyList:function(e){return Object(r.a)("txCtrl","flow020",e)},getApprovalHisList:function(e){return Object(r.a)("txCtrl","flow021",e)},getApproval1List:function(e){return Object(r.a)("txCtrl","flow022",e)},getApproval2List:function(e){return Object(r.a)("txCtrl","flow023",e)},submitApproval:function(e){return Object(r.a)("txCtrl","flow017",e)},getApprovalAccountList2:function(e){return Object(r.a)("txCtrl","flow015",e)},getApprovalStepList:function(e){return Object(r.a)("txCtrl","flow024",e)},getUpdateInfo:function(e){return Object(r.a)("txCtrl","flow025",e)},getApprovalUpAccountList:function(e){return Object(r.a)("txCtrl","flow026",e)},fqApprovalApply:function(e){return Object(r.a)("txCtrl","flow027",e)},hfApprovalApply:function(e){return Object(r.a)("txCtrl","flow028",e)},getApprovalConnect1List:function(e){return Object(r.a)("txCtrl","flow029",e)},getApprovalConnect2List:function(e){return Object(r.a)("txCtrl","flow030",e)},submitApprovalConnect:function(e){return Object(r.a)("txCtrl","flow031",e)},getApprovalConnectHisList:function(e){return Object(r.a)("txCtrl","flow032",e)},getApprovalItemList:function(e){return Object(r.a)("txCtrl","flow033",e)},getApprovalHisLogList:function(e){return Object(r.a)("txCtrl","flow034",e)},getApprovalQY:function(e){return Object(r.a)("txCtrl","flow035",e)},getApprovalUser:function(e){return Object(r.a)("txCtrl","flow036",e)},getApprovalField:function(e){return Object(r.a)("txCtrl","flow037",e)},addApprovalField:function(e){return Object(r.a)("txCtrl","flow038",e)},getTeamList:function(e){return Object(r.a)("txCtrl","team001",e)},addTeam:function(e){return Object(r.a)("txCtrl","team002",e)},getTeamDetail:function(e){return Object(r.a)("txCtrl","team003",e)},getBranchAllOrg:function(e){return Object(r.a)("txCtrl","team004",e)},getBranchTeamList:function(e){return Object(r.a)("txCtrl","team005",e)},exportTeamInfos:function(e){return Object(r.a)("txCtrl","team006",e)},getSiteWarnTimeList:function(e){return Object(r.a)("txCtrl","market001",e)},getWarnTimeDetail:function(e){return Object(r.a)("txCtrl","market002",e)},getSiteWarnRecordList:function(e){return Object(r.a)("txCtrl","market003",e)},addSiteWarnTime:function(e){return Object(r.a)("txCtrl","market004",e)},updateSiteWarnTime:function(e){return Object(r.a)("txCtrl","market005",e)},deleteSiteWarnTime:function(e){return Object(r.a)("txCtrl","market006",e)},getSiteList:function(e){return Object(r.a)("txCtrl","site001",e)},addSite:function(e){return Object(r.a)("txCtrl","site002",e)},getSite:function(e){return Object(r.a)("txCtrl","site003",e)},getSiteFile:function(e){return Object(r.a)("txCtrl","site004",e)},exportSiteInfos:function(e){return Object(r.a)("txCtrl","site005",e)},tempaddTeam:function(e){return Object(r.a)("txCtrl","team007",e)},getTempTeamDetail:function(e){return Object(r.a)("txCtrl","team008",e)},tempaddStaff:function(e){return Object(r.a)("txCtrl","staff008",e)},getTempStaffDetail:function(e){return Object(r.a)("txCtrl","staff009",e)},tempaddSite:function(e){return Object(r.a)("txCtrl","site007",e)},getTempSiteDetail:function(e){return Object(r.a)("txCtrl","site008",e)},getReport001List:function(e){return Object(r.a)("txCtrl","report001",e)},getReport002List:function(e){return Object(r.a)("txCtrl","report002",e)},getReport003List:function(e){return Object(r.a)("txCtrl","report003",e)},getReport004List:function(e){return Object(r.a)("txCtrl","report004",e)},getDepositList:function(e){return Object(r.a)("txCtrl","report006",e)},getAumList:function(e){return Object(r.a)("txCtrl","report005",e)},getDepositList2:function(e){return Object(r.a)("txCtrl","report010",e)},getAumList2:function(e){return Object(r.a)("txCtrl","report009",e)},getExpandList:function(e){return Object(r.a)("txCtrl","report007",e)},getHelpFarmersList:function(e){return Object(r.a)("txCtrl","report008",e)},exportAumDataInfos:function(e){return Object(r.a)("txCtrl","report011",e)},exportDepositDataInfos:function(e){return Object(r.a)("txCtrl","report012",e)},exportAumDataInfos2:function(e){return Object(r.a)("txCtrl","report013",e)},exportDepositDataInfos2:function(e){return Object(r.a)("txCtrl","report014",e)},exportExpandDataInfos:function(e){return Object(r.a)("txCtrl","report015",e)},exportHelpFarmersDataInfos:function(e){return Object(r.a)("txCtrl","report016",e)},getPatrolList:function(e){return Object(r.a)("txCtrl","patrol001",e)},addPatrol:function(e){return Object(r.a)("txCtrl","patrol002",e)},deletePatrol:function(e){return Object(r.a)("txCtrl","patrol003",e)},updatePatrol:function(e){return Object(r.a)("txCtrl","patrol004",e)},getPatrolDetail:function(e){return Object(r.a)("txCtrl","patrol005",e)},exportPatrolInfos:function(e){return Object(r.a)("txCtrl","patrol006",e)},getMarkSheel:function(e){return Object(r.a)("txCtrl","markS001",e)},getNmarkSheel:function(e){return Object(r.a)("txCtrl","markS002",e)},getQuitMarkSheel:function(e){return Object(r.a)("txCtrl","markS003",e)},getPatrolLog:function(e){return Object(r.a)("txCtrl","patlog001",e)},addOrEditPatrolLog:function(e){return Object(r.a)("txCtrl","patlog002",e)},exportPatrolLog:function(e){return Object(r.a)("txCtrl","patlog003",e)},getEventList:function(e){return Object(r.a)("txCtrl","event001",e)},addEvent:function(e){return Object(r.a)("txCtrl","event002",e)},deleteEvent:function(e){return Object(r.a)("txCtrl","event003",e)},updateEvent:function(e){return Object(r.a)("txCtrl","event004",e)},getEventDetail:function(e){return Object(r.a)("txCtrl","event005",e)},exportEventInfos:function(e){return Object(r.a)("txCtrl","event006",e)},getPhotoList:function(e){return Object(r.a)("txCtrl","fileinfo",e)},getSiteSelectList:function(e){return Object(r.a)("txCtrl","site006",e)},getqrcode:function(e){return Object(r.a)("txCtrl","site009",e)},getCustomerDetail:function(e){return Object(r.a)("txCtrl","report017",e)},exportCustomerDetail:function(e){return Object(r.a)("txCtrl","report018",e)},uploadMerror:function(e){return Object(r.b)("upload","patrol007",e)},getMerror:function(e){return Object(r.a)("txCtrl","patrol008",e)},addMerror:function(e){return Object(r.a)("txCtrl","patrol009",e)},deleteMerror:function(e){return Object(r.a)("txCtrl","patrol010",e)},getProjectList:function(e){return Object(r.a)("txCtrl","pclass001",e)},getRisk:function(e){return Object(r.a)("txCtrl","patrol011",e)},getRiskDetail:function(e){return Object(r.a)("txCtrl","patrol014",e)},addOrEditRisk:function(e){return Object(r.a)("txCtrl","patrol012",e)},exportExpandRiskInfos:function(e){return Object(r.a)("txCtrl","patrol013",e)},exportErrorInfos:function(e){return Object(r.a)("txCtrl","patrol015",e)},addOrDeleteProjec:function(e){return Object(r.a)("txCtrl","pclass002",e)},getVoucherList:function(e){return Object(r.a)("txCtrl","vouch001",e)},getVoucher2List:function(e){return Object(r.a)("txCtrl","vouch002",e)},getTranflowList:function(e){return Object(r.a)("txCtrl","vouch003",e)},getVoucherDetail:function(e){return Object(r.a)("txCtrl","vouch004",e)},addVoucher:function(e){return Object(r.a)("txCtrl","vouch005",e)},showTranflowDetail:function(e){return Object(r.a)("txCtrl","vouch006",e)},getOperateList:function(e){return Object(r.a)("txCtrl","opera001",e)},getOperate:function(e){return Object(r.a)("txCtrl","opera002",e)},addOperate:function(e){return Object(r.a)("txCtrl","opera003",e)},exportOperateInfos:function(e){return Object(r.a)("txCtrl","opera004",e)},addRiskCustomer:function(e){return Object(r.a)("txCtrl","blackB001",e)},editRiskCustomer:function(e){return Object(r.a)("txCtrl","blackB002",e)},deleteRiskCustomer:function(e){return Object(r.a)("txCtrl","blackB003",e)},getRiskCustomer:function(e){return Object(r.a)("txCtrl","blackB004",e)},uploadRiskCustomer:function(e){return Object(r.b)("upload","blackB005",e)},exportRiskCustomerInfos:function(e){return Object(r.a)("txCtrl","blackB006",e)},addSetting:function(e){return Object(r.a)("txCtrl","smsset001",e)},getSettingList:function(e){return Object(r.a)("txCtrl","smsset004",e)},addOrEditMeasure:function(e){return Object(r.a)("txCtrl","msure001",e)},getMeasures:function(e){return Object(r.a)("txCtrl","msure002",e)}};t.a=i},function(e,t){},function(e,t){},function(e,t,a){"use strict";function r(e,t){for(var a=0;a<e.length;a++)if(e[a].value==t)return e[a];return{code:"",value:""}}function i(e,t){for(var a=0;a<e.length;a++)if(e[a].code==t)return e[a];return{code:"",value:""}}var o=a(21),l=a(132);o.default.use(l.a);var s=[{code:"002",value:"新增人员"},{code:"003",value:"人员基本信息调整"},{code:"004",value:"新增站点(试营业)"},{code:"005",value:"站点基本信息调整"},{code:"006",value:"助农POS申请"},{code:"007",value:"助农POS申请和申请开业"},{code:"008",value:"退出申请"},{code:"009",value:"新增团队"},{code:"010",value:"团队基本信息调整"},{code:"011",value:"团队类型调整"},{code:"012",value:"团队所属机构调整"},{code:"013",value:"团队负责人调整"},{code:"014",value:"人员角色调整"},{code:"015",value:"人员所属机构调整"},{code:"016",value:"站点站长信息调整"},{code:"017",value:"站点POS信息调整"},{code:"018",value:"站点管辖客户经理调整"},{code:"019",value:"站点落地支行调整"},{code:"020",value:"删除团队"},{code:"021",value:"删除人员"},{code:"022",value:"转试营业申请"},{code:"023",value:"风险处置整改"}],n=[{code:"super_manager",value:"2021061500000001"},{code:"head_manager",value:"2021061500000002"},{code:"head_science",value:"2021061500000003"},{code:"sub_manager",value:"2021061500000004"},{code:"sub_leader",value:"2021061500000005"},{code:"area_leader",value:"2021061500000006"},{code:"team_leader",value:"2021061500000007"},{code:"customer",value:"2021061500000008"}];t.a={listApprovalType:s,listRole:n,value_GetEnums:r,code_GetEnums:i}},function(e,t,a){var r=a(3)(a(904),a(906),null,null);e.exports=r.exports},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(905),i=function(e){return e&&e.__esModule?e:{default:e}}(r);t.default={props:{options:{type:Object,required:!0},height:Number,width:Number},data:function(){return{style:{width:this.width?this.width+"px":"100%",height:this.height?this.height+"px":"100%",overflow:"hidden",margin:"0 auto"}}},mounted:function(){this.anim=i.default.loadAnimation({container:this.$refs.lavContainer,renderer:"svg",loop:!1!==this.options.loop,autoplay:!1!==this.options.autoplay,animationData:this.options.animationData,rendererSettings:this.options.rendererSettings}),this.$emit("animCreated",this.anim)}}},,function(e,t){e.exports={render:function(){var e=this,t=e.$createElement;return(e._self._c||t)("div",{ref:"lavContainer",style:e.style})},staticRenderFns:[]}},function(e,t,a){"use strict";function r(e){if(!e)return"-";var t=/^(\d{4})\d+(\d{4})$/;return e.replace(t,"$1******$2")}function i(e){return e.substring(0,4)+"-"+e.substring(4,6)+"-"+e.substring(6,8)+" "+e.substring(8,10)+":"+e.substring(10,12)+":"+e.substring(12,14)}function o(e){return{0:"建行钱包",1:"龙支付",3:"银行卡",4:"银行卡",5:"银行卡",6:"熊猫币"}[e]||"-"}Object.defineProperty(t,"__esModule",{value:!0}),t.cardFilter=r,t.timeFilter=i,t.cstFilter=o}],[306]);
//# sourceMappingURL=app.caa8fb2dfbc346e5a254.js.map